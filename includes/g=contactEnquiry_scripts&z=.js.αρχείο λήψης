$('.broker-email-popup').click(function(event){event.preventDefault();$('a.contactEnquirySubmit').data('agent-id',$(this).data('agent-id'));$('a.contactEnquirySubmit').data('source',$(this).data('source'));$.fancybox($(this).attr('href'),{'transitionIn':'elastic','transitionOut':'elastic','speedIn':600,'speedOut':200,'autoScale':true,'autoDimensions':false,'width':400,'height':460,'padding':0,});});$('a.contactEnquirySubmit').on('click',function(){if(!$(this).hasClass('contactEnquirySubmitButtonDisabled'))
{submitContactEnquiryForm($(this).data('agent-id'),$(this).data('source'),$('#genericBaseUrl').attr('title'));}
return false;});$(document).ready(function(){$(".autoReset").each(function(){if($(this).val()==$(this).attr('title'))
{$(this).val("");}
else if($(this).val()=="")
{$(this).val($(this).attr('title'));}});$(".broker").hover(function(){$(this).toggleClass("brokerFocus");});$(".broker").sgLinkify();$('.brokerSpinned').unbind('click');});function submitContactEnquiryForm(agentId,source,baseUrl)
{disableContactEnquirySubmitButton();$('.autoReset').each(function(){$(this).val()==$(this).attr('title')?$(this).val(''):'';});var formData=$('#contactEnquiryForm').serializeArray();$('.autoReset').each(function(){$(this).val()==''?$(this).val($(this).attr('title')):'';});formData.push({'name':'agentId','value':agentId},{'name':'source','value':source},{'name':'spformat','value':true});$.ajax({url:baseUrl+'requests/contactEnquirySubmit',dataType:'json',type:'post',data:formData,success:function(response){if(response.responseStatus)
{if($("#fb_pixel_flag").text()=="1"){fbq('track','Lead',{value:3,currency:"EUR",content_category:"Primary",content_name:"Visit Request"});}
$.fancybox.close();}
enableContactEnquirySubmitButton();},error:function(response){$.jGrowlError($('#genericErrorMessage').attr('title'),{sticky:true});enableContactEnquirySubmitButton();},complete:function(){$('.refreshVisualCaptcha','#brokerFormPopup').trigger('click');}});}
$('.suggestedBrokerPhoneSubmit').bind("click",function(event){event.preventDefault();if(!$(this).hasClass("triggered"))
{var brokerId=$(this).data('agentid');var source=$(this).data("source");var target='#'+$(this).attr('id');showPhone(brokerId,source,"link",$("#genericBaseUrl").attr("title"),target);}});function enableContactEnquirySubmitButton()
{$('a.contactEnquirySubmit').removeClass('contactEnquirySubmitButtonDisabled');return true;}
function disableContactEnquirySubmitButton()
{$('a.contactEnquirySubmit').addClass('contactEnquirySubmitButtonDisabled');return true;}
$('.contactEnquirySubmitButtonDisabled').on('click',function(){return false;});;VisualCaptchaModule=(function(){var visualCaptcha=[];var VisualCaptchaModule=function(element,rnd_visualCaptcha){visualCaptcha[rnd_visualCaptcha]=element;}
var _populateCaptchaIcons=function(rnd_visualCaptcha,imageOptions,validImageOption){$.each(imageOptions,function(key,value){$(visualCaptcha[rnd_visualCaptcha]).find('.captchaIconsWrapper').append('<img class="visualCaptchaImg" data-captcha="'+value['value']+'" src="'+$('#assetsLocation').attr('title')+'images/'+value['path']+'" />');});$(visualCaptcha[rnd_visualCaptcha]).find('.validCaptchaName').html(validImageOption);}
var _setUserCaptchaCode=function(rnd_visualCaptcha,userCaptchaCode){$(visualCaptcha[rnd_visualCaptcha]).find('.hiddenArea > input[name="fv_visualCaptchaCodeReq"]').val(userCaptchaCode);}
var _clearCaptcha=function(rnd_visualCaptcha){$(visualCaptcha[rnd_visualCaptcha]).find('.captchaIconsWrapper').html('');$(visualCaptcha[rnd_visualCaptcha]).find('.hiddenArea > input[name="fv_visualCaptchaCodeReq"]').val('');}
var _refreshCaptchaIcons=function(rnd_visualCaptcha,url){$.ajax({url:url,dataType:'json',type:'post',data:{rnd_visualCaptcha:rnd_visualCaptcha,spformat:true},success:function(response){if(response.responseStatus){_clearCaptcha(rnd_visualCaptcha);_populateCaptchaIcons(rnd_visualCaptcha,response.data.imageOptions,response.data.validImageOption);_bindUISetUserCaptchaCode(rnd_visualCaptcha);}}});}
var _bindUISetUserCaptchaCode=function(rnd_visualCaptcha){$('.visualCaptchaImg',visualCaptcha[rnd_visualCaptcha]).click(function(){$('.visualCaptchaImg',visualCaptcha[rnd_visualCaptcha]).css('opacity','0.6');$('.visualCaptchaImg',visualCaptcha[rnd_visualCaptcha]).css('border','2px solid transparent');$(this).css('border','2px solid');$(this).css('opacity','1');_setUserCaptchaCode(rnd_visualCaptcha,$(this).attr('data-captcha'));});}
var _bindUIRefreshCaptchaIcons=function(rnd_visualCaptcha){$('.refreshVisualCaptcha',visualCaptcha[rnd_visualCaptcha]).click(function(event){event.preventDefault();var url=$(this).attr('href');_refreshCaptchaIcons(rnd_visualCaptcha,url);});}
VisualCaptchaModule.prototype={initializeCapcthaIcons:function(rnd_visualCaptcha,imageOptions,validImageOption){_populateCaptchaIcons(rnd_visualCaptcha,imageOptions,validImageOption);_bindUISetUserCaptchaCode(rnd_visualCaptcha);_bindUIRefreshCaptchaIcons(rnd_visualCaptcha);}};return VisualCaptchaModule;})();function visualCaptchaInit(element){var rnd_visualCaptcha=$('.rnd_visualCaptcha',element).val();var vcm=new VisualCaptchaModule(element,rnd_visualCaptcha);vcm.initializeCapcthaIcons(rnd_visualCaptcha,window['imageOptions'+rnd_visualCaptcha],window['validImageOption'+rnd_visualCaptcha]);$(element).addClass('processed');}
$(function($){$(document).bind('visualCaptchaEvent',function(event){$('.captchaContainer:not(.processed)').each(function(){visualCaptchaInit(this);});});$(document).trigger('visualCaptchaEvent');});