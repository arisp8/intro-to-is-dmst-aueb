/*!
 * Fotorama 4.5.0 | http://fotorama.io/license/
 */
(function(window,document,location,$,undefined){"use strict";var _fotoramaClass='fotorama',_fullscreenClass='fullscreen',wrapClass=_fotoramaClass+'__wrap',wrapCss2Class=wrapClass+'--css2',wrapCss3Class=wrapClass+'--css3',wrapVideoClass=wrapClass+'--video',wrapFadeClass=wrapClass+'--fade',wrapSlideClass=wrapClass+'--slide',wrapNoControlsClass=wrapClass+'--no-controls',wrapNoShadowsClass=wrapClass+'--no-shadows',wrapPanYClass=wrapClass+'--pan-y',wrapRtlClass=wrapClass+'--rtl',wrapOnlyActiveClass=wrapClass+'--only-active',stageClass=_fotoramaClass+'__stage',stageFrameClass=stageClass+'__frame',stageFrameVideoClass=stageFrameClass+'--video',stageShaftClass=stageClass+'__shaft',grabClass=_fotoramaClass+'__grab',pointerClass=_fotoramaClass+'__pointer',arrClass=_fotoramaClass+'__arr',arrDisabledClass=arrClass+'--disabled',arrPrevClass=arrClass+'--prev',arrNextClass=arrClass+'--next',arrArrClass=arrClass+'__arr',navClass=_fotoramaClass+'__nav',navWrapClass=navClass+'-wrap',navShaftClass=navClass+'__shaft',navDotsClass=navClass+'--dots',navThumbsClass=navClass+'--thumbs',navFrameClass=navClass+'__frame',navFrameDotClass=navFrameClass+'--dot',navFrameThumbClass=navFrameClass+'--thumb',fadeClass=_fotoramaClass+'__fade',fadeFrontClass=fadeClass+'-front',fadeRearClass=fadeClass+'-rear',shadowClass=_fotoramaClass+'__shadow',shadowsClass=shadowClass+'s',shadowsLeftClass=shadowsClass+'--left',shadowsRightClass=shadowsClass+'--right',activeClass=_fotoramaClass+'__active',selectClass=_fotoramaClass+'__select',hiddenClass=_fotoramaClass+'--hidden',fullscreenClass=_fotoramaClass+'--fullscreen',fullscreenIconClass=_fotoramaClass+'__fullscreen-icon',errorClass=_fotoramaClass+'__error',loadingClass=_fotoramaClass+'__loading',loadedClass=_fotoramaClass+'__loaded',loadedFullClass=loadedClass+'--full',loadedImgClass=loadedClass+'--img',grabbingClass=_fotoramaClass+'__grabbing',imgClass=_fotoramaClass+'__img',imgFullClass=imgClass+'--full',dotClass=_fotoramaClass+'__dot',thumbClass=_fotoramaClass+'__thumb',thumbBorderClass=thumbClass+'-border',htmlClass=_fotoramaClass+'__html',videoClass=_fotoramaClass+'__video',videoPlayClass=videoClass+'-play',videoCloseClass=videoClass+'-close',captionClass=_fotoramaClass+'__caption',captionWrapClass=_fotoramaClass+'__caption__wrap',spinnerClass=_fotoramaClass+'__spinner';var JQUERY_VERSION=$&&$.fn.jquery.split('.');if(!JQUERY_VERSION||JQUERY_VERSION[0]<1||(JQUERY_VERSION[0]==1&&JQUERY_VERSION[1]<8)){throw'Fotorama requires jQuery 1.8 or later and will not run without it.';return;}
var _={};var Modernizr=(function(window,document,undefined){var version='2.6.2',Modernizr={},docElement=document.documentElement,mod='modernizr',modElem=document.createElement(mod),mStyle=modElem.style,inputElem,toString={}.toString,prefixes=' -webkit- -moz- -o- -ms- '.split(' '),omPrefixes='Webkit Moz O ms',cssomPrefixes=omPrefixes.split(' '),domPrefixes=omPrefixes.toLowerCase().split(' '),tests={},inputs={},attrs={},classes=[],slice=classes.slice,featureName,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement('div'),body=document.body,fakeBody=body||document.createElement('body');if(parseInt(nodes,10)){while(nodes--){node=document.createElement('div');node.id=testnames?testnames[nodes]:mod+(nodes+1);div.appendChild(node);}}
style=['&#173;','<style id="s',mod,'">',rule,'</style>'].join('');div.id=mod;(body?div:fakeBody).innerHTML+=style;fakeBody.appendChild(div);if(!body){fakeBody.style.background='';fakeBody.style.overflow='hidden';docOverflow=docElement.style.overflow;docElement.style.overflow='hidden';docElement.appendChild(fakeBody);}
ret=callback(div,rule);if(!body){fakeBody.parentNode.removeChild(fakeBody);docElement.style.overflow=docOverflow;}else{div.parentNode.removeChild(div);}
return!!ret;},_hasOwnProperty=({}).hasOwnProperty,hasOwnProp;if(!is(_hasOwnProperty,'undefined')&&!is(_hasOwnProperty.call,'undefined')){hasOwnProp=function(object,property){return _hasOwnProperty.call(object,property);};}
else{hasOwnProp=function(object,property){return((property in object)&&is(object.constructor.prototype[property],'undefined'));};}
if(!Function.prototype.bind){Function.prototype.bind=function bind(that){var target=this;if(typeof target!="function"){throw new TypeError();}
var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F();var result=target.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result;}
return self;}else{return target.apply(that,args.concat(slice.call(arguments)));}};return bound;};}
function setCss(str){mStyle.cssText=str;}
function setCssAll(str1,str2){return setCss(prefixes.join(str1+';')+(str2||''));}
function is(obj,type){return typeof obj===type;}
function contains(str,substr){return!!~(''+str).indexOf(substr);}
function testProps(props,prefixed){for(var i in props){var prop=props[i];if(!contains(prop,"-")&&mStyle[prop]!==undefined){return prefixed=='pfx'?prop:true;}}
return false;}
function testDOMProps(props,obj,elem){for(var i in props){var item=obj[props[i]];if(item!==undefined){if(elem===false)return props[i];if(is(item,'function')){return item.bind(elem||obj);}
return item;}}
return false;}
function testPropsAll(prop,prefixed,elem){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+' '+cssomPrefixes.join(ucProp+' ')+ucProp).split(' ');if(is(prefixed,"string")||is(prefixed,"undefined")){return testProps(props,prefixed);}else{props=(prop+' '+(domPrefixes).join(ucProp+' ')+ucProp).split(' ');return testDOMProps(props,prefixed,elem);}}
tests['csstransforms3d']=function(){var ret=!!testPropsAll('perspective');return ret;};for(var feature in tests){if(hasOwnProp(tests,feature)){featureName=feature.toLowerCase();Modernizr[featureName]=tests[feature]();classes.push((Modernizr[featureName]?'':'no-')+featureName);}}
Modernizr.addTest=function(feature,test){if(typeof feature=='object'){for(var key in feature){if(hasOwnProp(feature,key)){Modernizr.addTest(key,feature[key]);}}}else{feature=feature.toLowerCase();if(Modernizr[feature]!==undefined){return Modernizr;}
test=typeof test=='function'?test():test;if(typeof enableClasses!=="undefined"&&enableClasses){docElement.className+=' '+(test?'':'no-')+feature;}
Modernizr[feature]=test;}
return Modernizr;};setCss('');modElem=inputElem=null;Modernizr._version=version;Modernizr._prefixes=prefixes;Modernizr._domPrefixes=domPrefixes;Modernizr._cssomPrefixes=cssomPrefixes;Modernizr.testProp=function(prop){return testProps([prop]);};Modernizr.testAllProps=testPropsAll;Modernizr.testStyles=injectElementWithStyles;Modernizr.prefixed=function(prop,obj,elem){if(!obj){return testPropsAll(prop,'pfx');}else{return testPropsAll(prop,obj,elem);}};return Modernizr;})(window,document);var
fullScreenApi={ok:false,is:function(){return false;},request:function(){},cancel:function(){},event:'',prefix:''},browserPrefixes='webkit moz o ms khtml'.split(' ');if(typeof document.cancelFullScreen!='undefined'){fullScreenApi.ok=true;}else{for(var i=0,il=browserPrefixes.length;i<il;i++){fullScreenApi.prefix=browserPrefixes[i];if(typeof document[fullScreenApi.prefix+'CancelFullScreen']!='undefined'){fullScreenApi.ok=true;break;}}}
if(fullScreenApi.ok){fullScreenApi.event=fullScreenApi.prefix+'fullscreenchange';fullScreenApi.is=function(){switch(this.prefix){case'':return document.fullScreen;case'webkit':return document.webkitIsFullScreen;default:return document[this.prefix+'FullScreen'];}};fullScreenApi.request=function(el){return(this.prefix==='')?el.requestFullScreen():el[this.prefix+'RequestFullScreen']();};fullScreenApi.cancel=function(el){return(this.prefix==='')?document.cancelFullScreen():document[this.prefix+'CancelFullScreen']();};}
var Spinner,spinnerDefaults={lines:12,length:5,width:2,radius:7,corners:1,rotate:15,color:'rgba(128, 128, 128, .75)',hwaccel:true},spinnerOverride={top:'auto',left:'auto',className:''};(function(root,factory){Spinner=factory();}
(this,function(){"use strict";var prefixes=['webkit','Moz','ms','O'],animations={},useCssAnimations
function createEl(tag,prop){var el=document.createElement(tag||'div'),n
for(n in prop)el[n]=prop[n]
return el}
function ins(parent){for(var i=1,n=arguments.length;i<n;i++)
parent.appendChild(arguments[i])
return parent}
var sheet=(function(){var el=createEl('style',{type:'text/css'})
ins(document.getElementsByTagName('head')[0],el)
return el.sheet||el.styleSheet}())
function addAnimation(alpha,trail,i,lines){var name=['opacity',trail,~~(alpha*100),i,lines].join('-'),start=0.01+i/lines*100,z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf('Animation')).toLowerCase(),pre=prefix&&'-'+prefix+'-'||''
if(!animations[name]){sheet.insertRule('@'+pre+'keyframes '+name+'{'+'0%{opacity:'+z+'}'+
start+'%{opacity:'+alpha+'}'+
(start+0.01)+'%{opacity:1}'+
(start+trail)%100+'%{opacity:'+alpha+'}'+'100%{opacity:'+z+'}'+'}',sheet.cssRules.length)
animations[name]=1}
return name}
function vendor(el,prop){var s=el.style,pp,i
prop=prop.charAt(0).toUpperCase()+prop.slice(1)
for(i=0;i<prefixes.length;i++){pp=prefixes[i]+prop
if(s[pp]!==undefined)return pp}
if(s[prop]!==undefined)return prop}
function css(el,prop){for(var n in prop)
el.style[vendor(el,n)||n]=prop[n]
return el}
function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i]
for(var n in def)
if(obj[n]===undefined)obj[n]=def[n]}
return obj}
function pos(el){var o={x:el.offsetLeft,y:el.offsetTop}
while((el=el.offsetParent))
o.x+=el.offsetLeft,o.y+=el.offsetTop
return o}
function getColor(color,idx){return typeof color=='string'?color:color[idx%color.length]}
var defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:'#000',direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:'spinner',top:'auto',left:'auto',position:'relative'}
function Spinner(o){if(typeof this=='undefined')return new Spinner(o)
this.opts=merge(o||{},Spinner.defaults,defaults)}
Spinner.defaults={}
merge(Spinner.prototype,{spin:function(target){this.stop()
var self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width,ep,tp
if(target){target.insertBefore(el,target.firstChild||null)
tp=pos(target)
ep=pos(el)
css(el,{left:(o.left=='auto'?tp.x-ep.x+(target.offsetWidth>>1):parseInt(o.left,10)+mid)+'px',top:(o.top=='auto'?tp.y-ep.y+(target.offsetHeight>>1):parseInt(o.top,10)+mid)+'px'})}
el.setAttribute('role','progressbar')
self.lines(el,self.opts)
if(!useCssAnimations){var i=0,start=(o.lines-1)*(1-o.direction)/2,alpha,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;(function anim(){i++;for(var j=0;j<o.lines;j++){alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity)
self.opacity(el,j*o.direction+start,alpha,o)}
self.timeout=self.el&&setTimeout(anim,~~(1000/fps))})()}
return self},stop:function(){var el=this.el
if(el){clearTimeout(this.timeout)
if(el.parentNode)el.parentNode.removeChild(el)
this.el=undefined}
return this},lines:function(el,o){var i=0,start=(o.lines-1)*(1-o.direction)/2,seg
function fill(color,shadow){return css(createEl(),{position:'absolute',width:(o.length+o.width)+'px',height:o.width+'px',background:color,boxShadow:shadow,transformOrigin:'left',transform:'rotate('+~~(360/o.lines*i+o.rotate)+'deg) translate('+o.radius+'px'+',0)',borderRadius:(o.corners*o.width>>1)+'px'})}
for(;i<o.lines;i++){seg=css(createEl(),{position:'absolute',top:1+~(o.width/2)+'px',transform:o.hwaccel?'translate3d(0,0,0)':'',opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+' '+1/o.speed+'s linear infinite'})
if(o.shadow)ins(seg,css(fill('#000','0 0 4px '+'#000'),{top:2+'px'}))
ins(el,ins(seg,fill(getColor(o.color,i),'0 0 1px rgba(0,0,0,.1)')))}
return el},opacity:function(el,i,val){if(i<el.childNodes.length)el.childNodes[i].style.opacity=val}})
function initVML(){function vml(tag,attr){return createEl('<'+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}
sheet.addRule('.spin-vml','behavior:url(#default#VML)')
Spinner.prototype.lines=function(el,o){var r=o.length+o.width,s=2*r
function grp(){return css(vml('group',{coordsize:s+' '+s,coordorigin:-r+' '+-r}),{width:s,height:s})}
var margin=-(o.width+o.length)*2+'px',g=css(grp(),{position:'absolute',top:margin,left:margin}),i
function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+'deg',left:~~dx}),ins(css(vml('roundrect',{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml('fill',{color:getColor(o.color,i),opacity:o.opacity}),vml('stroke',{opacity:0}))))}
if(o.shadow)
for(i=1;i<=o.lines;i++)
seg(i,-2,'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)')
for(i=1;i<=o.lines;i++)seg(i)
return ins(el,g)}
Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild
o=o.shadow&&o.lines||0
if(c&&i+o<c.childNodes.length){c=c.childNodes[i+o];c=c&&c.firstChild;c=c&&c.firstChild
if(c)c.opacity=val}}}
var probe=css(createEl('group'),{behavior:'url(#default#VML)'})
if(!vendor(probe,'transform')&&probe.adj)initVML()
else useCssAnimations=vendor(probe,'animation')
return Spinner}));function bez(coOrdArray){var encodedFuncName="bez_"+$.makeArray(arguments).join("_").replace(".","p");if(typeof $['easing'][encodedFuncName]!=="function"){var polyBez=function(p1,p2){var A=[null,null],B=[null,null],C=[null,null],bezCoOrd=function(t,ax){C[ax]=3*p1[ax];B[ax]=3*(p2[ax]-p1[ax])-C[ax];A[ax]=1-C[ax]-B[ax];return t*(C[ax]+t*(B[ax]+t*A[ax]));},xDeriv=function(t){return C[0]+t*(2*B[0]+3*A[0]*t);},xForT=function(t){var x=t,i=0,z;while(++i<14){z=bezCoOrd(x,0)-t;if(Math.abs(z)<1e-3)break;x-=z/xDeriv(x);}
return x;};return function(t){return bezCoOrd(xForT(t),1);}};$['easing'][encodedFuncName]=function(x,t,b,c,d){return c*polyBez([coOrdArray[0],coOrdArray[1]],[coOrdArray[2],coOrdArray[3]])(t/d)+b;}}
return encodedFuncName;}
var $WINDOW=$(window),$DOCUMENT=$(document),$HTML,$BODY,QUIRKS_FORCE=location.hash.replace('#','')==='quirks',TRANSFORMS3D=Modernizr.csstransforms3d,CSS3=TRANSFORMS3D&&!QUIRKS_FORCE,COMPAT=TRANSFORMS3D||document.compatMode==='CSS1Compat',FULLSCREEN=fullScreenApi.ok,MOBILE=navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i),SLOW=!CSS3||MOBILE,ADD_EVENT_LISTENER='addEventListener',MS_POINTER=navigator.msPointerEnabled,WHEEL="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll",TOUCH_TIMEOUT=250,TRANSITION_DURATION=600,SCROLL_LOCK_TIMEOUT=1400,AUTOPLAY_INTERVAL=5000,MARGIN=2,THUMB_SIZE=75,WIDTH=500,HEIGHT=333,STAGE_FRAME_KEY='$stageFrame',NAV_DOT_FRAME_KEY='$navDotFrame',NAV_THUMB_FRAME_KEY='$navThumbFrame',BEZIER=bez([.1,0,.25,1]);function noop(){}
function minMaxLimit(value,min,max){return Math.max(isNaN(min)?-Infinity:min,Math.min(isNaN(max)?Infinity:max,value));}
function readTransform(css){return css.match(/ma/)&&css.match(/-?\d+(?!d)/g)[css.match(/3d/)?12:4];}
function readPosition($el){if(CSS3){return+readTransform($el.css('transform'));}else{return+$el.css('left').replace('px','');}}
function getTranslate(pos,_001){var obj={};if(CSS3){obj.transform='translate3d('+(pos+(_001?0.001:0))+'px,0,0)';}else{obj.left=pos;}
return obj;}
function getDuration(time){return{'transition-duration':time+'ms'};}
function numberFromMeasure(value,measure){return+String(value).replace(measure||'px','')||undefined;}
function numberFromPercent(value){return/%$/.test(value)&&numberFromMeasure(value,'%');}
function numberFromWhatever(value,whole){return numberFromPercent(value)/100*whole||numberFromMeasure(value);}
function measureIsValid(value){return(!!numberFromMeasure(value)||!!numberFromMeasure(value,'%'))&&value;}
function getPosByIndex(index,side,margin,baseIndex){return(index-(baseIndex||0))*(side+(margin||0));}
function getIndexByPos(pos,side,margin,baseIndex){return-Math.round(pos/(side+(margin||0))-(baseIndex||0));}
function bindTransitionEnd($el){var elData=$el.data();if(elData.tEnd)return;var el=$el[0],transitionEndEvent={WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd otransitionend',msTransition:'MSTransitionEnd',transition:'transitionend'};el.addEventListener(transitionEndEvent[Modernizr.prefixed('transition')],function(e){elData.tProp&&e.propertyName.match(elData.tProp)&&elData.onEndFn();},false);elData.tEnd=true;}
function afterTransition($el,property,fn,time){var ok,elData=$el.data();if(elData){elData.onEndFn=function(){if(ok)return;ok=true;clearTimeout(elData.tT);fn();};elData.tProp=property;clearTimeout(elData.tT);elData.tT=setTimeout(function(){elData.onEndFn();},time*1.5);bindTransitionEnd($el);}}
function stop($el,left,_001){if($el.length){var elData=$el.data();if(CSS3){$el.css(getDuration(0));elData.onEndFn=noop;clearTimeout(elData.tT);}else{$el.stop();}
var lockedLeft=getNumber(left,function(){return readPosition($el);});$el.css(getTranslate(lockedLeft,_001));return lockedLeft;}}
function getNumber(){var number;for(var _i=0,_l=arguments.length;_i<_l;_i++){number=_i?arguments[_i]():arguments[_i];if(typeof number==='number'){break;}}
return number;}
function edgeResistance(pos,edge){return Math.round(pos+((edge-pos)/1.5));}
function getProtocol(){getProtocol.p=getProtocol.p||(location.protocol==='https:'?'https://':'http://');return getProtocol.p;}
function parseHref(href){var a=document.createElement('a');a.href=href;return a;}
function findVideoId(href,forceVideo){if(typeof href!=='string')return href;href=parseHref(href);var id,type;if(href.host.match(/youtube\.com/)&&href.search){id=href.search.split('v=')[1];if(id){var ampersandPosition=id.indexOf('&');if(ampersandPosition!==-1){id=id.substring(0,ampersandPosition);}
type='youtube';}}else if(href.host.match(/youtube\.com|youtu\.be/)){id=href.pathname.replace(/^\/(embed\/|v\/)?/,'').replace(/\/.*/,'');type='youtube';}else if(href.host.match(/vimeo\.com/)){type='vimeo';id=href.pathname.replace(/^\/(video\/)?/,'').replace(/\/.*/,'');}
if((!id||!type)&&forceVideo){id=href.href;type='custom';}
return id?{id:id,type:type,s:href.search.replace(/^\?/,'')}:false;}
function getVideoThumbs(dataFrame,data,fotorama){var img,thumb,video=dataFrame.video;if(video.type==='youtube'){thumb=getProtocol()+'img.youtube.com/vi/'+video.id+'/default.jpg';img=thumb.replace(/\/default.jpg$/,'/hqdefault.jpg');dataFrame.thumbsReady=true;}else if(video.type==='vimeo'){$.ajax({url:getProtocol()+'vimeo.com/api/v2/video/'+video.id+'.json',dataType:'jsonp',success:function(json){dataFrame.thumbsReady=true;updateData(data,{img:json[0].thumbnail_large,thumb:json[0].thumbnail_small},dataFrame.i,fotorama);}});}else{dataFrame.thumbsReady=true;}
return{img:img,thumb:thumb}}
function updateData(data,_dataFrame,i,fotorama){for(var _i=0,_l=data.length;_i<_l;_i++){var dataFrame=data[_i];if(dataFrame.i===i&&dataFrame.thumbsReady){var clear={videoReady:true};clear[STAGE_FRAME_KEY]=clear[NAV_THUMB_FRAME_KEY]=clear[NAV_DOT_FRAME_KEY]=false;fotorama.splice(_i,1,$.extend({},dataFrame,clear,_dataFrame));break;}}}
function getDataFromHtml($el){var data=[];function getDataFromImg($img,imgData,checkVideo){var $child=$img.children('img').eq(0),_imgHref=$img.attr('href'),_imgSrc=$img.attr('src'),_thumbSrc=$child.attr('src'),_video=imgData.video,video=checkVideo?findVideoId(_imgHref,_video===true):false;if(video){_imgHref=false;}else{video=_video;}
getDimensions($img,$child,$.extend(imgData,{video:video,img:imgData.img||_imgHref||_imgSrc||_thumbSrc,thumb:imgData.thumb||_thumbSrc||_imgSrc||_imgHref}));}
function getDimensions($img,$child,imgData){var separateThumbFLAG=imgData.thumb&&imgData.img!==imgData.thumb,width=numberFromMeasure(imgData.width||$img.attr('width')),height=numberFromMeasure(imgData.height||$img.attr('height'));$.extend(imgData,{width:width,height:height,thumbratio:getRatio(imgData.thumbratio||(numberFromMeasure(imgData.thumbwidth||($child&&$child.attr('width'))||separateThumbFLAG||width)/numberFromMeasure(imgData.thumbheight||($child&&$child.attr('height'))||separateThumbFLAG||height)))});}
$el.children().each(function(){var $this=$(this),dataFrame=optionsToLowerCase($.extend($this.data(),{id:$this.attr('id')}));if($this.is('a, img')){getDataFromImg($this,dataFrame,true);}else if(!$this.is(':empty')){getDimensions($this,null,$.extend(dataFrame,{html:this,_html:$this.html()}));}else return;data.push(dataFrame);});return data;}
function isHidden(el){return el.offsetWidth===0&&el.offsetHeight===0;}
function isDetached(el){return!$.contains(document.documentElement,el);}
function waitFor(test,fn,timeout){if(test()){fn();}else{setTimeout(function(){waitFor(test,fn);},timeout||100);}}
function setHash(hash){location.replace(location.protocol
+'//'
+location.host
+location.pathname.replace(/^\/?/,'/')
+location.search
+'#'+hash);}
function fit($el,measuresToFit,method){var elData=$el.data(),measures=elData.measures;if(measures&&(!elData.l||elData.l.W!==measures.width||elData.l.H!==measures.height||elData.l.r!==measures.ratio||elData.l.w!==measuresToFit.w||elData.l.h!==measuresToFit.h||elData.l.m!==method)){var width=measures.width,height=measures.height,ratio=measuresToFit.w/measuresToFit.h,biggerRatioFLAG=measures.ratio>=ratio,fitFLAG=method==='scaledown',containFLAG=method==='contain',coverFLAG=method==='cover';if(biggerRatioFLAG&&(fitFLAG||containFLAG)||!biggerRatioFLAG&&coverFLAG){width=minMaxLimit(measuresToFit.w,0,fitFLAG?width:Infinity);height=width/measures.ratio;}else if(biggerRatioFLAG&&coverFLAG||!biggerRatioFLAG&&(fitFLAG||containFLAG)){height=minMaxLimit(measuresToFit.h,0,fitFLAG?height:Infinity);width=height*measures.ratio;}
$el.css({width:Math.ceil(width),height:Math.ceil(height),marginLeft:Math.floor(-width/2),marginTop:Math.floor(-height/2)});elData.l={W:measures.width,H:measures.height,r:measures.ratio,w:measuresToFit.w,h:measuresToFit.h,m:method};}
return true;}
function setStyle($el,style){var el=$el[0];if(el.styleSheet){el.styleSheet.cssText=style;}else{$el.html(style);}}
function findShadowEdge(pos,min,max){return min===max?false:pos<=min?'left':pos>=max?'right':'left right';}
function getIndexFromHash(hash,data,ok,startindex){if(!ok)return false;if(!isNaN(hash))return hash-(startindex?0:1);var index;for(var _i=0,_l=data.length;_i<_l;_i++){var dataFrame=data[_i];if(dataFrame.id===hash){index=_i;break;}}
return index;}
function smartClick($el,fn,_options){_options=_options||{};$el.each(function(){var $this=$(this),thisData=$this.data(),startEvent;if(thisData.clickOn)return;thisData.clickOn=true;$.extend(touch($this,{onStart:function(e){startEvent=e;(_options.onStart||noop).call(this,e);},onMove:_options.onMove||noop,onTouchEnd:_options.onTouchEnd||noop,onEnd:function(result){if(result.moved)return;fn.call(this,startEvent);}}),{noMove:true});});}
function div(classes,child){return'<div class="'+classes+'">'+(child||'')+'</div>';}
function shuffle(array){var l=array.length;while(l){var i=Math.floor(Math.random()*l--);var t=array[l];array[l]=array[i];array[i]=t;}
return array;}
function clone(array){return Object.prototype.toString.call(array)=='[object Array]'&&$.map(array,function(frame){return $.extend({},frame);});}
function lockScroll(left,top){$WINDOW.scrollLeft(left).scrollTop(top);}
function optionsToLowerCase(options){if(options){var opts={};$.each(options,function(key,value){opts[key.toLowerCase()]=value;});return opts;}}
function getRatio(_ratio){if(!_ratio)return;var ratio=+_ratio;if(!isNaN(ratio)){return ratio;}else{ratio=_ratio.split('/');return+ratio[0]/+ratio[1]||undefined;}}
function stopEvent(e,stopPropagation){e.preventDefault();stopPropagation&&e.stopPropagation();}
function getDirectionSign(forward){return forward?'>':'<';}
function slide($el,options){var elData=$el.data(),elPos=Math.round(options.pos),onEndFn=function(){elData.sliding=false;(options.onEnd||noop)();};if(typeof options.overPos!=='undefined'&&options.overPos!==options.pos){elPos=options.overPos;onEndFn=function(){slide($el,$.extend({},options,{overPos:options.pos,time:Math.max(TRANSITION_DURATION,options.time/2)}))};}
var translate=$.extend(getTranslate(elPos,options._001),options.width&&{width:options.width});elData.sliding=true;if(CSS3){$el.css($.extend(getDuration(options.time),translate));if(options.time>10){afterTransition($el,'transform',onEndFn,options.time);}else{onEndFn();}}else{$el.stop().animate(translate,options.time,BEZIER,onEndFn);}}
function fade($el1,$el2,$frames,options,fadeStack,chain){var chainedFLAG=typeof chain!=='undefined';if(!chainedFLAG){fadeStack.push(arguments);Array.prototype.push.call(arguments,fadeStack.length);if(fadeStack.length>1)return;}
$el1=$el1||$($el1);$el2=$el2||$($el2);var _$el1=$el1[0],_$el2=$el2[0],crossfadeFLAG=options.method==='crossfade',onEndFn=function(){if(!onEndFn.done){onEndFn.done=true;var args=(chainedFLAG||fadeStack.shift())&&fadeStack.shift();args&&fade.apply(this,args);(options.onEnd||noop)(!!args);}},time=options.time/(chain||1);$frames.removeClass(fadeRearClass+' '+fadeFrontClass);$el1.stop().addClass(fadeRearClass);$el2.stop().addClass(fadeFrontClass);crossfadeFLAG&&_$el2&&$el1.fadeTo(0,0);$el1.fadeTo(crossfadeFLAG?time:0,1,crossfadeFLAG&&onEndFn);$el2.fadeTo(time,0,onEndFn);(_$el1&&crossfadeFLAG)||_$el2||onEndFn();}
var lastEvent,moveEventType,preventEvent,preventEventTimeout;function extendEvent(e){var touch=(e.touches||[])[0]||e;e._x=touch.pageX;e._y=touch.clientY;e._now=$.now();}
function touch($el,options){var el=$el[0],tail={},touchEnabledFLAG,startEvent,$target,controlTouch,touchFLAG,targetIsSelectFLAG,targetIsLinkFlag,tolerance,moved;function onStart(e){$target=$(e.target);tail.checked=targetIsSelectFLAG=targetIsLinkFlag=moved=false;if(touchEnabledFLAG||tail.flow||(e.touches&&e.touches.length>1)||e.which>1||(lastEvent&&lastEvent.type!==e.type&&preventEvent)||(targetIsSelectFLAG=options.select&&$target.is(options.select,el)))return targetIsSelectFLAG;touchFLAG=e.type==='touchstart';targetIsLinkFlag=$target.is('a, a *',el);controlTouch=tail.control;tolerance=(tail.noMove||tail.noSwipe||controlTouch)?16:!tail.snap?4:0;extendEvent(e);startEvent=lastEvent=e;moveEventType=e.type.replace(/down|start/,'move').replace(/Down/,'Move');(options.onStart||noop).call(el,e,{control:controlTouch,$target:$target});touchEnabledFLAG=tail.flow=true;if(!touchFLAG||tail.go)stopEvent(e);}
function onMove(e){if((e.touches&&e.touches.length>1)||(MS_POINTER&&!e.isPrimary)||moveEventType!==e.type||!touchEnabledFLAG){touchEnabledFLAG&&onEnd();(options.onTouchEnd||noop)();return;}
extendEvent(e);var xDiff=Math.abs(e._x-startEvent._x),yDiff=Math.abs(e._y-startEvent._y),xyDiff=xDiff-yDiff,xWin=(tail.go||tail.x||xyDiff>=0)&&!tail.noSwipe,yWin=xyDiff<0;if(touchFLAG&&!tail.checked){if(touchEnabledFLAG=xWin){stopEvent(e);}}else{stopEvent(e);(options.onMove||noop).call(el,e,{touch:touchFLAG});}
if(!moved&&Math.sqrt(Math.pow(xDiff,2)+Math.pow(yDiff,2))>tolerance){moved=true;}
tail.checked=tail.checked||xWin||yWin;}
function onEnd(e){(options.onTouchEnd||noop)();var _touchEnabledFLAG=touchEnabledFLAG;tail.control=touchEnabledFLAG=false;if(_touchEnabledFLAG){tail.flow=false;}
if(!_touchEnabledFLAG||(targetIsLinkFlag&&!tail.checked))return;e&&stopEvent(e);preventEvent=true;clearTimeout(preventEventTimeout);preventEventTimeout=setTimeout(function(){preventEvent=false;},1000);(options.onEnd||noop).call(el,{moved:moved,$target:$target,control:controlTouch,touch:touchFLAG,startEvent:startEvent,aborted:!e||e.type==='MSPointerCancel'});}
function onOtherStart(){if(tail.flow)return;setTimeout(function(){tail.flow=true;},10);}
function onOtherEnd(){if(!tail.flow)return;setTimeout(function(){tail.flow=false;},TOUCH_TIMEOUT);}
if(MS_POINTER){el[ADD_EVENT_LISTENER]('MSPointerDown',onStart,false);document[ADD_EVENT_LISTENER]('MSPointerMove',onMove,false);document[ADD_EVENT_LISTENER]('MSPointerCancel',onEnd,false);document[ADD_EVENT_LISTENER]('MSPointerUp',onEnd,false);}else{if(el[ADD_EVENT_LISTENER]){el[ADD_EVENT_LISTENER]('touchstart',onStart,false);el[ADD_EVENT_LISTENER]('touchmove',onMove,false);el[ADD_EVENT_LISTENER]('touchend',onEnd,false);document[ADD_EVENT_LISTENER]('touchstart',onOtherStart,false);document[ADD_EVENT_LISTENER]('touchend',onOtherEnd,false);document[ADD_EVENT_LISTENER]('touchcancel',onOtherEnd,false);window[ADD_EVENT_LISTENER]('scroll',onOtherEnd,false);}
$el.on('mousedown',onStart);$DOCUMENT.on('mousemove',onMove).on('mouseup',onEnd);}
$el.on('click','a',function(e){tail.checked&&stopEvent(e);});return tail;}
function moveOnTouch($el,options){var el=$el[0],elData=$el.data(),tail={},startCoo,coo,startElPos,moveElPos,edge,moveTrack,startTime,endTime,min,max,snap,slowFLAG,controlFLAG,moved,tracked;function startTracking(e,noStop){tracked=true;startCoo=coo=e._x;startTime=e._now;moveTrack=[[startTime,startCoo]];startElPos=moveElPos=tail.noMove||noStop?0:stop($el,(options.getPos||noop)(),options._001);(options.onStart||noop).call(el,e);}
function onStart(e,result){min=tail.min;max=tail.max;snap=tail.snap;slowFLAG=e.altKey;tracked=moved=false;controlFLAG=result.control;if(!controlFLAG&&!elData.sliding){startTracking(e);}}
function onMove(e,result){if(!tail.noSwipe){if(!tracked){startTracking(e);}
coo=e._x;moveTrack.push([e._now,coo]);moveElPos=startElPos-(startCoo-coo);edge=findShadowEdge(moveElPos,min,max);if(moveElPos<=min){moveElPos=edgeResistance(moveElPos,min);}else if(moveElPos>=max){moveElPos=edgeResistance(moveElPos,max);}
if(!tail.noMove){$el.css(getTranslate(moveElPos,options._001));if(!moved){moved=true;result.touch||MS_POINTER||$el.addClass(grabbingClass);}
(options.onMove||noop).call(el,e,{pos:moveElPos,edge:edge});}}}
function onEnd(result){if(tail.noSwipe&&result.moved)return;if(!tracked){startTracking(result.startEvent,true);}
result.touch||MS_POINTER||$el.removeClass(grabbingClass);endTime=$.now();var _backTimeIdeal=endTime-TOUCH_TIMEOUT,_backTime,_timeDiff,_timeDiffLast,backTime=null,backCoo,virtualPos,limitPos,newPos,overPos,time=TRANSITION_DURATION,speed,friction=options.friction;for(var _i=moveTrack.length-1;_i>=0;_i--){_backTime=moveTrack[_i][0];_timeDiff=Math.abs(_backTime-_backTimeIdeal);if(backTime===null||_timeDiff<_timeDiffLast){backTime=_backTime;backCoo=moveTrack[_i][1];}else if(backTime===_backTimeIdeal||_timeDiff>_timeDiffLast){break;}
_timeDiffLast=_timeDiff;}
newPos=minMaxLimit(moveElPos,min,max);var cooDiff=backCoo-coo,forwardFLAG=cooDiff>=0,timeDiff=endTime-backTime,longTouchFLAG=timeDiff>TOUCH_TIMEOUT,swipeFLAG=!longTouchFLAG&&moveElPos!==startElPos&&newPos===moveElPos;if(snap){newPos=minMaxLimit(Math[swipeFLAG?(forwardFLAG?'floor':'ceil'):'round'](moveElPos/snap)*snap,min,max);min=max=newPos;}
if(swipeFLAG&&(snap||newPos===moveElPos)){speed=-(cooDiff/timeDiff);time*=minMaxLimit(Math.abs(speed),options.timeLow,options.timeHigh);virtualPos=Math.round(moveElPos+speed*time/friction);if(!snap){newPos=virtualPos;}
if(!forwardFLAG&&virtualPos>max||forwardFLAG&&virtualPos<min){limitPos=forwardFLAG?min:max;overPos=virtualPos-limitPos;if(!snap){newPos=limitPos;}
overPos=minMaxLimit(newPos+overPos*.03,limitPos-50,limitPos+50);time=Math.abs((moveElPos-overPos)/(speed/friction));}}
time*=slowFLAG?10:1;(options.onEnd||noop).call(el,$.extend(result,{moved:result.moved||longTouchFLAG&&snap,pos:moveElPos,newPos:newPos,overPos:overPos,time:time}));}
tail=$.extend(touch(options.$wrap,{onStart:onStart,onMove:onMove,onTouchEnd:options.onTouchEnd,onEnd:onEnd,select:options.select}),tail);return tail;}
function wheel($el,options){var el=$el[0],lockFLAG,lastDirection,lastNow,tail={prevent:{}};el[ADD_EVENT_LISTENER]&&el[ADD_EVENT_LISTENER](WHEEL,function(e){var yDelta=e.wheelDeltaY||-1*e.deltaY||0,xDelta=e.wheelDeltaX||-1*e.deltaX||0,xWin=Math.abs(xDelta)>Math.abs(yDelta),direction=getDirectionSign(xDelta<0),sameDirection=lastDirection===direction,now=$.now(),tooFast=now-lastNow<TOUCH_TIMEOUT;lastDirection=direction;lastNow=now;if(!xWin||!tail.ok||tail.prevent[direction]&&!lockFLAG){return;}else{stopEvent(e,true);if(lockFLAG&&sameDirection&&tooFast){return;}}
if(options.shift){lockFLAG=true;clearTimeout(tail.t);tail.t=setTimeout(function(){lockFLAG=false;},SCROLL_LOCK_TIMEOUT);}
(options.onEnd||noop)(e,options.shift?direction:xDelta);},false);return tail;}
jQuery.Fotorama=function($fotorama,opts){$HTML=$HTML||$('html');$BODY=$BODY||$('body');var that=this,stamp=$.now(),stampClass=_fotoramaClass+stamp,fotorama=$fotorama[0],data,dataFrameCount=1,fotoramaData=$fotorama.data(),size,$style=$('<style></style>'),$anchor=$(div(hiddenClass)),$wrap=$(div(wrapClass)),$stage=$(div(stageClass)).appendTo($wrap),stage=$stage[0],$stageShaft=$(div(stageShaftClass)).appendTo($stage),$stageFrame=$(),$arrPrev=$(div(arrClass+' '+arrPrevClass)),$arrNext=$(div(arrClass+' '+arrNextClass)),$arrs=$arrPrev.add($arrNext).appendTo($stage),$navWrap=$(div(navWrapClass)),$nav=$(div(navClass)).appendTo($navWrap),$navShaft=$(div(navShaftClass)).appendTo($nav),$navFrame,$navDotFrame=$(),$navThumbFrame=$(),stageShaftData=$stageShaft.data(),navShaftData=$navShaft.data(),$thumbBorder=$(div(thumbBorderClass)).appendTo($navShaft),$fullscreenIcon=$(div(fullscreenIconClass)),fullscreenIcon=$fullscreenIcon[0],$videoPlay=$(div(videoPlayClass)),$videoClose=$(div(videoCloseClass)).appendTo($stage),videoClose=$videoClose[0],spinner,$spinner=$(div(spinnerClass)),$videoPlaying,activeIndex=false,activeFrame,activeIndexes,repositionIndex,dirtyIndex,lastActiveIndex,prevIndex,nextIndex,startIndex,o_loop,o_nav,o_navThumbs,o_navTop,o_allowFullScreen,o_nativeFullScreen,o_fade,o_thumbSide,o_thumbSide2,o_transitionDuration,o_transition,o_shadows,o_rtl,lastOptions={},measures={},measuresSetFLAG,stageShaftTouchTail={},stageWheelTail={},navShaftTouchTail={},navWheelTail={},scrollTop,scrollLeft,showedFLAG,pausedAutoplayFLAG,stoppedAutoplayFLAG,toDeactivate={},toDetach={},measuresStash,touchedFLAG,hoverFLAG,navFrameKey,stageLeft=0,fadeStack=[];$wrap[STAGE_FRAME_KEY]=$(div(stageFrameClass));$wrap[NAV_THUMB_FRAME_KEY]=$(div(navFrameClass+' '+navFrameThumbClass,div(thumbClass)));$wrap[NAV_DOT_FRAME_KEY]=$(div(navFrameClass+' '+navFrameDotClass,div(dotClass)));toDeactivate[STAGE_FRAME_KEY]=[];toDeactivate[NAV_THUMB_FRAME_KEY]=[];toDeactivate[NAV_DOT_FRAME_KEY]=[];toDetach[STAGE_FRAME_KEY]={};$wrap.addClass(CSS3?wrapCss3Class:wrapCss2Class);fotoramaData.fotorama=this;function checkForVideo(){$.each(data,function(i,dataFrame){if(!dataFrame.i){dataFrame.i=dataFrameCount++;var video=findVideoId(dataFrame.video,true);if(video){var thumbs={};dataFrame.video=video;if(!dataFrame.img&&!dataFrame.thumb){thumbs=getVideoThumbs(dataFrame,data,that);}else{dataFrame.thumbsReady=true;}
updateData(data,{img:thumbs.img,thumb:thumbs.thumb},dataFrame.i,that);}}});}
function bindGlobalEvents(FLAG){var keydownCommon='keydown.'+_fotoramaClass,keydownLocal='keydown.'+_fotoramaClass+stamp,resizeLocal='resize.'+_fotoramaClass+stamp;if(FLAG){$DOCUMENT.on(keydownLocal,function(e){if($videoPlaying&&e.keyCode===27){stopEvent(e);unloadVideo($videoPlaying,true,true);}else if(that.fullScreen||(opts.keyboard&&!that.index)){if(e.keyCode===27){stopEvent(e);that.cancelFullScreen();}else if(e.keyCode===39||(e.keyCode===40&&that.fullScreen)){stopEvent(e);that.show({index:'>',slow:e.altKey,user:true});}else if(e.keyCode===37||(e.keyCode===38&&that.fullScreen)){stopEvent(e);that.show({index:'<',slow:e.altKey,user:true});}}});if(!that.index){$DOCUMENT.off(keydownCommon).on(keydownCommon,'textarea, input, select',function(e){!$BODY.hasClass(_fullscreenClass)&&e.stopPropagation();});}
$WINDOW.on(resizeLocal,that.resize);}else{$DOCUMENT.off(keydownLocal);$WINDOW.off(resizeLocal);}}
function appendElements(FLAG){if(FLAG===appendElements.f)return;if(FLAG){$fotorama.html('').addClass(_fotoramaClass+' '+stampClass).append($wrap).before($style).before($anchor);addInstance(that);}else{$wrap.detach();$style.detach();$anchor.detach();$fotorama.html(fotoramaData.urtext).removeClass(stampClass);hideInstance(that);}
bindGlobalEvents(FLAG);appendElements.f=FLAG;}
function setData(){data=that.data=data||clone(opts.data)||getDataFromHtml($fotorama);size=that.size=data.length;!ready.ok&&opts.shuffle&&shuffle(data);checkForVideo();activeIndex=limitIndex(activeIndex);size&&appendElements(true);}
function stageNoMove(){var _noMove=size<2||$videoPlaying;stageShaftTouchTail.noMove=_noMove||o_fade;stageShaftTouchTail.noSwipe=_noMove||!opts.swipe;!o_transition&&$stageShaft.toggleClass(grabClass,!stageShaftTouchTail.noMove&&!stageShaftTouchTail.noSwipe);MS_POINTER&&$wrap.toggleClass(wrapPanYClass,!stageShaftTouchTail.noSwipe);}
function setAutoplayInterval(interval){if(interval===true)interval='';opts.autoplay=Math.max(+interval||AUTOPLAY_INTERVAL,o_transitionDuration*1.5);}
function addOrRemove(FLAG){return FLAG?'add':'remove';}
function setOptions(){that.options=opts=optionsToLowerCase(opts);o_fade=opts.transition==='crossfade'||opts.transition==='dissolve';o_loop=opts.loop&&(size>2||o_fade);o_transitionDuration=+opts.transitionduration||TRANSITION_DURATION;o_rtl=opts.direction==='rtl';var classes={add:[],remove:[]};if(size>1){o_nav=opts.nav;o_navTop=opts.navposition==='top';classes.remove.push(selectClass);$arrs.toggle(opts.arrows);}else{o_nav=false;$arrs.hide();}
spinnerStop();spinner=new Spinner($.extend(spinnerDefaults,opts.spinner,spinnerOverride,{direction:o_rtl?-1:1}));arrsUpdate();stageWheelUpdate();if(opts.autoplay)setAutoplayInterval(opts.autoplay);o_thumbSide=numberFromMeasure(opts.thumbwidth)||THUMB_SIZE;o_thumbSide2=numberFromMeasure(opts.thumbheight)||THUMB_SIZE;stageWheelTail.ok=navWheelTail.ok=opts.trackpad&&!SLOW;stageNoMove();extendMeasures(opts,true);o_navThumbs=o_nav==='thumbs';if(o_navThumbs){frameDraw(size,'navThumb');$navFrame=$navThumbFrame;navFrameKey=NAV_THUMB_FRAME_KEY;setStyle($style,$.Fotorama.jst.style({w:o_thumbSide,h:o_thumbSide2,b:opts.thumbborderwidth,m:opts.thumbmargin,s:stamp,q:!COMPAT}));$nav.addClass(navThumbsClass).removeClass(navDotsClass);}else if(o_nav==='dots'){frameDraw(size,'navDot');$navFrame=$navDotFrame;navFrameKey=NAV_DOT_FRAME_KEY;$nav.addClass(navDotsClass).removeClass(navThumbsClass);}else{o_nav=false;$nav.removeClass(navThumbsClass+' '+navDotsClass);}
if(o_nav){if(o_navTop){$navWrap.insertBefore($stage);}else{$navWrap.insertAfter($stage);}
frameAppend.nav=false;frameAppend($navFrame,$navShaft,'nav');}
o_allowFullScreen=opts.allowfullscreen;if(o_allowFullScreen){$fullscreenIcon.appendTo($stage);o_nativeFullScreen=FULLSCREEN&&o_allowFullScreen==='native';}else{$fullscreenIcon.detach();o_nativeFullScreen=false;}
classes[addOrRemove(o_fade)].push(wrapFadeClass);classes[addOrRemove(!o_fade)].push(wrapSlideClass);classes[addOrRemove(o_rtl)].push(wrapRtlClass);o_shadows=opts.shadows&&!SLOW;classes[addOrRemove(!o_shadows)].push(wrapNoShadowsClass);$wrap.addClass(classes.add.join(' ')).removeClass(classes.remove.join(' '));lastOptions=$.extend({},opts);}
function normalizeIndex(index){return index<0?(size+(index%size))%size:index>=size?index%size:index;}
function limitIndex(index){return minMaxLimit(index,0,size-1);}
function edgeIndex(index){return o_loop?normalizeIndex(index):limitIndex(index);}
function getPrevIndex(index){return index>0||o_loop?index-1:false;}
function getNextIndex(index){return index<size-1||o_loop?index+1:false;}
function setStageShaftMinmaxAndSnap(){stageShaftTouchTail.min=o_loop?-Infinity:-getPosByIndex(size-1,measures.w,opts.margin,repositionIndex);stageShaftTouchTail.max=o_loop?Infinity:-getPosByIndex(0,measures.w,opts.margin,repositionIndex);stageShaftTouchTail.snap=measures.w+opts.margin;}
function setNavShaftMinMax(){navShaftTouchTail.min=Math.min(0,measures.nw-$navShaft.width());navShaftTouchTail.max=0;$navShaft.toggleClass(grabClass,!(navShaftTouchTail.noMove=navShaftTouchTail.min===navShaftTouchTail.max));}
function eachIndex(indexes,type,fn){if(typeof indexes==='number'){indexes=new Array(indexes);var rangeFLAG=true;}
return $.each(indexes,function(i,index){if(rangeFLAG)index=i;if(typeof index==='number'){var dataFrame=data[normalizeIndex(index)];if(dataFrame){var key='$'+type+'Frame',$frame=dataFrame[key];fn.call(this,i,index,dataFrame,$frame,key,$frame&&$frame.data());}}});}
function setMeasures(width,height,ratio,index){if(!measuresSetFLAG||(measuresSetFLAG==='*'&&index===startIndex)){width=measureIsValid(opts.width)||measureIsValid(width)||WIDTH;height=measureIsValid(opts.height)||measureIsValid(height)||HEIGHT;that.resize({width:width,ratio:opts.ratio||ratio||width/height},0,index===startIndex?true:'*');}}
function loadImg(indexes,type,specialMeasures,specialFit,again){eachIndex(indexes,type,function(i,index,dataFrame,$frame,key,frameData){if(!$frame)return;var fullFLAG=that.fullScreen&&dataFrame.full&&dataFrame.full!==dataFrame.img&&!frameData.$full&&type==='stage';if(frameData.$img&&!again&&!fullFLAG)return;var img=new Image(),$img=$(img),imgData=$img.data();frameData[fullFLAG?'$full':'$img']=$img;var srcKey=type==='stage'?(fullFLAG?'full':'img'):'thumb',src=dataFrame[srcKey],dummy=fullFLAG?null:dataFrame[type==='stage'?'thumb':'img'];if(type==='navThumb')$frame=frameData.$wrap;function triggerTriggerEvent(event){var _index=normalizeIndex(index);triggerEvent(event,{index:_index,src:src,frame:data[_index]});}
function error(){$img.remove();$.Fotorama.cache[src]='error';if((!dataFrame.html||type!=='stage')&&dummy&&dummy!==src){dataFrame[srcKey]=src=dummy;loadImg([index],type,specialMeasures,specialFit,true);}else{if(src&&!dataFrame.html&&!fullFLAG){$frame.trigger('f:error').removeClass(loadingClass).addClass(errorClass);triggerTriggerEvent('error');}else if(type==='stage'){$frame.trigger('f:load').removeClass(loadingClass+' '+errorClass).addClass(loadedClass);triggerTriggerEvent('load');setMeasures();}
frameData.state='error';if(size>1&&data[index]===dataFrame&&!dataFrame.html&&!dataFrame.deleted&&!dataFrame.video&&!fullFLAG){dataFrame.deleted=true;that.splice(index,1);}}}
function loaded(){$.Fotorama.measures[src]=imgData.measures=$.Fotorama.measures[src]||{width:img.width,height:img.height,ratio:img.width/img.height};setMeasures(imgData.measures.width,imgData.measures.height,imgData.measures.ratio,index);$img.off('load error').addClass(imgClass+(fullFLAG?' '+imgFullClass:'')).prependTo($frame);fit($img,specialMeasures||measures,specialFit||dataFrame.fit||opts.fit);$.Fotorama.cache[src]=frameData.state='loaded';setTimeout(function(){$frame.trigger('f:load').removeClass(loadingClass+' '+errorClass).addClass(loadedClass+' '+(fullFLAG?loadedFullClass:loadedImgClass));if(type==='stage'){triggerTriggerEvent('load');}},5);}
if(!src){error();return;}
function waitAndLoad(){var _i=10;waitFor(function(){return!touchedFLAG||!_i--&&!SLOW;},function(){loaded();});}
if(!$.Fotorama.cache[src]){$.Fotorama.cache[src]='*';$img.on('load',waitAndLoad).on('error',error);}else{(function justWait(){if($.Fotorama.cache[src]==='error'){error();}else if($.Fotorama.cache[src]==='loaded'){setTimeout(waitAndLoad,0);}else{setTimeout(justWait,100);}})();}
frameData.state='';img.src=src;});}
function spinnerSpin($el){$spinner.append(spinner.spin().el).appendTo($el);}
function spinnerStop(){$spinner.detach();spinner&&spinner.stop();}
function updateFotoramaState(){var $frame=that.activeFrame[STAGE_FRAME_KEY];if($frame&&!$frame.data().state){spinnerSpin($frame);$frame.on('f:load f:error',function(){$frame.off('f:load f:error');spinnerStop();});}}
function frameDraw(indexes,type){eachIndex(indexes,type,function(i,index,dataFrame,$frame,key,frameData){if($frame)return;$frame=dataFrame[key]=$wrap[key].clone();frameData=$frame.data();frameData.data=dataFrame;if(type==='stage'){if(dataFrame.html){$('<div class="'+htmlClass+'"></div>').append(dataFrame._html?$(dataFrame.html).removeAttr('id').html(dataFrame._html):dataFrame.html).appendTo($frame);}
if(opts.captions&&dataFrame.caption){$(div(captionClass,div(captionWrapClass,dataFrame.caption))).appendTo($frame);}
dataFrame.video&&$frame.addClass(stageFrameVideoClass).append($videoPlay.clone());$stageFrame=$stageFrame.add($frame);}else if(type==='navDot'){$navDotFrame=$navDotFrame.add($frame);}else if(type==='navThumb'){frameData.$wrap=$frame.children(':first');$navThumbFrame=$navThumbFrame.add($frame);if(dataFrame.video){$frame.append($videoPlay.clone());}}});}
function callFit($img,measuresToFit,method){return $img&&$img.length&&fit($img,measuresToFit,method);}
function stageFramePosition(indexes){eachIndex(indexes,'stage',function(i,index,dataFrame,$frame,key,frameData){if(!$frame)return;toDetach[STAGE_FRAME_KEY][normalizeIndex(index)]=$frame.css($.extend({left:o_fade?0:getPosByIndex(index,measures.w,opts.margin,repositionIndex)},o_fade&&getDuration(0)));if(isDetached($frame[0])){$frame.appendTo($stageShaft);unloadVideo(dataFrame.$video);}
var method=dataFrame.fit||opts.fit;callFit(frameData.$img,measures,method);callFit(frameData.$full,measures,method);});}
function thumbsDraw(pos,loadFLAG){if(o_nav!=='thumbs'||isNaN(pos))return;var leftLimit=-pos,rightLimit=-pos+measures.nw;$navThumbFrame.each(function(){var $this=$(this),thisData=$this.data(),eq=thisData.eq,specialMeasures={h:o_thumbSide2},specialFit='cover';specialMeasures.w=thisData.w;if(thisData.l+thisData.w<leftLimit||thisData.l>rightLimit||callFit(thisData.$img,specialMeasures,specialFit))return;loadFLAG&&loadImg([eq],'navThumb',specialMeasures,specialFit);});}
function frameAppend($frames,$shaft,type){if(!frameAppend[type]){var thumbsFLAG=type==='nav'&&o_navThumbs,left=0;$shaft.append($frames.filter(function(){var actual,$this=$(this),frameData=$this.data();for(var _i=0,_l=data.length;_i<_l;_i++){if(frameData.data===data[_i]){actual=true;frameData.eq=_i;break;}}
return actual||$this.remove()&&false;}).sort(function(a,b){return $(a).data().eq-$(b).data().eq;}).each(function(){if(!thumbsFLAG)return;var $this=$(this),frameData=$this.data(),thumbwidth=Math.round(o_thumbSide2*frameData.data.thumbratio)||o_thumbSide;frameData.l=left;frameData.w=thumbwidth;$this.css({width:thumbwidth});left+=thumbwidth+opts.thumbmargin;}));frameAppend[type]=true;}}
function getDirection(x){return x-stageLeft>measures.w/3;}
function disableDirrection(i){return!o_loop&&(!(activeIndex+i)||!(activeIndex-size+i))&&!$videoPlaying;}
function arrsUpdate(){$arrPrev.toggleClass(arrDisabledClass,disableDirrection(0));$arrNext.toggleClass(arrDisabledClass,disableDirrection(1));}
function stageWheelUpdate(){if(stageWheelTail.ok){stageWheelTail.prevent={'<':disableDirrection(0),'>':disableDirrection(1)};}}
function getNavFrameBounds($navFrame){var navFrameData=$navFrame.data(),left,width;if(o_navThumbs){left=navFrameData.l;width=navFrameData.w;}else{left=$navFrame.position().left;width=$navFrame.width();}
return{c:left+width/2,min:-left+opts.thumbmargin*10,max:-left+measures.w-width-opts.thumbmargin*10};}
function slideThumbBorder(time){var navFrameData=that.activeFrame[navFrameKey].data();slide($thumbBorder,{time:time*.9,pos:navFrameData.l,width:navFrameData.w-opts.thumbborderwidth*2});}
function slideNavShaft(options){var $guessNavFrame=data[options.guessIndex][navFrameKey];if($guessNavFrame){var overflowFLAG=navShaftTouchTail.min!==navShaftTouchTail.max,activeNavFrameBounds=overflowFLAG&&getNavFrameBounds(that.activeFrame[navFrameKey]),l=overflowFLAG&&(options.keep&&slideNavShaft.l?slideNavShaft.l:minMaxLimit((options.coo||measures.nw/2)-getNavFrameBounds($guessNavFrame).c,activeNavFrameBounds.min,activeNavFrameBounds.max)),pos=overflowFLAG&&minMaxLimit(l,navShaftTouchTail.min,navShaftTouchTail.max),time=options.time*.9;slide($navShaft,{time:time,pos:pos||0,onEnd:function(){thumbsDraw(pos,true);}});setShadow($nav,findShadowEdge(pos,navShaftTouchTail.min,navShaftTouchTail.max));slideNavShaft.l=l;}}
function navUpdate(){deactivateFrames(navFrameKey);toDeactivate[navFrameKey].push(that.activeFrame[navFrameKey].addClass(activeClass));}
function deactivateFrames(key){var _toDeactivate=toDeactivate[key];while(_toDeactivate.length){_toDeactivate.shift().removeClass(activeClass);}}
function detachFrames(key){var _toDetach=toDetach[key];$.each(activeIndexes,function(i,index){delete _toDetach[normalizeIndex(index)];});$.each(_toDetach,function(index,$frame){delete _toDetach[index];$frame.detach();});}
function stageShaftReposition(skipOnEnd){repositionIndex=dirtyIndex=activeIndex;var dataFrame=that.activeFrame,$frame=dataFrame[STAGE_FRAME_KEY];if($frame){deactivateFrames(STAGE_FRAME_KEY);toDeactivate[STAGE_FRAME_KEY].push($frame.addClass(activeClass));skipOnEnd||that.show.onEnd(true);stop($stageShaft,0,true);detachFrames(STAGE_FRAME_KEY);stageFramePosition(activeIndexes);setStageShaftMinmaxAndSnap();setNavShaftMinMax();}}
function extendMeasures(options,optsLeave){options&&$.extend(measures,{width:options.width||measures.width,height:options.height,minwidth:options.minwidth,maxwidth:options.maxwidth,minheight:options.minheight,maxheight:options.maxheight,ratio:getRatio(options.ratio)})&&!optsLeave&&$.extend(opts,{width:measures.width,height:measures.height,minwidth:measures.minwidth,maxwidth:measures.maxwidth,minheight:measures.minheight,maxheight:measures.maxheight,ratio:measures.ratio});}
function triggerEvent(event,extra){$fotorama.trigger(_fotoramaClass+':'+event,[that,extra]);}
function onTouchStart(){clearTimeout(onTouchEnd.t);touchedFLAG=1;if(opts.stopautoplayontouch){that.stopAutoplay();}else{pausedAutoplayFLAG=true;}}
function onTouchEnd(){if(!opts.stopautoplayontouch){releaseAutoplay();changeAutoplay();}
onTouchEnd.t=setTimeout(function(){touchedFLAG=0;},TRANSITION_DURATION+TOUCH_TIMEOUT);}
function releaseAutoplay(){pausedAutoplayFLAG=!!($videoPlaying||stoppedAutoplayFLAG);}
function changeAutoplay(){clearTimeout(changeAutoplay.t);if(!opts.autoplay||pausedAutoplayFLAG){if(that.autoplay){that.autoplay=false;triggerEvent('stopautoplay');}
return;}
if(!that.autoplay){that.autoplay=true;triggerEvent('startautoplay');}
var _activeIndex=activeIndex;var frameData=that.activeFrame[STAGE_FRAME_KEY].data();waitFor(function(){return frameData.state||_activeIndex!==activeIndex;},function(){changeAutoplay.t=setTimeout(function(){if(pausedAutoplayFLAG||_activeIndex!==activeIndex)return;that.show(o_loop?getDirectionSign(!o_rtl):normalizeIndex(activeIndex+(o_rtl?-1:1)));},opts.autoplay);});}
that.startAutoplay=function(interval){if(that.autoplay)return this;pausedAutoplayFLAG=stoppedAutoplayFLAG=false;setAutoplayInterval(interval||opts.autoplay);changeAutoplay();return this;};that.stopAutoplay=function(){if(that.autoplay){pausedAutoplayFLAG=stoppedAutoplayFLAG=true;changeAutoplay();}
return this;};that.show=function(options){var index;if(typeof options!=='object'){index=options;options={};}else{index=options.index;}
index=index==='>'?dirtyIndex+1:index==='<'?dirtyIndex-1:index==='<<'?0:index==='>>'?size-1:index;index=isNaN(index)?getIndexFromHash(index,data,true):index;index=typeof index==='undefined'?activeIndex||0:index;that.activeIndex=activeIndex=edgeIndex(index);prevIndex=getPrevIndex(activeIndex);nextIndex=getNextIndex(activeIndex);activeIndexes=[activeIndex,prevIndex,nextIndex];dirtyIndex=o_loop?index:activeIndex;var diffIndex=Math.abs(lastActiveIndex-dirtyIndex),time=getNumber(options.time,function(){return Math.min(o_transitionDuration*(1+(diffIndex-1)/12),o_transitionDuration*2);}),overPos=options.overPos;if(options.slow)time*=10;that.activeFrame=activeFrame=data[activeIndex];unloadVideo($videoPlaying,activeFrame.i!==data[normalizeIndex(repositionIndex)].i);frameDraw(activeIndexes,'stage');stageFramePosition(SLOW?[dirtyIndex]:[dirtyIndex,getPrevIndex(dirtyIndex),getNextIndex(dirtyIndex)]);updateTouchTails('go',true);options.reset||triggerEvent('show',{user:options.user,time:time});pausedAutoplayFLAG=true;var onEnd=that.show.onEnd=function(skipReposition){if(onEnd.ok)return;onEnd.ok=true;skipReposition||stageShaftReposition(true);if(!options.reset){triggerEvent('showend',{user:options.user});if(!skipReposition&&o_transition&&o_transition!==opts.transition){that.setOptions({transition:o_transition});o_transition=false;return;}}
updateFotoramaState();loadImg(activeIndexes,'stage');updateTouchTails('go',false);stageWheelUpdate();stageCursor();releaseAutoplay();changeAutoplay();};if(!o_fade){slide($stageShaft,{pos:-getPosByIndex(dirtyIndex,measures.w,opts.margin,repositionIndex),overPos:overPos,time:time,onEnd:onEnd,_001:true});}else{var $activeFrame=activeFrame[STAGE_FRAME_KEY],$prevActiveFrame=activeIndex!==lastActiveIndex?data[lastActiveIndex][STAGE_FRAME_KEY]:null;fade($activeFrame,$prevActiveFrame,$stageFrame,{time:time,method:opts.transition,onEnd:onEnd},fadeStack);}
arrsUpdate();if(o_nav){navUpdate();var guessIndex=limitIndex(activeIndex+minMaxLimit(dirtyIndex-lastActiveIndex,-1,1));slideNavShaft({time:time,coo:guessIndex!==activeIndex&&options.coo,guessIndex:typeof options.coo!=='undefined'?guessIndex:activeIndex,keep:options.reset});if(o_navThumbs)slideThumbBorder(time);}
showedFLAG=typeof lastActiveIndex!=='undefined'&&lastActiveIndex!==activeIndex;lastActiveIndex=activeIndex;opts.hash&&showedFLAG&&!that.eq&&setHash(activeFrame.id||activeIndex+1);return this;};that.requestFullScreen=function(){if(o_allowFullScreen&&!that.fullScreen){scrollTop=$WINDOW.scrollTop();scrollLeft=$WINDOW.scrollLeft();lockScroll(0,0);updateTouchTails('x',true);measuresStash=$.extend({},measures);$fotorama.addClass(fullscreenClass).appendTo($BODY.addClass(_fullscreenClass));$HTML.addClass(_fullscreenClass);unloadVideo($videoPlaying,true,true);that.fullScreen=true;if(o_nativeFullScreen){fullScreenApi.request(fotorama);}
that.resize();loadImg(activeIndexes,'stage');updateFotoramaState();triggerEvent('fullscreenenter');}
return this;};function cancelFullScreen(){if(that.fullScreen){that.fullScreen=false;if(FULLSCREEN){fullScreenApi.cancel(fotorama);}
$BODY.removeClass(_fullscreenClass);$HTML.removeClass(_fullscreenClass);$fotorama.removeClass(fullscreenClass).insertAfter($anchor);measures=$.extend({},measuresStash);unloadVideo($videoPlaying,true,true);updateTouchTails('x',false);that.resize();loadImg(activeIndexes,'stage');lockScroll(scrollLeft,scrollTop);triggerEvent('fullscreenexit');}}
that.cancelFullScreen=function(){if(o_nativeFullScreen&&fullScreenApi.is()){fullScreenApi.cancel(document);}else{cancelFullScreen();}
return this;};if(document.addEventListener){document.addEventListener(fullScreenApi.event,function(){if(data&&!fullScreenApi.is()&&!$videoPlaying){cancelFullScreen();}},false);}
that.resize=function(options){if(!data)return this;extendMeasures(!that.fullScreen?optionsToLowerCase(options):{width:'100%',maxwidth:null,minwidth:null,height:'100%',maxheight:null,minheight:null},that.fullScreen);var time=arguments[1]||0,setFLAG=arguments[2],width=measures.width,height=measures.height,ratio=measures.ratio,windowHeight=$WINDOW.height()-(o_nav?$nav.height():0);if(measureIsValid(width)){$wrap.addClass(wrapOnlyActiveClass).css({width:width,minWidth:measures.minwidth,maxWidth:measures.maxwidth});width=measures.W=measures.w=$wrap.width();measures.nw=o_nav&&numberFromWhatever(opts.navwidth,width)||width;if(opts.glimpse){measures.w-=Math.round((numberFromWhatever(opts.glimpse,width)||0)*2);}
$stageShaft.css({width:measures.w,marginLeft:(measures.W-measures.w)/2});height=numberFromWhatever(height,windowHeight);height=height||(ratio&&width/ratio);if(height){width=Math.round(width);height=measures.h=Math.round(minMaxLimit(height,numberFromWhatever(measures.minheight,windowHeight),numberFromWhatever(measures.maxheight,windowHeight)));$stage.stop().animate({width:width,height:height},time,function(){$wrap.removeClass(wrapOnlyActiveClass);});stageShaftReposition();if(o_nav){$nav.stop().animate({width:measures.nw},time);slideNavShaft({guessIndex:activeIndex,time:time,keep:true});if(o_navThumbs&&frameAppend.nav)slideThumbBorder(time);}
measuresSetFLAG=setFLAG||true;ready();}}
stageLeft=$stage.offset().left;return this;};that.setOptions=function(options){$.extend(opts,options);reset();return this;};that.shuffle=function(){data&&shuffle(data)&&reset();return this;};function setShadow($el,edge){if(o_shadows){$el.removeClass(shadowsLeftClass+' '+shadowsRightClass);edge&&!$videoPlaying&&$el.addClass(edge.replace(/^|\s/g,' '+shadowsClass+'--'));}}
that.destroy=function(){that.cancelFullScreen();that.stopAutoplay();data=that.data=null;appendElements();activeIndexes=[];detachFrames(STAGE_FRAME_KEY);return this;};that.playVideo=function(){var dataFrame=that.activeFrame,video=dataFrame.video,_activeIndex=activeIndex;if(typeof video==='object'&&dataFrame.videoReady){o_nativeFullScreen&&that.fullScreen&&that.cancelFullScreen();waitFor(function(){return!fullScreenApi.is()||_activeIndex!==activeIndex;},function(){if(_activeIndex===activeIndex){dataFrame.$video=dataFrame.$video||$($.Fotorama.jst.video(video));dataFrame.$video.appendTo(dataFrame[STAGE_FRAME_KEY]);$wrap.addClass(wrapVideoClass);$videoPlaying=dataFrame.$video;stageNoMove();triggerEvent('loadvideo');}});}
return this;};that.stopVideo=function(){unloadVideo($videoPlaying,true,true);return this;};function unloadVideo($video,unloadActiveFLAG,releaseAutoplayFLAG){if(unloadActiveFLAG){$wrap.removeClass(wrapVideoClass);$videoPlaying=false;stageNoMove();}
if($video&&$video!==$videoPlaying){$video.remove();triggerEvent('unloadvideo');}
if(releaseAutoplayFLAG){releaseAutoplay();changeAutoplay();}}
function toggleControlsClass(FLAG){$wrap.toggleClass(wrapNoControlsClass,FLAG);}
function stageCursor(e){if(stageShaftTouchTail.flow)return;var x=e?e.pageX:stageCursor.x,pointerFLAG=x&&!disableDirrection(getDirection(x))&&opts.click;if(stageCursor.p!==pointerFLAG&&(o_fade||!opts.swipe)&&$stage.toggleClass(pointerClass,pointerFLAG)){stageCursor.p=pointerFLAG;stageCursor.x=x;}}
$stage.on('mousemove',stageCursor);function clickToShow(showOptions){clearTimeout(clickToShow.t);if(opts.clicktransition&&opts.clicktransition!==opts.transition){o_transition=opts.transition;that.setOptions({transition:opts.clicktransition});clickToShow.t=setTimeout(function(){that.show(showOptions);},10);}else{that.show(showOptions);}}
function onStageTap(e,toggleControlsFLAG){var target=e.target,$target=$(target);if($target.hasClass(videoPlayClass)){that.playVideo();}else if(target===fullscreenIcon){that[(that.fullScreen?'cancel':'request')+'FullScreen']();}else if($videoPlaying){target===videoClose&&unloadVideo($videoPlaying,true,true);}else{if(toggleControlsFLAG){toggleControlsClass();}else if(opts.click){clickToShow({index:e.shiftKey||getDirectionSign(getDirection(e._x)),slow:e.altKey,user:true});}}}
function updateTouchTails(key,value){stageShaftTouchTail[key]=navShaftTouchTail[key]=value;}
stageShaftTouchTail=moveOnTouch($stageShaft,{onStart:onTouchStart,onMove:function(e,result){setShadow($stage,result.edge);},onTouchEnd:onTouchEnd,onEnd:function(result){setShadow($stage);var toggleControlsFLAG=(MS_POINTER&&!hoverFLAG||result.touch)&&opts.arrows;if(result.moved||(toggleControlsFLAG&&result.pos!==result.newPos&&!result.control)){var index=getIndexByPos(result.newPos,measures.w,opts.margin,repositionIndex);that.show({index:index,time:o_fade?o_transitionDuration:result.time,overPos:result.overPos,user:true});}else if(!result.aborted&&!result.control){onStageTap(result.startEvent,toggleControlsFLAG);}},_001:true,timeLow:1,timeHigh:1,friction:2,select:'.'+selectClass+', .'+selectClass+' *',$wrap:$stage});navShaftTouchTail=moveOnTouch($navShaft,{onStart:onTouchStart,onMove:function(e,result){setShadow($nav,result.edge);},onTouchEnd:onTouchEnd,onEnd:function(result){function onEnd(){slideNavShaft.l=result.newPos;releaseAutoplay();changeAutoplay();thumbsDraw(result.newPos,true);}
if(!result.moved){var target=result.$target.closest('.'+navFrameClass,$navShaft)[0];target&&onNavFrameClick.call(target,result.startEvent);}else if(result.pos!==result.newPos){pausedAutoplayFLAG=true;slide($navShaft,{time:result.time,pos:result.newPos,overPos:result.overPos,onEnd:onEnd});thumbsDraw(result.newPos);o_shadows&&setShadow($nav,findShadowEdge(result.newPos,navShaftTouchTail.min,navShaftTouchTail.max));}else{onEnd();}},timeLow:.5,timeHigh:2,friction:5,$wrap:$nav});stageWheelTail=wheel($stage,{shift:true,onEnd:function(e,direction){onTouchStart();onTouchEnd();that.show({index:direction,slow:e.altKey})}});navWheelTail=wheel($nav,{onEnd:function(e,direction){onTouchStart();onTouchEnd();var newPos=stop($navShaft)+direction*.25;$navShaft.css(getTranslate(minMaxLimit(newPos,navShaftTouchTail.min,navShaftTouchTail.max)));o_shadows&&setShadow($nav,findShadowEdge(newPos,navShaftTouchTail.min,navShaftTouchTail.max));navWheelTail.prevent={'<':newPos>=navShaftTouchTail.max,'>':newPos<=navShaftTouchTail.min};clearTimeout(navWheelTail.t);navWheelTail.t=setTimeout(function(){thumbsDraw(newPos,true)},TOUCH_TIMEOUT);thumbsDraw(newPos);}});$wrap.hover(function(){setTimeout(function(){if(touchedFLAG)return;hoverFLAG=true;toggleControlsClass(!hoverFLAG);},0);},function(){if(!hoverFLAG)return;hoverFLAG=false;toggleControlsClass(!hoverFLAG);});function onNavFrameClick(e,time){var index=$(this).data().eq;clickToShow({index:index,slow:e.altKey,user:true,coo:e._x-$nav.offset().left,time:time});}
smartClick($arrs,function(e){stopEvent(e);clickToShow({index:$arrs.index(this)?'>':'<',slow:e.altKey,user:true});},{onStart:function(){onTouchStart();stageShaftTouchTail.control=true;},onTouchEnd:onTouchEnd});function reset(){setData();setOptions();if(!reset.i){reset.i=true;var _startindex=opts.startindex;if(_startindex||opts.hash&&location.hash){startIndex=getIndexFromHash(_startindex||location.hash.replace(/^#/,''),data,that.index===0||_startindex,_startindex);}
activeIndex=repositionIndex=dirtyIndex=lastActiveIndex=startIndex=edgeIndex(startIndex)||0;;}
if(size){if(changeToRtl())return;if($videoPlaying){unloadVideo($videoPlaying,true);}
activeIndexes=[];detachFrames(STAGE_FRAME_KEY);that.show({index:activeIndex,time:0,reset:reset.ok});that.resize();}else{that.destroy();}
reset.ok=true;}
function changeToRtl(){if(!changeToRtl.f===o_rtl){changeToRtl.f=o_rtl;activeIndex=size-1-activeIndex;that.reverse();return true;}}
$.each('load push pop shift unshift reverse sort splice'.split(' '),function(i,method){that[method]=function(){data=data||[];if(method!=='load'){Array.prototype[method].apply(data,arguments);}else if(arguments[0]&&typeof arguments[0]==='object'&&arguments[0].length){data=clone(arguments[0]);}
reset();return that;}});function ready(){if(!ready.ok){ready.ok=true;triggerEvent('ready');}}
reset();};$.fn.fotorama=function(opts){return this.each(function(){var that=this,$fotorama=$(this),fotoramaData=$fotorama.data(),fotorama=fotoramaData.fotorama;if(!fotorama){waitFor(function(){return!isHidden(that);},function(){fotoramaData.urtext=$fotorama.html();new $.Fotorama($fotorama,$.extend({},{width:'100%',minwidth:null,maxwidth:'100%',height:null,minheight:null,maxheight:null,ratio:null,margin:MARGIN,glimpse:0,nav:'thumbs',navposition:'bottom',navwidth:null,thumbwidth:95,thumbheight:65,thumbmargin:MARGIN,thumbborderwidth:MARGIN,allowfullscreen:false,fit:'cover',transition:'slide',clicktransition:null,transitionduration:TRANSITION_DURATION,captions:true,hash:false,startindex:0,loop:true,autoplay:false,stopautoplayontouch:true,keyboard:false,arrows:false,click:false,swipe:true,trackpad:true,shuffle:false,direction:'ltr',shadows:true,spinner:null},window.fotoramaDefaults,opts,fotoramaData));});}else{fotorama.setOptions(opts);}});};$.Fotorama.instances=[];function calculateIndexes(){$.each($.Fotorama.instances,function(index,instance){instance.index=index;});}
function addInstance(instance){$.Fotorama.instances.push(instance);calculateIndexes();}
function hideInstance(instance){$.Fotorama.instances.splice(instance.index,1);calculateIndexes();}
$.Fotorama.cache={};$.Fotorama.measures={};$=$||{};$.Fotorama=$.Fotorama||{};$.Fotorama.jst=$.Fotorama.jst||{};$.Fotorama.jst.style=function(v){var __t,__p='',__e=_.escape;__p+='.fotorama'+
((__t=(v.s))==null?'':__t)+' .fotorama__nav--thumbs .fotorama__nav__frame{\npadding:'+
((__t=(v.m))==null?'':__t)+'px;\nheight:'+
((__t=(v.h))==null?'':__t)+'px}\n.fotorama'+
((__t=(v.s))==null?'':__t)+' .fotorama__thumb-border{\nheight:'+
((__t=(v.h-v.b*(v.q?0:2)))==null?'':__t)+'px;\nborder-width:'+
((__t=(v.b))==null?'':__t)+'px;\nmargin-top:'+
((__t=(v.m))==null?'':__t)+'px}';return __p};$.Fotorama.jst.video=function(v){var __t,__p='',__e=_.escape,__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}
__p+='<div class="fotorama__video"><iframe src="';print((v.type=='youtube'?'http://youtube.com/embed/'+v.id+'?autoplay=1':v.type=='vimeo'?'http://player.vimeo.com/video/'+v.id+'?autoplay=1&badge=0':v.id)+(v.s&&v.type!='custom'?'&'+v.s:''));__p+='" frameborder="0" allowfullscreen></iframe></div>';return __p};$(function(){$('.'+_fotoramaClass+':not([data-auto="false"])').fotorama();});})(window,document,location,typeof jQuery!=='undefined'&&jQuery);;(function($){$.extend({metadata:{defaults:{type:'class',name:'metadata',cre:/({.*})/,single:'metadata'},setType:function(type,name){this.defaults.type=type;this.defaults.name=name;},get:function(elem,opts){var settings=$.extend({},this.defaults,opts);if(!settings.single.length)settings.single='metadata';var data=$.data(elem,settings.single);if(data)return data;data="{}";if(settings.type=="class"){var m=settings.cre.exec(elem.className);if(m)
data=m[1];}else if(settings.type=="elem"){if(!elem.getElementsByTagName)
return undefined;var e=elem.getElementsByTagName(settings.name);if(e.length)
data=$.trim(e[0].innerHTML);}else if(elem.getAttribute!=undefined){var attr=elem.getAttribute(settings.name);if(attr)
data=attr;}
if(data.indexOf('{')<0)
data="{"+data+"}";data=eval("("+data+")");$.data(elem,settings.single,data);return data;}}});$.fn.metadata=function(opts){return $.metadata.get(this[0],opts);};})(jQuery);;
/*!
 * jQuery Form Plugin
 * version: 2.49 (18-OCT-2010)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
;(function($){$.fn.ajaxSubmit=function(options){if(!this.length){log('ajaxSubmit: skipping submit process - no element selected');return this;}
if(typeof options=='function'){options={success:options};}
var url=$.trim(this.attr('action'));if(url){url=(url.match(/^([^#]+)/)||[])[1];}
url=url||window.location.href||'';options=$.extend(true,{url:url,type:this.attr('method')||'GET',iframeSrc:/^https/i.test(window.location.href||'')?'javascript:false':'about:blank'},options);var veto={};this.trigger('form-pre-serialize',[this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');return this;}
if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log('ajaxSubmit: submit aborted via beforeSerialize callback');return this;}
var n,v,a=this.formToArray(options.semantic);if(options.data){options.extraData=options.data;for(n in options.data){if(options.data[n]instanceof Array){for(var k in options.data[n]){a.push({name:n,value:options.data[n][k]});}}
else{v=options.data[n];v=$.isFunction(v)?v():v;a.push({name:n,value:v});}}}
if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log('ajaxSubmit: submit aborted via beforeSubmit callback');return this;}
this.trigger('form-submit-validate',[a,this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-submit-validate trigger');return this;}
var q=$.param(a);if(options.type.toUpperCase()=='GET'){options.url+=(options.url.indexOf('?')>=0?'&':'?')+q;options.data=null;}
else{options.data=q;}
var $form=this,callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm();});}
if(options.clearForm){callbacks.push(function(){$form.clearForm();});}
if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?'replaceWith':'html';$(options.target)[fn](data).each(oldSuccess,arguments);});}
else if(options.success){callbacks.push(options.success);}
options.success=function(data,status,xhr){var context=options.context||options;for(var i=0,max=callbacks.length;i<max;i++){callbacks[i].apply(context,[data,status,xhr||$form,$form]);}};var fileInputs=$('input:file',this).length>0;var mp='multipart/form-data';var multipart=($form.attr('enctype')==mp||$form.attr('encoding')==mp);if(options.iframe!==false&&(fileInputs||options.iframe||multipart)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,fileUpload);}
else{fileUpload();}}
else{$.ajax(options);}
this.trigger('form-submit-notify',[this,options]);return this;function fileUpload(){var form=$form[0];if($(':input[name=submit],:input[id=submit]',form).length){alert('Error: Form elements must not have name or id of "submit".');return;}
var s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;var id='jqFormIO'+(new Date().getTime()),fn='_'+id;window[fn]=function(){var f=$io.data('form-plugin-onload');if(f){f();window[fn]=undefined;try{delete window[fn];}catch(e){}}}
var $io=$('<iframe id="'+id+'" name="'+id+'" src="'+s.iframeSrc+'" onload="window[\'_\'+this.id]()" />');var io=$io[0];$io.css({position:'absolute',top:'-1000px',left:'-1000px'});var xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:'n/a',getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;$io.attr('src',s.iframeSrc);}};var g=s.global;if(g&&!$.active++){$.event.trigger("ajaxStart");}
if(g){$.event.trigger("ajaxSend",[xhr,s]);}
if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active--;}
return;}
if(xhr.aborted){return;}
var cbInvoked=false;var timedOut=0;var sub=form.clk;if(sub){var n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+'.x']=form.clk_x;s.extraData[n+'.y']=form.clk_y;}}}
function doSubmit(){var t=$form.attr('target'),a=$form.attr('action');form.setAttribute('target',id);if(form.getAttribute('method')!='POST'){form.setAttribute('method','POST');}
if(form.getAttribute('action')!=s.url){form.setAttribute('action',s.url);}
if(!s.skipEncodingOverride){$form.attr({encoding:'multipart/form-data',enctype:'multipart/form-data'});}
if(s.timeout){setTimeout(function(){timedOut=true;cb();},s.timeout);}
var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){extraInputs.push($('<input type="hidden" name="'+n+'" value="'+s.extraData[n]+'" />').appendTo(form)[0]);}}
$io.appendTo('body');$io.data('form-plugin-onload',cb);form.submit();}
finally{form.setAttribute('action',a);if(t){form.setAttribute('target',t);}else{$form.removeAttr('target');}
$(extraInputs).remove();}}
if(s.forceSync){doSubmit();}
else{setTimeout(doSubmit,10);}
var data,doc,domCheckCount=50;function cb(){if(cbInvoked){return;}
$io.removeData('form-plugin-onload');var ok=true;try{if(timedOut){throw'timeout';}
doc=io.contentWindow?io.contentWindow.document:io.contentDocument?io.contentDocument:io.document;var isXml=s.dataType=='xml'||doc.XMLDocument||$.isXMLDoc(doc);log('isXml='+isXml);if(!isXml&&window.opera&&(doc.body==null||doc.body.innerHTML=='')){if(--domCheckCount){log('requeing onLoad callback, DOM not available');setTimeout(cb,250);return;}}
cbInvoked=true;xhr.responseText=doc.documentElement?doc.documentElement.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;xhr.getResponseHeader=function(header){var headers={'content-type':s.dataType};return headers[header];};var scr=/(json|script)/.test(s.dataType);if(scr||s.textarea){var ta=doc.getElementsByTagName('textarea')[0];if(ta){xhr.responseText=ta.value;}
else if(scr){var pre=doc.getElementsByTagName('pre')[0];var b=doc.getElementsByTagName('body')[0];if(pre){xhr.responseText=pre.innerHTML;}
else if(b){xhr.responseText=b.innerHTML;}}}
else if(s.dataType=='xml'&&!xhr.responseXML&&xhr.responseText!=null){xhr.responseXML=toXml(xhr.responseText);}
data=$.httpData(xhr,s.dataType);}
catch(e){log('error caught:',e);ok=false;xhr.error=e;$.handleError(s,xhr,'error',e);}
if(ok){s.success.call(s.context,data,'success',xhr);if(g){$.event.trigger("ajaxSuccess",[xhr,s]);}}
if(g){$.event.trigger("ajaxComplete",[xhr,s]);}
if(g&&!--$.active){$.event.trigger("ajaxStop");}
if(s.complete){s.complete.call(s.context,xhr,ok?'success':'error');}
setTimeout(function(){$io.removeData('form-plugin-onload');$io.remove();xhr.responseXML=null;},100);}
function toXml(s,doc){if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(s);}
else{doc=(new DOMParser()).parseFromString(s,'text/xml');}
return(doc&&doc.documentElement&&doc.documentElement.tagName!='parsererror')?doc:null;}}};$.fn.ajaxForm=function(options){if(this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log('DOM not ready, queuing ajaxForm');$(function(){$(o.s,o.c).ajaxForm(options);});return this;}
log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this;}
return this.ajaxFormUnbind().bind('submit.form-plugin',function(e){if(!e.isDefaultPrevented()){e.preventDefault();$(this).ajaxSubmit(options);}}).bind('click.form-plugin',function(e){var target=e.target;var $el=$(target);if(!($el.is(":submit,input:image"))){var t=$el.closest(':submit');if(t.length==0){return;}
target=t[0];}
var form=this;form.clk=target;if(target.type=='image'){if(e.offsetX!=undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY;}else if(typeof $.fn.offset=='function'){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top;}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop;}}
setTimeout(function(){form.clk=form.clk_x=form.clk_y=null;},100);});};$.fn.ajaxFormUnbind=function(){return this.unbind('submit.form-plugin click.form-plugin');};$.fn.formToArray=function(semantic){var a=[];if(this.length===0){return a;}
var form=this[0];var els=semantic?form.getElementsByTagName('*'):form.elements;if(!els){return a;}
var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n){continue;}
if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}
continue;}
v=$.fieldValue(el,true);if(v&&v.constructor==Array){for(j=0,jmax=v.length;j<jmax;j++){a.push({name:n,value:v[j]});}}
else if(v!==null&&typeof v!='undefined'){a.push({name:n,value:v});}}
if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=='image'){a.push({name:n,value:$input.val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}}
return a;};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic));};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return;}
var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i++){a.push({name:n,value:v[i]});}}
else if(v!==null&&typeof v!='undefined'){a.push({name:this.name,value:v});}});return $.param(a);};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=='undefined'||(v.constructor==Array&&!v.length)){continue;}
v.constructor==Array?$.merge(val,v):val.push(v);}
return val;};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true;}
if(successful&&(!n||el.disabled||t=='reset'||t=='button'||(t=='checkbox'||t=='radio')&&!el.checked||(t=='submit'||t=='image')&&el.form&&el.form.clk!=el||tag=='select'&&el.selectedIndex==-1)){return null;}
if(tag=='select'){var index=el.selectedIndex;if(index<0){return null;}
var a=[],ops=el.options;var one=(t=='select-one');var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes['value']&&!(op.attributes['value'].specified))?op.text:op.value;}
if(one){return v;}
a.push(v);}}
return a;}
return $(el).val();};$.fn.clearForm=function(){return this.each(function(){$('input,select,textarea',this).clearFields();});};$.fn.clearFields=$.fn.clearInputs=function(){return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(t=='text'||t=='password'||tag=='textarea'){this.value='';}
else if(t=='checkbox'||t=='radio'){this.checked=false;}
else if(tag=='select'){this.selectedIndex=-1;}});};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=='function'||(typeof this.reset=='object'&&!this.reset.nodeType)){this.reset();}});};$.fn.enable=function(b){if(b===undefined){b=true;}
return this.each(function(){this.disabled=!b;});};$.fn.selected=function(select){if(select===undefined){select=true;}
return this.each(function(){var t=this.type;if(t=='checkbox'||t=='radio'){this.checked=select;}
else if(this.tagName.toLowerCase()=='option'){var $sel=$(this).parent('select');if(select&&$sel[0]&&$sel[0].type=='select-one'){$sel.find('option').selected(false);}
this.selected=select;}});};function log(){if($.fn.ajaxSubmit.debug){var msg='[jquery.form] '+Array.prototype.join.call(arguments,'');if(window.console&&window.console.log){window.console.log(msg);}
else if(window.opera&&window.opera.postError){window.opera.postError(msg);}}};})(jQuery);
;/**
 * jQuery Unveil
 * A very lightweight jQuery plugin to lazy load images
 * http://luis-almeida.github.com/unveil
 *
 * Licensed under the MIT license.
 * Copyright 2013 Luís Almeida
 * https://github.com/luis-almeida
 */

;(function($){$.fn.unveil=function(threshold,callback){var $w=$(window),th=threshold||0,retina=window.devicePixelRatio>1,attrib=retina?"data-src-retina":"data-src",images=this,loaded;this.one("unveil",function(){var source=this.getAttribute(attrib);source=source||this.getAttribute("data-src");if(source){this.setAttribute("src",source);if(typeof callback==="function")callback.call(this);}});function unveil(){var inview=images.filter(function(){var $e=$(this),wt=$w.scrollTop(),wb=wt+$w.height(),et=$e.offset().top,eb=et+$e.height();return eb>=wt-th&&et<=wb+th;});loaded=inview.trigger("unveil");images=images.not(loaded);}$w.scroll(unveil);$w.resize(unveil);unveil();return this;};})(window.jQuery||window.Zepto);
;function showPhone(str,type,element,baseUrl,target){if(target===void 0){target=false;}
$.ajax({url:baseUrl+"requests/showPhone",dataType:"json",type:"post",data:{id:str,type:type,spformat:true},success:function(response){if(response.responseStatus)
{if(type=="property")
{if($("#fb_pixel_flag").text()=="1"){fbq('track','ViewContent',{value:1,currency:"EUR",content_category:"Listing",content_name:toGreeklish($("#fb_pixel_geo").text()),content_ids:toGreeklish(decodeURIComponent(window.location.href))});}
if(element=="button")
{$("#agentPhone").html(response.data);$("#propertyListingButton").hide();$("#agentPhone").fadeIn("slow");sgTrackGa({event:'event',category:'Listing_action',action:'show_phone_main_bullets'});}
else if(element=="link")
{$("#realtorInfoLinks .displayNone").html(response.data);$("#realtorInfoLinks .iconPhone").hide();$("#realtorInfoLinks .displayNone").fadeIn("slow");sgTrackGa({event:'event',category:'Listing_action',action:'show_phone_publisher_info'});}}
else if(type=="vr_popup")
{if($("#fb_pixel_flag").text()=="1"){fbq('track','ViewContent',{value:1,currency:"EUR",content_category:"Listing",content_name:toGreeklish($("#fb_pixel_geo").text()),content_ids:toGreeklish(decodeURIComponent(window.location.href))});}
$("span.vr_phone").html(response.data);$("a.vr_phone").hide();$("span.vr_phone").fadeIn("slow");sgTrackGa({event:'event',category:'Listing_action',action:'show_phone_visit_request'});}
else if(type=="agency")
{var location="";if($("#broker_details > div:nth-child(1) > div > div.bd > p").text()){location=", "+$("#broker_details > div:nth-child(1) > div > div.bd > p").text();}
if($("#fb_pixel_flag").text()=="1"){fbq('track','ViewContent',{value:1,currency:"EUR",content_category:"Profile",content_name:toGreeklish($("#main > div > div:nth-child(2) > section.broker_info_holder.dark_phone > div > div.broker_info_cell.broker_title > h1").text()+location),content_ids:toGreeklish(decodeURIComponent(window.location.href))});}
$("#brokerPhone").html(response.data);$("#brokerPhoneSubmit").hide();$("#brokerPhone").fadeIn("slow");sgTrackGa({event:'event',category:'Broker_profile',action:'show_phone'});}
else if(type=="emptyPropertiesList"||type=="brokersIndex")
{if(target)
{if($("#fb_pixel_flag").text()=="1"){fbq('track','ViewContent',{value:1,currency:"EUR",content_category:"Profile",content_name:"Agents List",content_ids:toGreeklish(decodeURIComponent(window.location.href))});}
var category=type=="emptyPropertiesList"?"empty_search_results_Broker_list":"Broker_Index"
$(target).html(response.data).addClass("triggered");sgTrackGa({event:'event',category:category,action:'show_phone'});}}}},error:function(){$.jGrowlError($("#general_searchURL_error").attr("title"),{sticky:true});}});};(function($){if(!$.omr){$.omr=new Object();};$.omr.mosaic=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("omr.mosaic",base);base.init=function(){base.options=$.extend({},$.omr.mosaic.defaultOptions,options);base.load_box();};base.load_box=function(){if(base.options.preload){$(base.options.backdrop,base.el).hide();$(base.options.overlay,base.el).hide();$(window).load(function(){if(base.options.options.animation=='fade'&&$(base.options.overlay,base.el).css('opacity')==0)$(base.options.overlay,base.el).css('filter','alpha(opacity=0)');$(base.options.overlay,base.el).fadeIn(200,function(){$(base.options.backdrop,base.el).fadeIn(200);});base.allow_hover();});}else{$(base.options.backdrop,base.el).show();$(base.options.overlay,base.el).show();base.allow_hover();}};base.allow_hover=function(){switch(base.options.animation){case'fade':$(base.el).hover(function(){$(base.options.overlay,base.el).stop().fadeTo(base.options.speed,base.options.opacity);},function(){$(base.options.overlay,base.el).stop().fadeTo(base.options.speed,0);});break;case'slide':startX=$(base.options.overlay,base.el).css(base.options.anchor_x)!='auto'?$(base.options.overlay,base.el).css(base.options.anchor_x):'0px';startY=$(base.options.overlay,base.el).css(base.options.anchor_y)!='auto'?$(base.options.overlay,base.el).css(base.options.anchor_y):'0px';;var hoverState={};hoverState[base.options.anchor_x]=base.options.hover_x;hoverState[base.options.anchor_y]=base.options.hover_y;var endState={};endState[base.options.anchor_x]=startX;endState[base.options.anchor_y]=startY;$(base.el).hover(function(){$(base.options.overlay,base.el).stop().animate(hoverState,base.options.speed);},function(){$(base.options.overlay,base.el).stop().animate(endState,base.options.speed);});break;};};base.init();};$.omr.mosaic.defaultOptions={animation:'fade',speed:150,opacity:0.94,preload:0,anchor_x:'left',anchor_y:'bottom',hover_x:'0px',hover_y:'0px',overlay:'.mosaic-overlay',backdrop:'.mosaic-backdrop'};$.fn.mosaic=function(options){return this.each(function(){(new $.omr.mosaic(this,options));});};})(jQuery);;if(typeof Object.create!=="function"){Object.create=function(obj){function F(){};F.prototype=obj;return new F();};}
(function($,window,document,undefined){var Carousel={init:function(options,el){var base=this;base.$elem=$(el);base.options=$.extend({},$.fn.owlCarousel.options,base.$elem.data(),options);base.userOptions=options;base.loadContent();},loadContent:function(){var base=this;if(typeof base.options.beforeInit==="function"){base.options.beforeInit.apply(this,[base.$elem]);}
if(typeof base.options.jsonPath==="string"){var url=base.options.jsonPath;function getData(data){if(typeof base.options.jsonSuccess==="function"){base.options.jsonSuccess.apply(this,[data]);}else{var content="";for(var i in data["owl"]){content+=data["owl"][i]["item"];}
base.$elem.html(content);}
base.logIn();}
$.getJSON(url,getData);}else{base.logIn();}},logIn:function(action){var base=this;base.$elem.data("owl-originalStyles",base.$elem.attr("style")).data("owl-originalClasses",base.$elem.attr("class"));base.$elem.css({opacity:0});base.orignalItems=base.options.items;base.checkBrowser();base.wrapperWidth=0;base.checkVisible;base.setVars();},setVars:function(){var base=this;if(base.$elem.children().length===0){return false}
base.baseClass();base.eventTypes();base.$userItems=base.$elem.children();base.itemsAmount=base.$userItems.length;base.wrapItems();base.$owlItems=base.$elem.find(".owl-item");base.$owlWrapper=base.$elem.find(".owl-wrapper");base.playDirection="next";base.prevItem=0;base.prevArr=[0];base.currentItem=0;base.customEvents();base.onStartup();},onStartup:function(){var base=this;base.updateItems();base.calculateAll();base.buildControls();base.updateControls();base.response();base.moveEvents();base.stopOnHover();base.owlStatus();if(base.options.transitionStyle!==false){base.transitionTypes(base.options.transitionStyle);}
if(base.options.autoPlay===true){base.options.autoPlay=5000;}
base.play();base.$elem.find(".owl-wrapper").css("display","block")
if(!base.$elem.is(":visible")){base.watchVisibility();}else{base.$elem.css("opacity",1);}
base.onstartup=false;base.eachMoveUpdate();if(typeof base.options.afterInit==="function"){base.options.afterInit.apply(this,[base.$elem]);}},eachMoveUpdate:function(){var base=this;if(base.options.lazyLoad===true){base.lazyLoad();}
if(base.options.autoHeight===true){base.autoHeight();}
base.onVisibleItems();if(typeof base.options.afterAction==="function"){base.options.afterAction.apply(this,[base.$elem]);}},updateVars:function(){var base=this;if(typeof base.options.beforeUpdate==="function"){base.options.beforeUpdate.apply(this,[base.$elem]);}
base.watchVisibility();base.updateItems();base.calculateAll();base.updatePosition();base.updateControls();base.eachMoveUpdate();if(typeof base.options.afterUpdate==="function"){base.options.afterUpdate.apply(this,[base.$elem]);}},reload:function(elements){var base=this;setTimeout(function(){base.updateVars();},0)},watchVisibility:function(){var base=this;if(base.$elem.is(":visible")===false){base.$elem.css({opacity:0});clearInterval(base.autoPlayInterval);clearInterval(base.checkVisible);}else{return false;}
base.checkVisible=setInterval(function(){if(base.$elem.is(":visible")){base.reload();base.$elem.animate({opacity:1},200);clearInterval(base.checkVisible);}},500);},wrapItems:function(){var base=this;base.$userItems.wrapAll("<div class=\"owl-wrapper\">").wrap("<div class=\"owl-item\"></div>");base.$elem.find(".owl-wrapper").wrap("<div class=\"owl-wrapper-outer\">");base.wrapperOuter=base.$elem.find(".owl-wrapper-outer");base.$elem.css("display","block");},baseClass:function(){var base=this;var hasBaseClass=base.$elem.hasClass(base.options.baseClass);var hasThemeClass=base.$elem.hasClass(base.options.theme);if(!hasBaseClass){base.$elem.addClass(base.options.baseClass);}
if(!hasThemeClass){base.$elem.addClass(base.options.theme);}},updateItems:function(){var base=this;if(base.options.responsive===false){return false;}
if(base.options.singleItem===true){base.options.items=base.orignalItems=1;base.options.itemsCustom=false;base.options.itemsDesktop=false;base.options.itemsDesktopSmall=false;base.options.itemsTablet=false;base.options.itemsTabletSmall=false;base.options.itemsMobile=false;return false;}
var width=$(base.options.responsiveBaseWidth).width();if(width>(base.options.itemsDesktop[0]||base.orignalItems)){base.options.items=base.orignalItems;}
if(typeof(base.options.itemsCustom)!=='undefined'&&base.options.itemsCustom!==false){base.options.itemsCustom.sort(function(a,b){return a[0]-b[0];});for(var i in base.options.itemsCustom){if(typeof(base.options.itemsCustom[i])!=='undefined'&&base.options.itemsCustom[i][0]<=width){base.options.items=base.options.itemsCustom[i][1];}}}else{if(width<=base.options.itemsDesktop[0]&&base.options.itemsDesktop!==false){base.options.items=base.options.itemsDesktop[1];}
if(width<=base.options.itemsDesktopSmall[0]&&base.options.itemsDesktopSmall!==false){base.options.items=base.options.itemsDesktopSmall[1];}
if(width<=base.options.itemsTablet[0]&&base.options.itemsTablet!==false){base.options.items=base.options.itemsTablet[1];}
if(width<=base.options.itemsTabletSmall[0]&&base.options.itemsTabletSmall!==false){base.options.items=base.options.itemsTabletSmall[1];}
if(width<=base.options.itemsMobile[0]&&base.options.itemsMobile!==false){base.options.items=base.options.itemsMobile[1];}}
if(base.options.items>base.itemsAmount&&base.options.itemsScaleUp===true){base.options.items=base.itemsAmount;}},response:function(){var base=this,smallDelay;if(base.options.responsive!==true){return false}
var lastWindowWidth=$(window).width();base.resizer=function(){if($(window).width()!==lastWindowWidth){if(base.options.autoPlay!==false){clearInterval(base.autoPlayInterval);}
clearTimeout(smallDelay);smallDelay=setTimeout(function(){lastWindowWidth=$(window).width();base.updateVars();},base.options.responsiveRefreshRate);}}
$(window).resize(base.resizer)},updatePosition:function(){var base=this;base.jumpTo(base.currentItem);if(base.options.autoPlay!==false){base.checkAp();}},appendItemsSizes:function(){var base=this;var roundPages=0;var lastItem=base.itemsAmount-base.options.items;base.$owlItems.each(function(index){var $this=$(this);$this.css({"width":base.itemWidth}).data("owl-item",Number(index));if(index%base.options.items===0||index===lastItem){if(!(index>lastItem)){roundPages+=1;}}
$this.data("owl-roundPages",roundPages)});},appendWrapperSizes:function(){var base=this;var width=0;var width=base.$owlItems.length*base.itemWidth;base.$owlWrapper.css({"width":width*2,"left":0});base.appendItemsSizes();},calculateAll:function(){var base=this;base.calculateWidth();base.appendWrapperSizes();base.loops();base.max();},calculateWidth:function(){var base=this;base.itemWidth=Math.round(base.$elem.width()/base.options.items)},max:function(){var base=this;var maximum=((base.itemsAmount*base.itemWidth)-base.options.items*base.itemWidth)*-1;if(base.options.items>base.itemsAmount){base.maximumItem=0;maximum=0
base.maximumPixels=0;}else{base.maximumItem=base.itemsAmount-base.options.items;base.maximumPixels=maximum;}
return maximum;},min:function(){return 0;},loops:function(){var base=this;base.positionsInArray=[0];base.pagesInArray=[];var prev=0;var elWidth=0;for(var i=0;i<base.itemsAmount;i++){elWidth+=base.itemWidth;base.positionsInArray.push(-elWidth);if(base.options.scrollPerPage===true){var item=$(base.$owlItems[i]);var roundPageNum=item.data("owl-roundPages");if(roundPageNum!==prev){base.pagesInArray[prev]=base.positionsInArray[i];prev=roundPageNum;}}}},buildControls:function(){var base=this;if(base.options.navigation===true||base.options.pagination===true){base.owlControls=$("<div class=\"owl-controls\"/>").toggleClass("clickable",!base.browser.isTouch).appendTo(base.$elem);}
if(base.options.pagination===true){base.buildPagination();}
if(base.options.navigation===true){base.buildButtons();}},buildButtons:function(){var base=this;var buttonsWrapper=$("<div class=\"owl-buttons\"/>")
base.owlControls.append(buttonsWrapper);base.buttonPrev=$("<div/>",{"class":"owl-prev","html":base.options.navigationText[0]||""});base.buttonNext=$("<div/>",{"class":"owl-next","html":base.options.navigationText[1]||""});buttonsWrapper.append(base.buttonPrev).append(base.buttonNext);buttonsWrapper.on("touchstart.owlControls mousedown.owlControls","div[class^=\"owl\"]",function(event){event.preventDefault();})
buttonsWrapper.on("touchend.owlControls mouseup.owlControls","div[class^=\"owl\"]",function(event){event.preventDefault();if($(this).hasClass("owl-next")){base.next();}else{base.prev();}})},buildPagination:function(){var base=this;base.paginationWrapper=$("<div class=\"owl-pagination\"/>");base.owlControls.append(base.paginationWrapper);base.paginationWrapper.on("touchend.owlControls mouseup.owlControls",".owl-page",function(event){event.preventDefault();if(Number($(this).data("owl-page"))!==base.currentItem){base.goTo(Number($(this).data("owl-page")),true);}});},updatePagination:function(){var base=this;if(base.options.pagination===false){return false;}
base.paginationWrapper.html("");var counter=0;var lastPage=base.itemsAmount-base.itemsAmount%base.options.items;for(var i=0;i<base.itemsAmount;i++){if(i%base.options.items===0){counter+=1;if(lastPage===i){var lastItem=base.itemsAmount-base.options.items;}
var paginationButton=$("<div/>",{"class":"owl-page"});var paginationButtonInner=$("<span></span>",{"text":base.options.paginationNumbers===true?counter:"","class":base.options.paginationNumbers===true?"owl-numbers":""});paginationButton.append(paginationButtonInner);paginationButton.data("owl-page",lastPage===i?lastItem:i);paginationButton.data("owl-roundPages",counter);base.paginationWrapper.append(paginationButton);}}
base.checkPagination();},checkPagination:function(){var base=this;if(base.options.pagination===false){return false;}
base.paginationWrapper.find(".owl-page").each(function(i,v){if($(this).data("owl-roundPages")===$(base.$owlItems[base.currentItem]).data("owl-roundPages")){base.paginationWrapper.find(".owl-page").removeClass("active");$(this).addClass("active");}});},checkNavigation:function(){var base=this;if(base.options.navigation===false){return false;}
if(base.options.rewindNav===false){if(base.currentItem===0&&base.maximumItem===0){base.buttonPrev.addClass("disabled");base.buttonNext.addClass("disabled");}else if(base.currentItem===0&&base.maximumItem!==0){base.buttonPrev.addClass("disabled");base.buttonNext.removeClass("disabled");}else if(base.currentItem===base.maximumItem){base.buttonPrev.removeClass("disabled");base.buttonNext.addClass("disabled");}else if(base.currentItem!==0&&base.currentItem!==base.maximumItem){base.buttonPrev.removeClass("disabled");base.buttonNext.removeClass("disabled");}}},updateControls:function(){var base=this;base.updatePagination();base.checkNavigation();if(base.owlControls){if(base.options.items>=base.itemsAmount){base.owlControls.hide();}else{base.owlControls.show();}}},destroyControls:function(){var base=this;if(base.owlControls){base.owlControls.remove();}},next:function(speed){var base=this;if(base.isTransition){return false;}
base.currentItem+=base.options.scrollPerPage===true?base.options.items:1;if(base.currentItem>base.maximumItem+(base.options.scrollPerPage==true?(base.options.items-1):0)){if(base.options.rewindNav===true){base.currentItem=0;speed="rewind";}else{base.currentItem=base.maximumItem;return false;}}
base.goTo(base.currentItem,speed);},prev:function(speed){var base=this;if(base.isTransition){return false;}
if(base.options.scrollPerPage===true&&base.currentItem>0&&base.currentItem<base.options.items){base.currentItem=0}else{base.currentItem-=base.options.scrollPerPage===true?base.options.items:1;}
if(base.currentItem<0){if(base.options.rewindNav===true){base.currentItem=base.maximumItem;speed="rewind"}else{base.currentItem=0;return false;}}
base.goTo(base.currentItem,speed);},goTo:function(position,speed,drag){var base=this;if(base.isTransition){return false;}
if(typeof base.options.beforeMove==="function"){base.options.beforeMove.apply(this,[base.$elem]);}
if(position>=base.maximumItem){position=base.maximumItem;}
else if(position<=0){position=0;}
base.currentItem=base.owl.currentItem=position;if(base.options.transitionStyle!==false&&drag!=="drag"&&base.options.items===1&&base.browser.support3d===true){base.swapSpeed(0)
if(base.browser.support3d===true){base.transition3d(base.positionsInArray[position]);}else{base.css2slide(base.positionsInArray[position],1);}
base.afterGo();base.singleItemTransition();return false;}
var goToPixel=base.positionsInArray[position];if(base.browser.support3d===true){base.isCss3Finish=false;if(speed===true){base.swapSpeed("paginationSpeed");setTimeout(function(){base.isCss3Finish=true;},base.options.paginationSpeed);}else if(speed==="rewind"){base.swapSpeed(base.options.rewindSpeed);setTimeout(function(){base.isCss3Finish=true;},base.options.rewindSpeed);}else{base.swapSpeed("slideSpeed");setTimeout(function(){base.isCss3Finish=true;},base.options.slideSpeed);}
base.transition3d(goToPixel);}else{if(speed===true){base.css2slide(goToPixel,base.options.paginationSpeed);}else if(speed==="rewind"){base.css2slide(goToPixel,base.options.rewindSpeed);}else{base.css2slide(goToPixel,base.options.slideSpeed);}}
base.afterGo();},jumpTo:function(position){var base=this;if(typeof base.options.beforeMove==="function"){base.options.beforeMove.apply(this,[base.$elem]);}
if(position>=base.maximumItem||position===-1){position=base.maximumItem;}
else if(position<=0){position=0;}
base.swapSpeed(0)
if(base.browser.support3d===true){base.transition3d(base.positionsInArray[position]);}else{base.css2slide(base.positionsInArray[position],1);}
base.currentItem=base.owl.currentItem=position;base.afterGo();},afterGo:function(){var base=this;base.prevArr.push(base.currentItem);base.prevItem=base.owl.prevItem=base.prevArr[base.prevArr.length-2];base.prevArr.shift(0)
if(base.prevItem!==base.currentItem){base.checkPagination();base.checkNavigation();base.eachMoveUpdate();if(base.options.autoPlay!==false){base.checkAp();}}
if(typeof base.options.afterMove==="function"&&base.prevItem!==base.currentItem){base.options.afterMove.apply(this,[base.$elem]);}},stop:function(){var base=this;base.apStatus="stop";clearInterval(base.autoPlayInterval);},checkAp:function(){var base=this;if(base.apStatus!=="stop"){base.play();}},play:function(){var base=this;base.apStatus="play";if(base.options.autoPlay===false){return false;}
clearInterval(base.autoPlayInterval);base.autoPlayInterval=setInterval(function(){base.next(true);},base.options.autoPlay);},swapSpeed:function(action){var base=this;if(action==="slideSpeed"){base.$owlWrapper.css(base.addCssSpeed(base.options.slideSpeed));}else if(action==="paginationSpeed"){base.$owlWrapper.css(base.addCssSpeed(base.options.paginationSpeed));}else if(typeof action!=="string"){base.$owlWrapper.css(base.addCssSpeed(action));}},addCssSpeed:function(speed){var base=this;return{"-webkit-transition":"all "+speed+"ms ease","-moz-transition":"all "+speed+"ms ease","-o-transition":"all "+speed+"ms ease","transition":"all "+speed+"ms ease"};},removeTransition:function(){return{"-webkit-transition":"","-moz-transition":"","-o-transition":"","transition":""};},doTranslate:function(pixels){return{"-webkit-transform":"translate3d("+pixels+"px, 0px, 0px)","-moz-transform":"translate3d("+pixels+"px, 0px, 0px)","-o-transform":"translate3d("+pixels+"px, 0px, 0px)","-ms-transform":"translate3d("+pixels+"px, 0px, 0px)","transform":"translate3d("+pixels+"px, 0px,0px)"};},transition3d:function(value){var base=this;base.$owlWrapper.css(base.doTranslate(value));},css2move:function(value){var base=this;base.$owlWrapper.css({"left":value})},css2slide:function(value,speed){var base=this;base.isCssFinish=false;base.$owlWrapper.stop(true,true).animate({"left":value},{duration:speed||base.options.slideSpeed,complete:function(){base.isCssFinish=true;}});},checkBrowser:function(){var base=this;var translate3D="translate3d(0px, 0px, 0px)",tempElem=document.createElement("div");tempElem.style.cssText="  -moz-transform:"+translate3D+"; -ms-transform:"+translate3D+"; -o-transform:"+translate3D+"; -webkit-transform:"+translate3D+"; transform:"+translate3D;var regex=/translate3d\(0px, 0px, 0px\)/g,asSupport=tempElem.style.cssText.match(regex),support3d=(asSupport!==null&&asSupport.length===1);var isTouch="ontouchstart"in window||navigator.msMaxTouchPoints;base.browser={"support3d":support3d,"isTouch":isTouch}},moveEvents:function(){var base=this;if(base.options.mouseDrag!==false||base.options.touchDrag!==false){base.gestures();base.disabledEvents();}},eventTypes:function(){var base=this;var types=["s","e","x"];base.ev_types={};if(base.options.mouseDrag===true&&base.options.touchDrag===true){types=["touchstart.owl mousedown.owl","touchmove.owl mousemove.owl","touchend.owl touchcancel.owl mouseup.owl"];}else if(base.options.mouseDrag===false&&base.options.touchDrag===true){types=["touchstart.owl","touchmove.owl","touchend.owl touchcancel.owl"];}else if(base.options.mouseDrag===true&&base.options.touchDrag===false){types=["mousedown.owl","mousemove.owl","mouseup.owl"];}
base.ev_types["start"]=types[0];base.ev_types["move"]=types[1];base.ev_types["end"]=types[2];},disabledEvents:function(){var base=this;base.$elem.on("dragstart.owl",function(event){event.preventDefault();});base.$elem.on("mousedown.disableTextSelect",function(e){return $(e.target).is('input, textarea, select, option');});},gestures:function(){var base=this;var locals={offsetX:0,offsetY:0,baseElWidth:0,relativePos:0,position:null,minSwipe:null,maxSwipe:null,sliding:null,dargging:null,targetElement:null}
base.isCssFinish=true;function getTouches(event){if(event.touches){return{x:event.touches[0].pageX,y:event.touches[0].pageY}}else{if(event.pageX!==undefined){return{x:event.pageX,y:event.pageY}}else{return{x:event.clientX,y:event.clientY}}}}
function swapEvents(type){if(type==="on"){$(document).on(base.ev_types["move"],dragMove);$(document).on(base.ev_types["end"],dragEnd);}else if(type==="off"){$(document).off(base.ev_types["move"]);$(document).off(base.ev_types["end"]);}}
function dragStart(event){var event=event.originalEvent||event||window.event;if(event.which===3){return false;}
if(base.itemsAmount<=base.options.items){return;}
if(base.isCssFinish===false&&!base.options.dragBeforeAnimFinish){return false;}
if(base.isCss3Finish===false&&!base.options.dragBeforeAnimFinish){return false;}
if(base.options.autoPlay!==false){clearInterval(base.autoPlayInterval);}
if(base.browser.isTouch!==true&&!base.$owlWrapper.hasClass("grabbing")){base.$owlWrapper.addClass("grabbing")}
base.newPosX=0;base.newRelativeX=0;$(this).css(base.removeTransition());var position=$(this).position();locals.relativePos=position.left;locals.offsetX=getTouches(event).x-position.left;locals.offsetY=getTouches(event).y-position.top;swapEvents("on");locals.sliding=false;locals.targetElement=event.target||event.srcElement;}
function dragMove(event){var event=event.originalEvent||event||window.event;base.newPosX=getTouches(event).x-locals.offsetX;base.newPosY=getTouches(event).y-locals.offsetY;base.newRelativeX=base.newPosX-locals.relativePos;if(typeof base.options.startDragging==="function"&&locals.dragging!==true&&base.newRelativeX!==0){locals.dragging=true;base.options.startDragging.apply(base,[base.$elem]);}
if(base.newRelativeX>8||base.newRelativeX<-8&&base.browser.isTouch===true){event.preventDefault?event.preventDefault():event.returnValue=false;locals.sliding=true;}
if((base.newPosY>10||base.newPosY<-10)&&locals.sliding===false){$(document).off("touchmove.owl");}
var minSwipe=function(){return base.newRelativeX/5;}
var maxSwipe=function(){return base.maximumPixels+base.newRelativeX/5;}
base.newPosX=Math.max(Math.min(base.newPosX,minSwipe()),maxSwipe());if(base.browser.support3d===true){base.transition3d(base.newPosX);}else{base.css2move(base.newPosX);}}
function dragEnd(event){var event=event.originalEvent||event||window.event;event.target=event.target||event.srcElement;locals.dragging=false;if(base.browser.isTouch!==true){base.$owlWrapper.removeClass("grabbing");}
if(base.newRelativeX<0){base.dragDirection=base.owl.dragDirection="left"}else{base.dragDirection=base.owl.dragDirection="right"}
if(base.newRelativeX!==0){var newPosition=base.getNewPosition();base.goTo(newPosition,false,"drag");if(locals.targetElement===event.target&&base.browser.isTouch!==true){$(event.target).on("click.disable",function(ev){ev.stopImmediatePropagation();ev.stopPropagation();ev.preventDefault();$(event.target).off("click.disable");});var handlers=$._data(event.target,"events")["click"];var owlStopEvent=handlers.pop();handlers.splice(0,0,owlStopEvent);}}
swapEvents("off");}
base.$elem.on(base.ev_types["start"],".owl-wrapper",dragStart);},getNewPosition:function(){var base=this,newPosition;newPosition=base.closestItem();if(newPosition>base.maximumItem){base.currentItem=base.maximumItem;newPosition=base.maximumItem;}else if(base.newPosX>=0){newPosition=0;base.currentItem=0;}
return newPosition;},closestItem:function(){var base=this,array=base.options.scrollPerPage===true?base.pagesInArray:base.positionsInArray,goal=base.newPosX,closest=null;$.each(array,function(i,v){if(goal-(base.itemWidth/20)>array[i+1]&&goal-(base.itemWidth/20)<v&&base.moveDirection()==="left"){closest=v;if(base.options.scrollPerPage===true){base.currentItem=$.inArray(closest,base.positionsInArray);}else{base.currentItem=i;}}
else if(goal+(base.itemWidth/20)<v&&goal+(base.itemWidth/20)>(array[i+1]||array[i]-base.itemWidth)&&base.moveDirection()==="right"){if(base.options.scrollPerPage===true){closest=array[i+1]||array[array.length-1];base.currentItem=$.inArray(closest,base.positionsInArray);}else{closest=array[i+1];base.currentItem=i+1;}}});return base.currentItem;},moveDirection:function(){var base=this,direction;if(base.newRelativeX<0){direction="right"
base.playDirection="next"}else{direction="left"
base.playDirection="prev"}
return direction},customEvents:function(){var base=this;base.$elem.on("owl.next",function(){base.next();});base.$elem.on("owl.prev",function(){base.prev();});base.$elem.on("owl.play",function(event,speed){base.options.autoPlay=speed;base.play();base.hoverStatus="play";});base.$elem.on("owl.stop",function(){base.stop();base.hoverStatus="stop";});base.$elem.on("owl.goTo",function(event,item){base.goTo(item)});base.$elem.on("owl.jumpTo",function(event,item){base.jumpTo(item)});},stopOnHover:function(){var base=this;if(base.options.stopOnHover===true&&base.browser.isTouch!==true&&base.options.autoPlay!==false){base.$elem.on("mouseover",function(){base.stop();});base.$elem.on("mouseout",function(){if(base.hoverStatus!=="stop"){base.play();}});}},lazyLoad:function(){var base=this;if(base.options.lazyLoad===false){return false;}
for(var i=0;i<base.itemsAmount;i++){var $item=$(base.$owlItems[i]);if($item.data("owl-loaded")==="loaded"){continue;}
var itemNumber=$item.data("owl-item"),$lazyImg=$item.find(".lazyOwl"),follow;if(typeof $lazyImg.data("src")!=="string"){$item.data("owl-loaded","loaded");continue;}
if($item.data("owl-loaded")===undefined){$lazyImg.hide();$item.addClass("loading").data("owl-loaded","checked");}
if(base.options.lazyFollow===true){follow=itemNumber>=base.currentItem;}else{follow=true;}
if(follow&&itemNumber<base.currentItem+base.options.items&&$lazyImg.length){base.lazyPreload($item,$lazyImg);}}},lazyPreload:function($item,$lazyImg){var base=this,iterations=0;if($lazyImg.prop("tagName")==="DIV"){$lazyImg.css("background-image","url("+$lazyImg.data("src")+")");var isBackgroundImg=true;}else{$lazyImg[0].src=$lazyImg.data("src");}
checkLazyImage();function checkLazyImage(){iterations+=1;if(base.completeImg($lazyImg.get(0))||isBackgroundImg===true){showImage();}else if(iterations<=100){setTimeout(checkLazyImage,100);}else{showImage();}}
function showImage(){$item.data("owl-loaded","loaded").removeClass("loading");$lazyImg.removeAttr("data-src");base.options.lazyEffect==="fade"?$lazyImg.fadeIn(400):$lazyImg.show();if(typeof base.options.afterLazyLoad==="function"){base.options.afterLazyLoad.apply(this,[base.$elem]);}}},autoHeight:function(){var base=this;var $currentimg=$(base.$owlItems[base.currentItem]).find("img");if($currentimg.get(0)!==undefined){var iterations=0;checkImage();}else{addHeight();}
function checkImage(){iterations+=1;if(base.completeImg($currentimg.get(0))){addHeight();}else if(iterations<=100){setTimeout(checkImage,100);}else{base.wrapperOuter.css("height","");}}
function addHeight(){var $currentItem=$(base.$owlItems[base.currentItem]).height();base.wrapperOuter.css("height",$currentItem+"px");if(!base.wrapperOuter.hasClass("autoHeight")){setTimeout(function(){base.wrapperOuter.addClass("autoHeight");},0);}}},completeImg:function(img){if(!img.complete){return false;}
if(typeof img.naturalWidth!=="undefined"&&img.naturalWidth==0){return false;}
return true;},onVisibleItems:function(){var base=this;if(base.options.addClassActive===true){base.$owlItems.removeClass("active");}
base.visibleItems=[];for(var i=base.currentItem;i<base.currentItem+base.options.items;i++){base.visibleItems.push(i);if(base.options.addClassActive===true){$(base.$owlItems[i]).addClass("active");}}
base.owl.visibleItems=base.visibleItems;},transitionTypes:function(className){var base=this;base.outClass="owl-"+className+"-out";base.inClass="owl-"+className+"-in";},singleItemTransition:function(){var base=this;base.isTransition=true;var outClass=base.outClass,inClass=base.inClass,$currentItem=base.$owlItems.eq(base.currentItem),$prevItem=base.$owlItems.eq(base.prevItem),prevPos=Math.abs(base.positionsInArray[base.currentItem])+base.positionsInArray[base.prevItem],origin=Math.abs(base.positionsInArray[base.currentItem])+base.itemWidth/2;base.$owlWrapper.addClass('owl-origin').css({"-webkit-transform-origin":origin+"px","-moz-perspective-origin":origin+"px","perspective-origin":origin+"px"});function transStyles(prevPos,zindex){return{"position":"relative","left":prevPos+"px"};}
var animEnd='webkitAnimationEnd oAnimationEnd MSAnimationEnd animationend';$prevItem.css(transStyles(prevPos,10)).addClass(outClass).on(animEnd,function(){base.endPrev=true;$prevItem.off(animEnd);base.clearTransStyle($prevItem,outClass);});$currentItem.addClass(inClass).on(animEnd,function(){base.endCurrent=true;$currentItem.off(animEnd);base.clearTransStyle($currentItem,inClass);});},clearTransStyle:function(item,classToRemove){var base=this;item.css({"position":"","left":""}).removeClass(classToRemove);if(base.endPrev&&base.endCurrent){base.$owlWrapper.removeClass('owl-origin');base.endPrev=false;base.endCurrent=false;base.isTransition=false;}},owlStatus:function(){var base=this;base.owl={"userOptions":base.userOptions,"baseElement":base.$elem,"userItems":base.$userItems,"owlItems":base.$owlItems,"currentItem":base.currentItem,"prevItem":base.prevItem,"visibleItems":base.visibleItems,"isTouch":base.browser.isTouch,"browser":base.browser,"dragDirection":base.dragDirection}},clearEvents:function(){var base=this;base.$elem.off(".owl owl mousedown.disableTextSelect");$(document).off(".owl owl");$(window).off("resize",base.resizer);},unWrap:function(){var base=this;if(base.$elem.children().length!==0){base.$owlWrapper.unwrap();base.$userItems.unwrap().unwrap();if(base.owlControls){base.owlControls.remove();}}
base.clearEvents();base.$elem.attr("style",base.$elem.data("owl-originalStyles")||"").attr("class",base.$elem.data("owl-originalClasses"));},destroy:function(){var base=this;base.stop();clearInterval(base.checkVisible);base.unWrap();base.$elem.removeData();},reinit:function(newOptions){var base=this;var options=$.extend({},base.userOptions,newOptions);base.unWrap();base.init(options,base.$elem);},addItem:function(htmlString,targetPosition){var base=this,position;if(!htmlString){return false}
if(base.$elem.children().length===0){base.$elem.append(htmlString);base.setVars();return false;}
base.unWrap();if(targetPosition===undefined||targetPosition===-1){position=-1;}else{position=targetPosition;}
if(position>=base.$userItems.length||position===-1){base.$userItems.eq(-1).after(htmlString)}else{base.$userItems.eq(position).before(htmlString)}
base.setVars();},removeItem:function(targetPosition){var base=this,position;if(base.$elem.children().length===0){return false}
if(targetPosition===undefined||targetPosition===-1){position=-1;}else{position=targetPosition;}
base.unWrap();base.$userItems.eq(position).remove();base.setVars();}};$.fn.owlCarousel=function(options){return this.each(function(){if($(this).data("owl-init")===true){return false;}
$(this).data("owl-init",true);var carousel=Object.create(Carousel);carousel.init(options,this);$.data(this,"owlCarousel",carousel);});};$.fn.owlCarousel.options={items:4,itemsCustom:false,itemsDesktop:[1180,3],itemsDesktopSmall:[960,3],itemsTablet:[767,2],itemsTabletSmall:false,itemsMobile:[460,1],singleItem:false,itemsScaleUp:false,slideSpeed:800,paginationSpeed:800,rewindSpeed:1000,autoPlay:false,stopOnHover:false,navigation:false,navigationText:["prev","next"],rewindNav:true,scrollPerPage:false,pagination:true,paginationNumbers:false,responsive:true,responsiveRefreshRate:200,responsiveBaseWidth:window,baseClass:"owl-carousel",theme:"owl-theme",lazyLoad:false,lazyFollow:true,lazyEffect:"fade",autoHeight:false,jsonPath:false,jsonSuccess:false,dragBeforeAnimFinish:true,mouseDrag:true,touchDrag:true,addClassActive:false,transitionStyle:false,beforeUpdate:false,afterUpdate:false,beforeInit:false,afterInit:false,beforeMove:false,afterMove:false,afterAction:false,startDragging:false,afterLazyLoad:false};})(jQuery,window,document);;VisualCaptchaModule=(function(){var visualCaptcha=[];var VisualCaptchaModule=function(element,rnd_visualCaptcha){visualCaptcha[rnd_visualCaptcha]=element;}
var _populateCaptchaIcons=function(rnd_visualCaptcha,imageOptions,validImageOption){$.each(imageOptions,function(key,value){$(visualCaptcha[rnd_visualCaptcha]).find('.captchaIconsWrapper').append('<img class="visualCaptchaImg" data-captcha="'+value['value']+'" src="'+$('#assetsLocation').attr('title')+'images/'+value['path']+'" />');});$(visualCaptcha[rnd_visualCaptcha]).find('.validCaptchaName').html(validImageOption);}
var _setUserCaptchaCode=function(rnd_visualCaptcha,userCaptchaCode){$(visualCaptcha[rnd_visualCaptcha]).find('.hiddenArea > input[name="fv_visualCaptchaCodeReq"]').val(userCaptchaCode);}
var _clearCaptcha=function(rnd_visualCaptcha){$(visualCaptcha[rnd_visualCaptcha]).find('.captchaIconsWrapper').html('');$(visualCaptcha[rnd_visualCaptcha]).find('.hiddenArea > input[name="fv_visualCaptchaCodeReq"]').val('');}
var _refreshCaptchaIcons=function(rnd_visualCaptcha,url){$.ajax({url:url,dataType:'json',type:'post',data:{rnd_visualCaptcha:rnd_visualCaptcha,spformat:true},success:function(response){if(response.responseStatus){_clearCaptcha(rnd_visualCaptcha);_populateCaptchaIcons(rnd_visualCaptcha,response.data.imageOptions,response.data.validImageOption);_bindUISetUserCaptchaCode(rnd_visualCaptcha);}}});}
var _bindUISetUserCaptchaCode=function(rnd_visualCaptcha){$('.visualCaptchaImg',visualCaptcha[rnd_visualCaptcha]).click(function(){$('.visualCaptchaImg',visualCaptcha[rnd_visualCaptcha]).css('opacity','0.6');$('.visualCaptchaImg',visualCaptcha[rnd_visualCaptcha]).css('border','2px solid transparent');$(this).css('border','2px solid');$(this).css('opacity','1');_setUserCaptchaCode(rnd_visualCaptcha,$(this).attr('data-captcha'));});}
var _bindUIRefreshCaptchaIcons=function(rnd_visualCaptcha){$('.refreshVisualCaptcha',visualCaptcha[rnd_visualCaptcha]).click(function(event){event.preventDefault();var url=$(this).attr('href');_refreshCaptchaIcons(rnd_visualCaptcha,url);});}
VisualCaptchaModule.prototype={initializeCapcthaIcons:function(rnd_visualCaptcha,imageOptions,validImageOption){_populateCaptchaIcons(rnd_visualCaptcha,imageOptions,validImageOption);_bindUISetUserCaptchaCode(rnd_visualCaptcha);_bindUIRefreshCaptchaIcons(rnd_visualCaptcha);}};return VisualCaptchaModule;})();function visualCaptchaInit(element){var rnd_visualCaptcha=$('.rnd_visualCaptcha',element).val();var vcm=new VisualCaptchaModule(element,rnd_visualCaptcha);vcm.initializeCapcthaIcons(rnd_visualCaptcha,window['imageOptions'+rnd_visualCaptcha],window['validImageOption'+rnd_visualCaptcha]);$(element).addClass('processed');}
$(function($){$(document).bind('visualCaptchaEvent',function(event){$('.captchaContainer:not(.processed)').each(function(){visualCaptchaInit(this);});});$(document).trigger('visualCaptchaEvent');});;$(function(){$(".sgModal_form_cancel").live("click",function(event){event.preventDefault();$(document).trigger("modalClose");});$("a.mySpitogatos_service").live("click",function(event){event.preventDefault();if($(this).hasClass("mySpitogatos_disabledLink")||$(".mySpitogatos_activeLink").length>0){return false;}
$(this).addClass("mySpitogatos_activeLink");var goTo=$(this).attr('data-destination')||$(this).attr("href");if($(this).hasClass("mySpitogatos_hide_listing"))
{var data=document.URL;data=data.replace(/\?.*/g,"");data="searchUrl="+encodeURIComponent(data);runAjaxService(goTo,data);}
else if($(this).parent("div").hasClass("fav-listing-action"))
{data="fromLD="+true;runAjaxService(goTo,data);}
else
{runAjaxService(goTo);}});$("a.mySpitogatos_service_deleteFavoriteListing, a.mySpitogatos_delete, a.mySpitogatos_service_deleteHiddenListing").live("click",function(event){event.preventDefault();if($(this).is(":hidden")){return false;}
var url=$(this).attr("href");if($(this).hasClass('mySpitogatos_service_deleteFavoriteListing')&&$('div#mySgFavList').length){url+="/mysg"}
var parent=$(this).parents(".mySpitogatos_ajaxBox");var caseHidden=$(this).hasClass("mySpitogatos_service_deleteHiddenListing");$(parent).addClass("disabled");var clicked_btn=$(this);var url=url+"/spformat".replace($("#baseUrl").attr("title"),$("#secureBaseUrl").attr("title"));$.ajax({url:url,dataType:"json",type:"get",cache:false,success:function(response){if(response.responseStatus==1){if(caseHidden){$('#hidden-notification-container').hide();}
$(document).trigger("mySpitogatosUpdate");if(response.data&&response.data.event){$(parent).html(response.data.data);$(document).trigger(response.data.event);}
else if(typeof(response.data.updateFavElement)!=='undefined'&&response.data.updateFavElement.length){if($("#favListingdiv").length){$("#favListingdiv a").replaceWith(response.data.updateFavElement);}
else{clicked_btn.replaceWith(response.data.updateFavElement);}}
else if(typeof(response.data.favResults)!=='undefined'&&response.data.favResults.length){$(parent).html(response.data.favResults);}
else{$(parent).html(response.data);}
if(typeof(response.messages.updateHideButton)!=='undefined'){$('div#hideBtn').html(response.messages.updateHideButton);}}
if($('.propertyListingList').length>0){$(".propertyListingList img.lazyImage").lazyload();}
$(parent).removeClass("disabled");},failure:function(response){if($('.propertyListingList').length>0){$(".propertyListingList img.lazyImage").lazyload();}
$(parent).removeClass("disabled");}});});$("a.sgModal_form_submit:not(.searchButtonDisabled)").live("click",function(event){event.preventDefault();event.stopImmediatePropagation();if($(this).hasClass("mainButton")){$(this).addClass("searchButtonDisabled").parents("form.sgModal_form").submit();}
else{$(this).addClass("disabled").parents("form.sgModal_form").submit();}});$("form.sgModal_form").live("submit",function(event){event.preventDefault();runAjaxService($(this).attr("action"),$(this).serialize());});function runAjaxService(href,data){if(href==""||href==undefined){$("a.mySpitogatos_activeLink").removeClass("mySpitogatos_activeLink");return false;}
if(data==""||data==undefined){data="spformat=true";}else{data=data+"&spformat=true";}
var hrefString=new String(href);var addToMyFavourites=false;var addToMySearches=false;var refreshPage=false;var addToNotes=false;var addToHidden=false;if(hrefString.indexOf("favourite/save")!=-1)
addToMyFavourites=true;if(hrefString.indexOf("search/save")!=-1)
addToMySearches=true;if(hrefString.indexOf("note/save")!=-1)
addToNotes=true;if(hrefString.indexOf("privateListing/delete")!=-1)
refreshPage=true;if(hrefString.indexOf("hidden/save")!=-1)
addToHidden=true;$.ajax({url:href.replace($("#baseUrl").attr("title"),$("#secureBaseUrl").attr("title")),dataType:"json",type:"post",async:false,data:data,success:function(response){if(response.data&&response.data.event){$(document).trigger(response.data.event);}
if(response.responseStatus==1||response.responseStatus=="1"){if(response.data&&response.data.title&&response.data.title!=""){$("a.mySpitogatos_activeLink").html(response.data.title).addClass("mySpitogatos_disabledLink");}
if(response.data.hiddenTotalNumberOfResults)
{$('a.mySpitogatos_activeLink').closest('div.searchListing').slideUp("normal",function(){$(this).remove();});$('h2.searchTotalNumberOfResults').html(response.data.hiddenTotalNumberOfResults);if(window.location.href!=response.data.newSearchUrl)
{window.history.pushState("","",response.data.newSearchUrl);}
if(typeof response.data.hiddenListing!=='undefined')
{$('div#searchDetailsListings').append(response.data.hiddenListing);}
if(typeof response.data.hiddenListings!=='undefined')
{$('div#searchDetailsListings').html(response.data.hiddenListings);}}
if(addToNotes){notes_text=data.split('&')[0].replace("fieldText=","");notes_text=notes_text.split('+').join(' ');if(notes_text.length){$("#myNotes_wrap").removeClass("hidden");$('#myNotes_text').html(notes_text);$("#myNote").addClass("hidden");}
else{$("#myNotes_wrap").addClass("hidden");$("#myNote").removeClass("hidden");}}
if(addToHidden){$('#hidden-notification-container').show();}
$("body").removeClass("ajax");$("a.mySpitogatos_activeLink").removeClass("mySpitogatos_activeLink");$("a.sgModal_form_submit.disabled").removeClass("disabled");$("a.sgModal_form_submit.searchButtonDisabled").removeClass("searchButtonDisabled");$(document).trigger("modalClose");if(response.data&&response.data.postEvent){$(document).trigger(response.data.postEvent);}
if(refreshPage){location.reload();}}else if(response.responseStatus==2){$(document).trigger("modalShow",response.data.view);if(response.data&&response.data.postEvent){$(document).trigger(response.data.postEvent);}
if($("#fieldSegments").length<1){$(".sgModal_form").append($("<input />").attr("type","hidden").attr("name","fieldSegments").attr("id","fieldSegments").val(response.data.segments));}
if(response.data.searchUrl){$(".sgModal_form").append($("<input />").attr("type","hidden").attr("name","searchUrl").attr("id","fieldSearchUrl").val(response.data.searchUrl));}
if($("#fieldOrigin").length<1){$(".sgModal_form").append($("<input />").attr("type","hidden").attr("name","fieldOrigin").attr("id","fieldOrigin").val("modal"));}
if($("#mySpitogatos_modal_search").length>0&&$("a.mySpitogatos_activeLink").hasClass("mySpitogatos_service_emailAlerts")){$("#emailAlerts").attr("checked",true);}
if(response.data&&response.data.angularApp&&response.data.angularContext){angular.bootstrap($("#"+response.data.angularContext),[response.data.angularApp]);}}else{$("a.mySpitogatos_activeLink").removeClass("mySpitogatos_activeLink");$("a.sgModal_form_submit.searchButtonDisabled").removeClass("searchButtonDisabled");}},failure:function(){$("body").removeClass("ajax");$("a.mySpitogatos_activeLink").removeClass("mySpitogatos_activeLink");}});}
if($("#myNotes_wrap").hasClass("hidden")){$("#myNote").removeClass("hidden");}
var myNotes=$("#myNotes_wrap");var mySpitogatos_link_notes=$("#mySpitogatos_url_myNotes").text();var mySpitogatos_link_modal=$("#mySpitogatos_url_myNotesModal").text();$("a.mySpitogatos_service_clearNote, a.mySpitogatos_service_clearNote_modal").live("click",function(event){event.preventDefault();href=$(this).attr("href");$.ajax({url:href.replace($("#baseUrl").attr("title"),$("#secureBaseUrl").attr("title")),dataType:"json",async:false,data:{spformat:true},success:function(response){$(document).trigger("myNotesClear");myNotes.addClass("hidden");$("#myNote").removeClass("hidden");$(document).trigger("modalClose");},failure:function(){$(document).trigger("myNotesClear");}});});});;function initializeMaps(){var myLat=$("#ldMyLat").attr("title");var myLng=$("#ldMyLng").attr("title");var myMarker={lat:myLat,lng:myLng};var infoTitle=$("#ldMyMarkerTitle").attr("title");var mapType=$("#ldMyGoogleMap").attr("title");if(myLat==''||myLng==''||mapType!="exact")
{$("#mapEmbed").addClass('hidden');return;}
var myOptions={zoom:15,center:myMarker,mapTypeId:google.maps.MapTypeId.ROADMAP};var map=new google.maps.Map(document.getElementById("mapEmbed"),myOptions);if(mapType=="exact"){var infowindow=new google.maps.InfoWindow({content:infoTitle,offset:new google.maps.Point(0,-40)});var marker=new google.maps.Marker({position:myMarker,map:map,title:infoTitle});infowindow.open(map,marker);}else if(mapType=="offset"){var circle=new google.maps.Circle({center:myLatlng,radius:150,fillColor:"#0000FF",fillOpacity:0.25,strokeColor:"#000080",strokeOpacity:0.75,strokeWeight:2,map:map,tooltipContent:myMarkerTitle});infoWindow.open(map,marker);}}
function refreshCaptcha(modalForm){var mf=modalForm!==".sgModal_form"?"":modalForm;$(mf+" #captchaImage a").click();$(mf+" #fv_captchaCodeReq").val("");}
function enableVisitSubmitButton(){$("a.visitSubmit").removeClass("visitRequestSubmitButtonDisabled");}
function googleTrackImagePopup(id){var listingId=$("#ldPropertyId").attr("title");sgTrackGa({event:'page',url:"listing/imagePopup-"+listingId+"-"+id});}
var fancyboxIndex=0;var urlList=new Array();function changeImageElement(element){if(!$(element).is("a")){element=$("a",element);}
var newSrc=$(element).attr("href");var img=$("#"+newSrc,"#carouselImageStore");var newTitle=$(element).attr("title");imagePreload("#largeImage a img",newSrc,newTitle);var parentSlide=$(element).closest(".sgCarouselSlide");var items=$("li a",parentSlide);fancyboxIndex=$(items).index(element);}
function afterSubmit(response,statusText,xhr,$form){enableVisitSubmitButton();$('.refreshVisualCaptcha',$form).trigger('click');if(response.responseStatus&&(response.responseStatus==1||response.responseStatus=="1"))
{if(response.data.origin!=false)
{if($("#fb_pixel_flag").text()=="1"){fbq('track','Lead',{value:3,currency:"EUR",content_category:"Primary",content_name:"Visit Request"});}
sgTrackGa({event:'event',category:'Visit_Request',action:response.data.origin});sgTrackGa({event:'event',category:'Visit_Request_Listing_Type',action:$('#googleAnalyticsVisitRequestListingTracking').attr('title')});}}}
$(function($){$(".PrintLinked").live("click",function(e){e.preventDefault();var t=$(this).find('#printListingAction').attr('href');var o="",r="";var n=1000;var i=750;n&&(o=(screen.width-n)/2),i&&(r=(screen.height-i)/2);var s="toolbar=0,location=0,directories=0,status=0,menubar=0,titlebar=0,scrollbars=1,resizable=0,top="+r+",left="+o+",width="+n+",height="+i;return window.open(t,'popup',s);});initializeMaps();$('img.unveil').unveil();$("#selectedAds").owlCarousel({items:4,scrollPerPage:true,navigation:true,navigationText:["",""],rewindNav:false});$("#selectedAds_missing").owlCarousel({items:4,scrollPerPage:true,navigation:true,pagination:false,navigationText:["",""],itemsDesktop:[1199,4],itemsDesktopSmall:[979,3],itemsTablet:[767,2],itemsTabletSmall:false,itemsMobile:[766,1],rewindNav:false});$('.fade').mosaic();var $fotoramaDiv=$('.fotorama').fotorama();var fotorama=$fotoramaDiv.data('fotorama');if(typeof fotorama!=='undefined'){$('#js-numberImages').text('1 / '+fotorama.size);$('.fotorama').on('fotorama:show fotorama:showend',function(e,fotorama,extra){$('#js-numberImages').text(fotorama.activeIndex+1+' / '+fotorama.size);});$('#js-mobileArrowRight').click(function(e){fotorama.show('>');});$('#js-mobileArrowLeft').click(function(e){fotorama.show('<');});}
showPhoneButton=$("#propertyListingButton");showPhoneLink=$("#realtorInfoLinks .iconPhone");propertyId=$("#ldPropertyId").attr("title");genericBaseUrl=$("#genericBaseUrl").attr("title");var content=new String($("#propertyListingCarousel div").html());if(content.match(/\S/)){$("#propertyListingCarousel").show();$("#propertyListingCarousel").tabs();}
var options={dataType:"json",target:"#spitogatosMessages",data:{"spFormat":true},beforeSubmit:function showRequest(formData,jqForm,options){if(!$("#fv_newsLetterConsentReq").fieldValue().length){var newValue=new Object();newValue.name="fv_newsLetterConsentReq";newValue.value="off";formData[formData.length]=newValue;}
if(!$("#fv_newsLetterConsentReqSidebar").fieldValue().length){var newValue=new Object();newValue.name="fv_newsLetterConsentReq";newValue.value="off";formData[formData.length]=newValue;}
else{var newValue=new Object();newValue.name="fv_newsLetterConsentReq";newValue.value="on";formData[formData.length]=newValue;}},success:afterSubmit};var optionsModalVR={dataType:"json",target:"#spitogatosMessages",data:{"spFormat":true},beforeSubmit:function showRequest(formData,jqForm,options){if(!$(".sgModal_form #fv_newsLetterConsentReq").fieldValue().length){var newValue=new Object();newValue.name="fv_newsLetterConsentReq";newValue.value="off";formData[formData.length]=newValue;}},success:function afterSubmitModalVR(response,statusText,xhr,$form){enableVisitSubmitButton();$('.refreshVisualCaptcha',$form).trigger('click');if(response.responseStatus&&(response.responseStatus==1||response.responseStatus=="1"))
{$(document).trigger("modalClose");if(response.data.origin!=false)
{if($("#fb_pixel_flag").text()=="1"){fbq('track','Lead',{value:3,currency:"EUR",content_category:"Primary",content_name:"Visit Request"});}
sgTrackGa({event:'event',category:'Visit_Request',action:response.data.origin});sgTrackGa({event:'event',category:'Visit_Request_Listing_Type',action:$('#googleAnalyticsVisitRequestListingTracking').attr('title')});}}}};$('#saveListingAction').on('click',function(){if(!$(this).hasClass('mySpitogatos_disabledLink')){sgTrackGa({event:'event',category:'Listing_action',action:'save_listing_sidebar'});}});$(document).on('click','.fbShareListingAction',function(event){event.preventDefault();sgTrackGa({event:'event',category:'Listing_action',action:'fb_share_listing_sidebar'});FB.ui({method:'share',href:$(this).attr('data-href')},function(response){if(response&&!response.error_code){sgTrackGa({event:'event',category:'Listing_action',action:'fb_share_listing_sidebar_submit'});}});});$(".visitRequestSubmitButtonDisabled").live("click",function(){return false;});$("a.visitSubmit:not(.visitRequestSubmitButtonDisabled)").live("click",function(event){event.preventDefault();event.stopImmediatePropagation();$(".visitRequestSubmit a.visitSubmit, .visitRequestSubmitSidebar a.visitSubmit").addClass("visitRequestSubmitButtonDisabled");$(".autoReset").each(function(){if($(this).val()==$(this).attr("title")){$(this).val("");}});if($(this).closest("form").hasClass("sgModal_form")){$(this).closest("form").ajaxSubmit(optionsModalVR);}
else{$(this).closest("form").ajaxSubmit(options);}
$(".autoReset").each(function(){if($(this).val()==""){$(this).val($(this).attr("title"));}});return false;});if(showPhoneButton.length){showPhoneButton.live("click",function(event){showPhone(propertyId,"property","button",genericBaseUrl);event.preventDefault();});}
if(showPhoneLink.length){showPhoneLink.live("click",function(event){showPhone(propertyId,"property","link",genericBaseUrl);event.preventDefault();});}
$("a.vr_phone").live("click",function(event){showPhone(propertyId,"vr_popup","link",genericBaseUrl);event.preventDefault();});if($("#propertyListingCarousel").length){$("#propertyListingCarousel .sgCarousel").sgCarousel().show();}
if($(".missingListing .sgCarousel").length){$(".missingListing .sgCarousel").sgCarousel().show();}
if($("#listingImagesList").length){$("#smallImageCarouselHolder .sgCarousel").sgCarousel({itemWidth:81}).show();$("a.listingSmallThumbnail").live("click",function(event){event.preventDefault();changeImageElement(this);});}else{$("#largeImage a").css("cursor","default").live("click",function(event){event.preventDefault();});}});$(window).load(function(){FB.Event.subscribe('edge.create',function(targetUrl){if(/listing/.test(targetUrl)&&/details/.test(targetUrl))
{if($(".fancybox-overlay").is(":visible"))
{sgTrackGa({event:'social',network:'facebook',action:'like',url:targetUrl+'-popup'});}
else
{sgTrackGa({event:'social',network:'facebook',action:'like',url:targetUrl+'-main'});}}});});;var app=angular.module('listingDetailsApp',[]);app.service('errorReportValidationService',function(){var self=this;this.errors=[];this.validate=function(scope){var fieldErrors=scope.fieldErrors||{};var description=scope.reportDescription||'';var fieldRole=scope.fieldRole.selectedOccurrence||'';var fieldRoleDescription=scope.fieldRoleDescription||'';var fieldReporterFirstname=scope.fieldReporterFirstname||'';var fieldReporterLastname=scope.fieldReporterLastname||'';var fieldReporterPhone=scope.fieldReporterPhone||'';var fieldReporterEmail=scope.fieldReporterEmail||'';var isFieldErrorValid=false;angular.forEach(fieldErrors,function(fieldError){if(fieldError){isFieldErrorValid=true;}});self.errors=[];if(angular.equals(isFieldErrorValid,false)&&angular.equals(scope.isVisible,true)){self.errors.push($("#error_noerror").text());}
if(angular.equals(description,'')&&angular.equals(scope.isVisible,true)){self.errors.push($("#error_description").text());}
if((angular.equals(fieldRole,'')||(angular.equals(fieldRole,'other')&&angular.equals(fieldRoleDescription,'')))&&angular.equals(scope.isVisible,false)){self.errors.push($("#error_role_empty").text());}
if(angular.equals(fieldReporterFirstname,'')&&angular.equals(scope.isVisible,false)){self.errors.push($("#error_firstname").text());}
if(angular.equals(fieldReporterLastname,'')&&angular.equals(scope.isVisible,false)){self.errors.push($("#error_lastname").text());}
if(angular.equals(fieldReporterPhone,'')&&angular.equals(scope.isVisible,false)){self.errors.push($("#error_phone").text());}
if(angular.equals(fieldReporterEmail,'')&&angular.equals(scope.isVisible,false)){self.errors.push($("#error_email").text());}
return self.errors;};});app.controller('errorReportController',['$scope','$http','errorReportValidationService',function($scope,$http,errorReportValidationService){$scope.isVisible=true;$scope.errorOptions=errorOptionsJsonEncoded;$scope.fieldErrors={};$scope.reportDescription='';$scope.errorRole=errorRoleJsonEncoded;$scope.fieldRole={};$scope.fieldRole.selectedOccurrence='enquirer';$scope.fieldRoleDescription='';$scope.fieldReporterFirstname=fieldReporterFirstnameVal;$scope.fieldReporterLastname=fieldReporterLastnameVal;$scope.fieldReporterPhone=fieldReporterPhoneVal;$scope.fieldReporterEmail=fieldReporterEmailVal;$scope.fieldPersonalData=false;$scope.fieldOrigin='modal';$scope.changePage=function(){var errors=errorReportValidationService.validate($scope);if(errors.length>0){$.each(errors,function(index,value){$.jGrowlError(value);});return false;}
$scope.isVisible=!$scope.isVisible;};}]);app.directive('errorOptionsView',function(){return{restrict:'E',templateUrl:$("#secureBaseUrl").attr("title")+'frontend/directives/errorReport/errorOptionsView.html',replace:true}});app.directive('errorRoleView',function(){return{restrict:'E',templateUrl:$("#secureBaseUrl").attr("title")+'frontend/directives/errorReport/errorRoleView.html',replace:true}});app.directive('sgModalPanelLink',function(){return{restrict:'C',link:function(scope,elem,attr){if(attr.ngClick){elem.on('click',function(e){e.preventDefault();});}}};});;var lang=document.getElementById("genericLanguage").getAttribute("title");var locale='el';if(lang!='gr'){locale='en';}
var __MAPS_SERVICES_CONFIG__={consumerKey:'spitogatos',attribution:'Spitogatos Network',env:'prod',language:locale,tilesUrlTemplate:'//maps{s}.a-cdn.net/tiles/spitogatos/{z}/{x}/{y}.png'};;(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(exports):typeof define==='function'&&define.amd?define(['exports'],factory):(factory((global['maps-migrate']={})));}(this,(function(exports){'use strict';function __$styleInject(css,returnValue){if(typeof document==='undefined'){return returnValue;}
css=css||'';var head=document.head||document.getElementsByTagName('head')[0];var style=document.createElement('style');style.type='text/css';head.appendChild(style);if(style.styleSheet){style.styleSheet.cssText=css;}else{style.appendChild(document.createTextNode(css));}
return returnValue;}
var _classCallCheck=(function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}});var _possibleConstructorReturn=(function(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}
return call&&(typeof call==="object"||typeof call==="function")?call:self;});var _inherits=(function(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}
subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;});var commonjsGlobal=typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{};function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports;}
var leafletSrc=createCommonjsModule(function(module){(function(window,document,undefined){var L={version:"1.0.3"};function expose(){var oldL=window.L;L.noConflict=function(){window.L=oldL;return this;};window.L=L;}
{module.exports=L;}
if(typeof window!=='undefined'){expose();}
L.Util={extend:function extend(dest){var i,j,len,src;for(j=1,len=arguments.length;j<len;j++){src=arguments[j];for(i in src){dest[i]=src[i];}}
return dest;},create:Object.create||function(){function F(){}
return function(proto){F.prototype=proto;return new F();};}(),bind:function bind(fn,obj){var slice=Array.prototype.slice;if(fn.bind){return fn.bind.apply(fn,slice.call(arguments,1));}
var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.length?args.concat(slice.call(arguments)):arguments);};},stamp:function stamp(obj){obj._leaflet_id=obj._leaflet_id||++L.Util.lastId;return obj._leaflet_id;},lastId:0,throttle:function throttle(fn,time,context){var lock,args,wrapperFn,later;later=function later(){lock=false;if(args){wrapperFn.apply(context,args);args=false;}};wrapperFn=function wrapperFn(){if(lock){args=arguments;}else{fn.apply(context,arguments);setTimeout(later,time);lock=true;}};return wrapperFn;},wrapNum:function wrapNum(x,range,includeMax){var max=range[1],min=range[0],d=max-min;return x===max&&includeMax?x:((x-min)%d+d)%d+min;},falseFn:function falseFn(){return false;},formatNum:function formatNum(num,digits){var pow=Math.pow(10,digits||5);return Math.round(num*pow)/pow;},trim:function trim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,'');},splitWords:function splitWords(str){return L.Util.trim(str).split(/\s+/);},setOptions:function setOptions(obj,options){if(!obj.hasOwnProperty('options')){obj.options=obj.options?L.Util.create(obj.options):{};}
for(var i in options){obj.options[i]=options[i];}
return obj.options;},getParamString:function getParamString(obj,existingUrl,uppercase){var params=[];for(var i in obj){params.push(encodeURIComponent(uppercase?i.toUpperCase():i)+'='+encodeURIComponent(obj[i]));}
return(!existingUrl||existingUrl.indexOf('?')===-1?'?':'&')+params.join('&');},template:function template(str,data){return str.replace(L.Util.templateRe,function(str,key){var value=data[key];if(value===undefined){throw new Error('No value provided for variable '+str);}else if(typeof value==='function'){value=value(data);}
return value;});},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(obj){return Object.prototype.toString.call(obj)==='[object Array]';},indexOf:function indexOf(array,el){for(var i=0;i<array.length;i++){if(array[i]===el){return i;}}
return-1;},emptyImageUrl:'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='};(function(){function getPrefixed(name){return window['webkit'+name]||window['moz'+name]||window['ms'+name];}
var lastTime=0;function timeoutDefer(fn){var time=+new Date(),timeToCall=Math.max(0,16-(time-lastTime));lastTime=time+timeToCall;return window.setTimeout(fn,timeToCall);}
var requestFn=window.requestAnimationFrame||getPrefixed('RequestAnimationFrame')||timeoutDefer,cancelFn=window.cancelAnimationFrame||getPrefixed('CancelAnimationFrame')||getPrefixed('CancelRequestAnimationFrame')||function(id){window.clearTimeout(id);};L.Util.requestAnimFrame=function(fn,context,immediate){if(immediate&&requestFn===timeoutDefer){fn.call(context);}else{return requestFn.call(window,L.bind(fn,context));}};L.Util.cancelAnimFrame=function(id){if(id){cancelFn.call(window,id);}};})();L.extend=L.Util.extend;L.bind=L.Util.bind;L.stamp=L.Util.stamp;L.setOptions=L.Util.setOptions;L.Class=function(){};L.Class.extend=function(props){var NewClass=function NewClass(){if(this.initialize){this.initialize.apply(this,arguments);}
this.callInitHooks();};var parentProto=NewClass.__super__=this.prototype;var proto=L.Util.create(parentProto);proto.constructor=NewClass;NewClass.prototype=proto;for(var i in this){if(this.hasOwnProperty(i)&&i!=='prototype'){NewClass[i]=this[i];}}
if(props.statics){L.extend(NewClass,props.statics);delete props.statics;}
if(props.includes){L.Util.extend.apply(null,[proto].concat(props.includes));delete props.includes;}
if(proto.options){props.options=L.Util.extend(L.Util.create(proto.options),props.options);}
L.extend(proto,props);proto._initHooks=[];proto.callInitHooks=function(){if(this._initHooksCalled){return;}
if(parentProto.callInitHooks){parentProto.callInitHooks.call(this);}
this._initHooksCalled=true;for(var i=0,len=proto._initHooks.length;i<len;i++){proto._initHooks[i].call(this);}};return NewClass;};L.Class.include=function(props){L.extend(this.prototype,props);return this;};L.Class.mergeOptions=function(options){L.extend(this.prototype.options,options);return this;};L.Class.addInitHook=function(fn){var args=Array.prototype.slice.call(arguments,1);var init=typeof fn==='function'?fn:function(){this[fn].apply(this,args);};this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push(init);return this;};L.Evented=L.Class.extend({on:function on(types,fn,context){if(typeof types==='object'){for(var type in types){this._on(type,types[type],fn);}}else{types=L.Util.splitWords(types);for(var i=0,len=types.length;i<len;i++){this._on(types[i],fn,context);}}
return this;},off:function off(types,fn,context){if(!types){delete this._events;}else if(typeof types==='object'){for(var type in types){this._off(type,types[type],fn);}}else{types=L.Util.splitWords(types);for(var i=0,len=types.length;i<len;i++){this._off(types[i],fn,context);}}
return this;},_on:function _on(type,fn,context){this._events=this._events||{};var typeListeners=this._events[type];if(!typeListeners){typeListeners=[];this._events[type]=typeListeners;}
if(context===this){context=undefined;}
var newListener={fn:fn,ctx:context},listeners=typeListeners;for(var i=0,len=listeners.length;i<len;i++){if(listeners[i].fn===fn&&listeners[i].ctx===context){return;}}
listeners.push(newListener);},_off:function _off(type,fn,context){var listeners,i,len;if(!this._events){return;}
listeners=this._events[type];if(!listeners){return;}
if(!fn){for(i=0,len=listeners.length;i<len;i++){listeners[i].fn=L.Util.falseFn;}
delete this._events[type];return;}
if(context===this){context=undefined;}
if(listeners){for(i=0,len=listeners.length;i<len;i++){var l=listeners[i];if(l.ctx!==context){continue;}
if(l.fn===fn){l.fn=L.Util.falseFn;if(this._firingCount){this._events[type]=listeners=listeners.slice();}
listeners.splice(i,1);return;}}}},fire:function fire(type,data,propagate){if(!this.listens(type,propagate)){return this;}
var event=L.Util.extend({},data,{type:type,target:this});if(this._events){var listeners=this._events[type];if(listeners){this._firingCount=this._firingCount+1||1;for(var i=0,len=listeners.length;i<len;i++){var l=listeners[i];l.fn.call(l.ctx||this,event);}
this._firingCount--;}}
if(propagate){this._propagateEvent(event);}
return this;},listens:function listens(type,propagate){var listeners=this._events&&this._events[type];if(listeners&&listeners.length){return true;}
if(propagate){for(var id in this._eventParents){if(this._eventParents[id].listens(type,propagate)){return true;}}}
return false;},once:function once(types,fn,context){if(typeof types==='object'){for(var type in types){this.once(type,types[type],fn);}
return this;}
var handler=L.bind(function(){this.off(types,fn,context).off(types,handler,context);},this);return this.on(types,fn,context).on(types,handler,context);},addEventParent:function addEventParent(obj){this._eventParents=this._eventParents||{};this._eventParents[L.stamp(obj)]=obj;return this;},removeEventParent:function removeEventParent(obj){if(this._eventParents){delete this._eventParents[L.stamp(obj)];}
return this;},_propagateEvent:function _propagateEvent(e){for(var id in this._eventParents){this._eventParents[id].fire(e.type,L.extend({layer:e.target},e),true);}}});var proto=L.Evented.prototype;proto.addEventListener=proto.on;proto.removeEventListener=proto.clearAllEventListeners=proto.off;proto.addOneTimeEventListener=proto.once;proto.fireEvent=proto.fire;proto.hasEventListeners=proto.listens;L.Mixin={Events:proto};(function(){var ua=navigator.userAgent.toLowerCase(),doc=document.documentElement,ie='ActiveXObject'in window,webkit=ua.indexOf('webkit')!==-1,phantomjs=ua.indexOf('phantom')!==-1,android23=ua.search('android [23]')!==-1,chrome=ua.indexOf('chrome')!==-1,gecko=ua.indexOf('gecko')!==-1&&!webkit&&!window.opera&&!ie,win=navigator.platform.indexOf('Win')===0,mobile=typeof orientation!=='undefined'||ua.indexOf('mobile')!==-1,msPointer=!window.PointerEvent&&window.MSPointerEvent,pointer=window.PointerEvent||msPointer,ie3d=ie&&'transition'in doc.style,webkit3d='WebKitCSSMatrix'in window&&'m11'in new window.WebKitCSSMatrix()&&!android23,gecko3d='MozPerspective'in doc.style,opera12='OTransition'in doc.style;var touch=!window.L_NO_TOUCH&&(pointer||'ontouchstart'in window||window.DocumentTouch&&document instanceof window.DocumentTouch);L.Browser={ie:ie,ielt9:ie&&!document.addEventListener,edge:'msLaunchUri'in navigator&&!('documentMode'in document),webkit:webkit,gecko:gecko,android:ua.indexOf('android')!==-1,android23:android23,chrome:chrome,safari:!chrome&&ua.indexOf('safari')!==-1,win:win,ie3d:ie3d,webkit3d:webkit3d,gecko3d:gecko3d,opera12:opera12,any3d:!window.L_DISABLE_3D&&(ie3d||webkit3d||gecko3d)&&!opera12&&!phantomjs,mobile:mobile,mobileWebkit:mobile&&webkit,mobileWebkit3d:mobile&&webkit3d,mobileOpera:mobile&&window.opera,mobileGecko:mobile&&gecko,touch:!!touch,msPointer:!!msPointer,pointer:!!pointer,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1};})();L.Point=function(x,y,round){this.x=round?Math.round(x):x;this.y=round?Math.round(y):y;};L.Point.prototype={clone:function clone(){return new L.Point(this.x,this.y);},add:function add(point){return this.clone()._add(L.point(point));},_add:function _add(point){this.x+=point.x;this.y+=point.y;return this;},subtract:function subtract(point){return this.clone()._subtract(L.point(point));},_subtract:function _subtract(point){this.x-=point.x;this.y-=point.y;return this;},divideBy:function divideBy(num){return this.clone()._divideBy(num);},_divideBy:function _divideBy(num){this.x/=num;this.y/=num;return this;},multiplyBy:function multiplyBy(num){return this.clone()._multiplyBy(num);},_multiplyBy:function _multiplyBy(num){this.x*=num;this.y*=num;return this;},scaleBy:function scaleBy(point){return new L.Point(this.x*point.x,this.y*point.y);},unscaleBy:function unscaleBy(point){return new L.Point(this.x/point.x,this.y/point.y);},round:function round(){return this.clone()._round();},_round:function _round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this;},floor:function floor(){return this.clone()._floor();},_floor:function _floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this;},ceil:function ceil(){return this.clone()._ceil();},_ceil:function _ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this;},distanceTo:function distanceTo(point){point=L.point(point);var x=point.x-this.x,y=point.y-this.y;return Math.sqrt(x*x+y*y);},equals:function equals(point){point=L.point(point);return point.x===this.x&&point.y===this.y;},contains:function contains(point){point=L.point(point);return Math.abs(point.x)<=Math.abs(this.x)&&Math.abs(point.y)<=Math.abs(this.y);},toString:function toString(){return'Point('+L.Util.formatNum(this.x)+', '+L.Util.formatNum(this.y)+')';}};L.point=function(x,y,round){if(x instanceof L.Point){return x;}
if(L.Util.isArray(x)){return new L.Point(x[0],x[1]);}
if(x===undefined||x===null){return x;}
if(typeof x==='object'&&'x'in x&&'y'in x){return new L.Point(x.x,x.y);}
return new L.Point(x,y,round);};L.Bounds=function(a,b){if(!a){return;}
var points=b?[a,b]:a;for(var i=0,len=points.length;i<len;i++){this.extend(points[i]);}};L.Bounds.prototype={extend:function extend(point){point=L.point(point);if(!this.min&&!this.max){this.min=point.clone();this.max=point.clone();}else{this.min.x=Math.min(point.x,this.min.x);this.max.x=Math.max(point.x,this.max.x);this.min.y=Math.min(point.y,this.min.y);this.max.y=Math.max(point.y,this.max.y);}
return this;},getCenter:function getCenter(round){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,round);},getBottomLeft:function getBottomLeft(){return new L.Point(this.min.x,this.max.y);},getTopRight:function getTopRight(){return new L.Point(this.max.x,this.min.y);},getSize:function getSize(){return this.max.subtract(this.min);},contains:function contains(obj){var min,max;if(typeof obj[0]==='number'||obj instanceof L.Point){obj=L.point(obj);}else{obj=L.bounds(obj);}
if(obj instanceof L.Bounds){min=obj.min;max=obj.max;}else{min=max=obj;}
return min.x>=this.min.x&&max.x<=this.max.x&&min.y>=this.min.y&&max.y<=this.max.y;},intersects:function intersects(bounds){bounds=L.bounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xIntersects=max2.x>=min.x&&min2.x<=max.x,yIntersects=max2.y>=min.y&&min2.y<=max.y;return xIntersects&&yIntersects;},overlaps:function overlaps(bounds){bounds=L.bounds(bounds);var min=this.min,max=this.max,min2=bounds.min,max2=bounds.max,xOverlaps=max2.x>min.x&&min2.x<max.x,yOverlaps=max2.y>min.y&&min2.y<max.y;return xOverlaps&&yOverlaps;},isValid:function isValid(){return!!(this.min&&this.max);}};L.bounds=function(a,b){if(!a||a instanceof L.Bounds){return a;}
return new L.Bounds(a,b);};L.Transformation=function(a,b,c,d){this._a=a;this._b=b;this._c=c;this._d=d;};L.Transformation.prototype={transform:function transform(point,scale){return this._transform(point.clone(),scale);},_transform:function _transform(point,scale){scale=scale||1;point.x=scale*(this._a*point.x+this._b);point.y=scale*(this._c*point.y+this._d);return point;},untransform:function untransform(point,scale){scale=scale||1;return new L.Point((point.x/scale-this._b)/this._a,(point.y/scale-this._d)/this._c);}};L.DomUtil={get:function get(id){return typeof id==='string'?document.getElementById(id):id;},getStyle:function getStyle(el,style){var value=el.style[style]||el.currentStyle&&el.currentStyle[style];if((!value||value==='auto')&&document.defaultView){var css=document.defaultView.getComputedStyle(el,null);value=css?css[style]:null;}
return value==='auto'?null:value;},create:function create(tagName,className,container){var el=document.createElement(tagName);el.className=className||'';if(container){container.appendChild(el);}
return el;},remove:function remove(el){var parent=el.parentNode;if(parent){parent.removeChild(el);}},empty:function empty(el){while(el.firstChild){el.removeChild(el.firstChild);}},toFront:function toFront(el){el.parentNode.appendChild(el);},toBack:function toBack(el){var parent=el.parentNode;parent.insertBefore(el,parent.firstChild);},hasClass:function hasClass(el,name){if(el.classList!==undefined){return el.classList.contains(name);}
var className=L.DomUtil.getClass(el);return className.length>0&&new RegExp('(^|\\s)'+name+'(\\s|$)').test(className);},addClass:function addClass(el,name){if(el.classList!==undefined){var classes=L.Util.splitWords(name);for(var i=0,len=classes.length;i<len;i++){el.classList.add(classes[i]);}}else if(!L.DomUtil.hasClass(el,name)){var className=L.DomUtil.getClass(el);L.DomUtil.setClass(el,(className?className+' ':'')+name);}},removeClass:function removeClass(el,name){if(el.classList!==undefined){el.classList.remove(name);}else{L.DomUtil.setClass(el,L.Util.trim((' '+L.DomUtil.getClass(el)+' ').replace(' '+name+' ',' ')));}},setClass:function setClass(el,name){if(el.className.baseVal===undefined){el.className=name;}else{el.className.baseVal=name;}},getClass:function getClass(el){return el.className.baseVal===undefined?el.className:el.className.baseVal;},setOpacity:function setOpacity(el,value){if('opacity'in el.style){el.style.opacity=value;}else if('filter'in el.style){L.DomUtil._setOpacityIE(el,value);}},_setOpacityIE:function _setOpacityIE(el,value){var filter=false,filterName='DXImageTransform.Microsoft.Alpha';try{filter=el.filters.item(filterName);}catch(e){if(value===1){return;}}
value=Math.round(value*100);if(filter){filter.Enabled=value!==100;filter.Opacity=value;}else{el.style.filter+=' progid:'+filterName+'(opacity='+value+')';}},testProp:function testProp(props){var style=document.documentElement.style;for(var i=0;i<props.length;i++){if(props[i]in style){return props[i];}}
return false;},setTransform:function setTransform(el,offset,scale){var pos=offset||new L.Point(0,0);el.style[L.DomUtil.TRANSFORM]=(L.Browser.ie3d?'translate('+pos.x+'px,'+pos.y+'px)':'translate3d('+pos.x+'px,'+pos.y+'px,0)')+(scale?' scale('+scale+')':'');},setPosition:function setPosition(el,point){el._leaflet_pos=point;if(L.Browser.any3d){L.DomUtil.setTransform(el,point);}else{el.style.left=point.x+'px';el.style.top=point.y+'px';}},getPosition:function getPosition(el){return el._leaflet_pos||new L.Point(0,0);}};(function(){L.DomUtil.TRANSFORM=L.DomUtil.testProp(['transform','WebkitTransform','OTransform','MozTransform','msTransform']);var transition=L.DomUtil.TRANSITION=L.DomUtil.testProp(['webkitTransition','transition','OTransition','MozTransition','msTransition']);L.DomUtil.TRANSITION_END=transition==='webkitTransition'||transition==='OTransition'?transition+'End':'transitionend';if('onselectstart'in document){L.DomUtil.disableTextSelection=function(){L.DomEvent.on(window,'selectstart',L.DomEvent.preventDefault);};L.DomUtil.enableTextSelection=function(){L.DomEvent.off(window,'selectstart',L.DomEvent.preventDefault);};}else{var userSelectProperty=L.DomUtil.testProp(['userSelect','WebkitUserSelect','OUserSelect','MozUserSelect','msUserSelect']);L.DomUtil.disableTextSelection=function(){if(userSelectProperty){var style=document.documentElement.style;this._userSelect=style[userSelectProperty];style[userSelectProperty]='none';}};L.DomUtil.enableTextSelection=function(){if(userSelectProperty){document.documentElement.style[userSelectProperty]=this._userSelect;delete this._userSelect;}};}
L.DomUtil.disableImageDrag=function(){L.DomEvent.on(window,'dragstart',L.DomEvent.preventDefault);};L.DomUtil.enableImageDrag=function(){L.DomEvent.off(window,'dragstart',L.DomEvent.preventDefault);};L.DomUtil.preventOutline=function(element){while(element.tabIndex===-1){element=element.parentNode;}
if(!element||!element.style){return;}
L.DomUtil.restoreOutline();this._outlineElement=element;this._outlineStyle=element.style.outline;element.style.outline='none';L.DomEvent.on(window,'keydown',L.DomUtil.restoreOutline,this);};L.DomUtil.restoreOutline=function(){if(!this._outlineElement){return;}
this._outlineElement.style.outline=this._outlineStyle;delete this._outlineElement;delete this._outlineStyle;L.DomEvent.off(window,'keydown',L.DomUtil.restoreOutline,this);};})();L.LatLng=function(lat,lng,alt){if(isNaN(lat)||isNaN(lng)){throw new Error('Invalid LatLng object: ('+lat+', '+lng+')');}
this.lat=+lat;this.lng=+lng;if(alt!==undefined){this.alt=+alt;}};L.LatLng.prototype={equals:function equals(obj,maxMargin){if(!obj){return false;}
obj=L.latLng(obj);var margin=Math.max(Math.abs(this.lat-obj.lat),Math.abs(this.lng-obj.lng));return margin<=(maxMargin===undefined?1.0E-9:maxMargin);},toString:function toString(precision){return'LatLng('+L.Util.formatNum(this.lat,precision)+', '+L.Util.formatNum(this.lng,precision)+')';},distanceTo:function distanceTo(other){return L.CRS.Earth.distance(this,L.latLng(other));},wrap:function wrap(){return L.CRS.Earth.wrapLatLng(this);},toBounds:function toBounds(sizeInMeters){var latAccuracy=180*sizeInMeters/40075017,lngAccuracy=latAccuracy/Math.cos(Math.PI/180*this.lat);return L.latLngBounds([this.lat-latAccuracy,this.lng-lngAccuracy],[this.lat+latAccuracy,this.lng+lngAccuracy]);},clone:function clone(){return new L.LatLng(this.lat,this.lng,this.alt);}};L.latLng=function(a,b,c){if(a instanceof L.LatLng){return a;}
if(L.Util.isArray(a)&&typeof a[0]!=='object'){if(a.length===3){return new L.LatLng(a[0],a[1],a[2]);}
if(a.length===2){return new L.LatLng(a[0],a[1]);}
return null;}
if(a===undefined||a===null){return a;}
if(typeof a==='object'&&'lat'in a){return new L.LatLng(a.lat,'lng'in a?a.lng:a.lon,a.alt);}
if(b===undefined){return null;}
return new L.LatLng(a,b,c);};L.LatLngBounds=function(corner1,corner2){if(!corner1){return;}
var latlngs=corner2?[corner1,corner2]:corner1;for(var i=0,len=latlngs.length;i<len;i++){this.extend(latlngs[i]);}};L.LatLngBounds.prototype={extend:function extend(obj){var sw=this._southWest,ne=this._northEast,sw2,ne2;if(obj instanceof L.LatLng){sw2=obj;ne2=obj;}else if(obj instanceof L.LatLngBounds){sw2=obj._southWest;ne2=obj._northEast;if(!sw2||!ne2){return this;}}else{return obj?this.extend(L.latLng(obj)||L.latLngBounds(obj)):this;}
if(!sw&&!ne){this._southWest=new L.LatLng(sw2.lat,sw2.lng);this._northEast=new L.LatLng(ne2.lat,ne2.lng);}else{sw.lat=Math.min(sw2.lat,sw.lat);sw.lng=Math.min(sw2.lng,sw.lng);ne.lat=Math.max(ne2.lat,ne.lat);ne.lng=Math.max(ne2.lng,ne.lng);}
return this;},pad:function pad(bufferRatio){var sw=this._southWest,ne=this._northEast,heightBuffer=Math.abs(sw.lat-ne.lat)*bufferRatio,widthBuffer=Math.abs(sw.lng-ne.lng)*bufferRatio;return new L.LatLngBounds(new L.LatLng(sw.lat-heightBuffer,sw.lng-widthBuffer),new L.LatLng(ne.lat+heightBuffer,ne.lng+widthBuffer));},getCenter:function getCenter(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2);},getSouthWest:function getSouthWest(){return this._southWest;},getNorthEast:function getNorthEast(){return this._northEast;},getNorthWest:function getNorthWest(){return new L.LatLng(this.getNorth(),this.getWest());},getSouthEast:function getSouthEast(){return new L.LatLng(this.getSouth(),this.getEast());},getWest:function getWest(){return this._southWest.lng;},getSouth:function getSouth(){return this._southWest.lat;},getEast:function getEast(){return this._northEast.lng;},getNorth:function getNorth(){return this._northEast.lat;},contains:function contains(obj){if(typeof obj[0]==='number'||obj instanceof L.LatLng||'lat'in obj){obj=L.latLng(obj);}else{obj=L.latLngBounds(obj);}
var sw=this._southWest,ne=this._northEast,sw2,ne2;if(obj instanceof L.LatLngBounds){sw2=obj.getSouthWest();ne2=obj.getNorthEast();}else{sw2=ne2=obj;}
return sw2.lat>=sw.lat&&ne2.lat<=ne.lat&&sw2.lng>=sw.lng&&ne2.lng<=ne.lng;},intersects:function intersects(bounds){bounds=L.latLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latIntersects=ne2.lat>=sw.lat&&sw2.lat<=ne.lat,lngIntersects=ne2.lng>=sw.lng&&sw2.lng<=ne.lng;return latIntersects&&lngIntersects;},overlaps:function overlaps(bounds){bounds=L.latLngBounds(bounds);var sw=this._southWest,ne=this._northEast,sw2=bounds.getSouthWest(),ne2=bounds.getNorthEast(),latOverlaps=ne2.lat>sw.lat&&sw2.lat<ne.lat,lngOverlaps=ne2.lng>sw.lng&&sw2.lng<ne.lng;return latOverlaps&&lngOverlaps;},toBBoxString:function toBBoxString(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(',');},equals:function equals(bounds){if(!bounds){return false;}
bounds=L.latLngBounds(bounds);return this._southWest.equals(bounds.getSouthWest())&&this._northEast.equals(bounds.getNorthEast());},isValid:function isValid(){return!!(this._southWest&&this._northEast);}};L.latLngBounds=function(a,b){if(a instanceof L.LatLngBounds){return a;}
return new L.LatLngBounds(a,b);};L.Projection={};L.Projection.LonLat={project:function project(latlng){return new L.Point(latlng.lng,latlng.lat);},unproject:function unproject(point){return new L.LatLng(point.y,point.x);},bounds:L.bounds([-180,-90],[180,90])};L.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function project(latlng){var d=Math.PI/180,max=this.MAX_LATITUDE,lat=Math.max(Math.min(max,latlng.lat),-max),sin=Math.sin(lat*d);return new L.Point(this.R*latlng.lng*d,this.R*Math.log((1+sin)/(1-sin))/2);},unproject:function unproject(point){var d=180/Math.PI;return new L.LatLng((2*Math.atan(Math.exp(point.y/this.R))-Math.PI/2)*d,point.x*d/this.R);},bounds:function(){var d=6378137*Math.PI;return L.bounds([-d,-d],[d,d]);}()};L.CRS={latLngToPoint:function latLngToPoint(latlng,zoom){var projectedPoint=this.projection.project(latlng),scale=this.scale(zoom);return this.transformation._transform(projectedPoint,scale);},pointToLatLng:function pointToLatLng(point,zoom){var scale=this.scale(zoom),untransformedPoint=this.transformation.untransform(point,scale);return this.projection.unproject(untransformedPoint);},project:function project(latlng){return this.projection.project(latlng);},unproject:function unproject(point){return this.projection.unproject(point);},scale:function scale(zoom){return 256*Math.pow(2,zoom);},zoom:function zoom(scale){return Math.log(scale/256)/Math.LN2;},getProjectedBounds:function getProjectedBounds(zoom){if(this.infinite){return null;}
var b=this.projection.bounds,s=this.scale(zoom),min=this.transformation.transform(b.min,s),max=this.transformation.transform(b.max,s);return L.bounds(min,max);},infinite:false,wrapLatLng:function wrapLatLng(latlng){var lng=this.wrapLng?L.Util.wrapNum(latlng.lng,this.wrapLng,true):latlng.lng,lat=this.wrapLat?L.Util.wrapNum(latlng.lat,this.wrapLat,true):latlng.lat,alt=latlng.alt;return L.latLng(lat,lng,alt);},wrapLatLngBounds:function wrapLatLngBounds(bounds){var center=bounds.getCenter(),newCenter=this.wrapLatLng(center),latShift=center.lat-newCenter.lat,lngShift=center.lng-newCenter.lng;if(latShift===0&&lngShift===0){return bounds;}
var sw=bounds.getSouthWest(),ne=bounds.getNorthEast(),newSw=L.latLng({lat:sw.lat-latShift,lng:sw.lng-lngShift}),newNe=L.latLng({lat:ne.lat-latShift,lng:ne.lng-lngShift});return new L.LatLngBounds(newSw,newNe);}};L.CRS.Simple=L.extend({},L.CRS,{projection:L.Projection.LonLat,transformation:new L.Transformation(1,0,-1,0),scale:function scale(zoom){return Math.pow(2,zoom);},zoom:function zoom(scale){return Math.log(scale)/Math.LN2;},distance:function distance(latlng1,latlng2){var dx=latlng2.lng-latlng1.lng,dy=latlng2.lat-latlng1.lat;return Math.sqrt(dx*dx+dy*dy);},infinite:true});L.CRS.Earth=L.extend({},L.CRS,{wrapLng:[-180,180],R:6371000,distance:function distance(latlng1,latlng2){var rad=Math.PI/180,lat1=latlng1.lat*rad,lat2=latlng2.lat*rad,a=Math.sin(lat1)*Math.sin(lat2)+Math.cos(lat1)*Math.cos(lat2)*Math.cos((latlng2.lng-latlng1.lng)*rad);return this.R*Math.acos(Math.min(a,1));}});L.CRS.EPSG3857=L.extend({},L.CRS.Earth,{code:'EPSG:3857',projection:L.Projection.SphericalMercator,transformation:function(){var scale=0.5/(Math.PI*L.Projection.SphericalMercator.R);return new L.Transformation(scale,0.5,-scale,0.5);}()});L.CRS.EPSG900913=L.extend({},L.CRS.EPSG3857,{code:'EPSG:900913'});L.CRS.EPSG4326=L.extend({},L.CRS.Earth,{code:'EPSG:4326',projection:L.Projection.LonLat,transformation:new L.Transformation(1/180,1,-1/180,0.5)});L.Map=L.Evented.extend({options:{crs:L.CRS.EPSG3857,center:undefined,zoom:undefined,minZoom:undefined,maxZoom:undefined,layers:[],maxBounds:undefined,renderer:undefined,zoomAnimation:true,zoomAnimationThreshold:4,fadeAnimation:true,markerZoomAnimation:true,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:true},initialize:function initialize(id,options){options=L.setOptions(this,options);this._initContainer(id);this._initLayout();this._onResize=L.bind(this._onResize,this);this._initEvents();if(options.maxBounds){this.setMaxBounds(options.maxBounds);}
if(options.zoom!==undefined){this._zoom=this._limitZoom(options.zoom);}
if(options.center&&options.zoom!==undefined){this.setView(L.latLng(options.center),options.zoom,{reset:true});}
this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=true;this.callInitHooks();this._zoomAnimated=L.DomUtil.TRANSITION&&L.Browser.any3d&&!L.Browser.mobileOpera&&this.options.zoomAnimation;if(this._zoomAnimated){this._createAnimProxy();L.DomEvent.on(this._proxy,L.DomUtil.TRANSITION_END,this._catchTransitionEnd,this);}
this._addLayers(this.options.layers);},setView:function setView(center,zoom,options){zoom=zoom===undefined?this._zoom:this._limitZoom(zoom);center=this._limitCenter(L.latLng(center),zoom,this.options.maxBounds);options=options||{};this._stop();if(this._loaded&&!options.reset&&options!==true){if(options.animate!==undefined){options.zoom=L.extend({animate:options.animate},options.zoom);options.pan=L.extend({animate:options.animate,duration:options.duration},options.pan);}
var moved=this._zoom!==zoom?this._tryAnimatedZoom&&this._tryAnimatedZoom(center,zoom,options.zoom):this._tryAnimatedPan(center,options.pan);if(moved){clearTimeout(this._sizeTimer);return this;}}
this._resetView(center,zoom);return this;},setZoom:function setZoom(zoom,options){if(!this._loaded){this._zoom=zoom;return this;}
return this.setView(this.getCenter(),zoom,{zoom:options});},zoomIn:function zoomIn(delta,options){delta=delta||(L.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom+delta,options);},zoomOut:function zoomOut(delta,options){delta=delta||(L.Browser.any3d?this.options.zoomDelta:1);return this.setZoom(this._zoom-delta,options);},setZoomAround:function setZoomAround(latlng,zoom,options){var scale=this.getZoomScale(zoom),viewHalf=this.getSize().divideBy(2),containerPoint=latlng instanceof L.Point?latlng:this.latLngToContainerPoint(latlng),centerOffset=containerPoint.subtract(viewHalf).multiplyBy(1-1/scale),newCenter=this.containerPointToLatLng(viewHalf.add(centerOffset));return this.setView(newCenter,zoom,{zoom:options});},_getBoundsCenterZoom:function _getBoundsCenterZoom(bounds,options){options=options||{};bounds=bounds.getBounds?bounds.getBounds():L.latLngBounds(bounds);var paddingTL=L.point(options.paddingTopLeft||options.padding||[0,0]),paddingBR=L.point(options.paddingBottomRight||options.padding||[0,0]),zoom=this.getBoundsZoom(bounds,false,paddingTL.add(paddingBR));zoom=typeof options.maxZoom==='number'?Math.min(options.maxZoom,zoom):zoom;var paddingOffset=paddingBR.subtract(paddingTL).divideBy(2),swPoint=this.project(bounds.getSouthWest(),zoom),nePoint=this.project(bounds.getNorthEast(),zoom),center=this.unproject(swPoint.add(nePoint).divideBy(2).add(paddingOffset),zoom);return{center:center,zoom:zoom};},fitBounds:function fitBounds(bounds,options){bounds=L.latLngBounds(bounds);if(!bounds.isValid()){throw new Error('Bounds are not valid.');}
var target=this._getBoundsCenterZoom(bounds,options);return this.setView(target.center,target.zoom,options);},fitWorld:function fitWorld(options){return this.fitBounds([[-90,-180],[90,180]],options);},panTo:function panTo(center,options){return this.setView(center,this._zoom,{pan:options});},panBy:function panBy(offset,options){offset=L.point(offset).round();options=options||{};if(!offset.x&&!offset.y){return this.fire('moveend');}
if(options.animate!==true&&!this.getSize().contains(offset)){this._resetView(this.unproject(this.project(this.getCenter()).add(offset)),this.getZoom());return this;}
if(!this._panAnim){this._panAnim=new L.PosAnimation();this._panAnim.on({'step':this._onPanTransitionStep,'end':this._onPanTransitionEnd},this);}
if(!options.noMoveStart){this.fire('movestart');}
if(options.animate!==false){L.DomUtil.addClass(this._mapPane,'leaflet-pan-anim');var newPos=this._getMapPanePos().subtract(offset).round();this._panAnim.run(this._mapPane,newPos,options.duration||0.25,options.easeLinearity);}else{this._rawPanBy(offset);this.fire('move').fire('moveend');}
return this;},flyTo:function flyTo(targetCenter,targetZoom,options){options=options||{};if(options.animate===false||!L.Browser.any3d){return this.setView(targetCenter,targetZoom,options);}
this._stop();var from=this.project(this.getCenter()),to=this.project(targetCenter),size=this.getSize(),startZoom=this._zoom;targetCenter=L.latLng(targetCenter);targetZoom=targetZoom===undefined?startZoom:targetZoom;var w0=Math.max(size.x,size.y),w1=w0*this.getZoomScale(startZoom,targetZoom),u1=to.distanceTo(from)||1,rho=1.42,rho2=rho*rho;function r(i){var s1=i?-1:1,s2=i?w1:w0,t1=w1*w1-w0*w0+s1*rho2*rho2*u1*u1,b1=2*s2*rho2*u1,b=t1/b1,sq=Math.sqrt(b*b+1)-b;var log=sq<0.000000001?-18:Math.log(sq);return log;}
function sinh(n){return(Math.exp(n)-Math.exp(-n))/2;}
function cosh(n){return(Math.exp(n)+Math.exp(-n))/2;}
function tanh(n){return sinh(n)/cosh(n);}
var r0=r(0);function w(s){return w0*(cosh(r0)/cosh(r0+rho*s));}
function u(s){return w0*(cosh(r0)*tanh(r0+rho*s)-sinh(r0))/rho2;}
function easeOut(t){return 1-Math.pow(1-t,1.5);}
var start=Date.now(),S=(r(1)-r0)/rho,duration=options.duration?1000*options.duration:1000*S*0.8;function frame(){var t=(Date.now()-start)/duration,s=easeOut(t)*S;if(t<=1){this._flyToFrame=L.Util.requestAnimFrame(frame,this);this._move(this.unproject(from.add(to.subtract(from).multiplyBy(u(s)/u1)),startZoom),this.getScaleZoom(w0/w(s),startZoom),{flyTo:true});}else{this._move(targetCenter,targetZoom)._moveEnd(true);}}
this._moveStart(true);frame.call(this);return this;},flyToBounds:function flyToBounds(bounds,options){var target=this._getBoundsCenterZoom(bounds,options);return this.flyTo(target.center,target.zoom,options);},setMaxBounds:function setMaxBounds(bounds){bounds=L.latLngBounds(bounds);if(!bounds.isValid()){this.options.maxBounds=null;return this.off('moveend',this._panInsideMaxBounds);}else if(this.options.maxBounds){this.off('moveend',this._panInsideMaxBounds);}
this.options.maxBounds=bounds;if(this._loaded){this._panInsideMaxBounds();}
return this.on('moveend',this._panInsideMaxBounds);},setMinZoom:function setMinZoom(zoom){this.options.minZoom=zoom;if(this._loaded&&this.getZoom()<this.options.minZoom){return this.setZoom(zoom);}
return this;},setMaxZoom:function setMaxZoom(zoom){this.options.maxZoom=zoom;if(this._loaded&&this.getZoom()>this.options.maxZoom){return this.setZoom(zoom);}
return this;},panInsideBounds:function panInsideBounds(bounds,options){this._enforcingBounds=true;var center=this.getCenter(),newCenter=this._limitCenter(center,this._zoom,L.latLngBounds(bounds));if(!center.equals(newCenter)){this.panTo(newCenter,options);}
this._enforcingBounds=false;return this;},invalidateSize:function invalidateSize(options){if(!this._loaded){return this;}
options=L.extend({animate:false,pan:true},options===true?{animate:true}:options);var oldSize=this.getSize();this._sizeChanged=true;this._lastCenter=null;var newSize=this.getSize(),oldCenter=oldSize.divideBy(2).round(),newCenter=newSize.divideBy(2).round(),offset=oldCenter.subtract(newCenter);if(!offset.x&&!offset.y){return this;}
if(options.animate&&options.pan){this.panBy(offset);}else{if(options.pan){this._rawPanBy(offset);}
this.fire('move');if(options.debounceMoveend){clearTimeout(this._sizeTimer);this._sizeTimer=setTimeout(L.bind(this.fire,this,'moveend'),200);}else{this.fire('moveend');}}
return this.fire('resize',{oldSize:oldSize,newSize:newSize});},stop:function stop(){this.setZoom(this._limitZoom(this._zoom));if(!this.options.zoomSnap){this.fire('viewreset');}
return this._stop();},locate:function locate(options){options=this._locateOptions=L.extend({timeout:10000,watch:false},options);if(!('geolocation'in navigator)){this._handleGeolocationError({code:0,message:'Geolocation not supported.'});return this;}
var onResponse=L.bind(this._handleGeolocationResponse,this),onError=L.bind(this._handleGeolocationError,this);if(options.watch){this._locationWatchId=navigator.geolocation.watchPosition(onResponse,onError,options);}else{navigator.geolocation.getCurrentPosition(onResponse,onError,options);}
return this;},stopLocate:function stopLocate(){if(navigator.geolocation&&navigator.geolocation.clearWatch){navigator.geolocation.clearWatch(this._locationWatchId);}
if(this._locateOptions){this._locateOptions.setView=false;}
return this;},_handleGeolocationError:function _handleGeolocationError(error){var c=error.code,message=error.message||(c===1?'permission denied':c===2?'position unavailable':'timeout');if(this._locateOptions.setView&&!this._loaded){this.fitWorld();}
this.fire('locationerror',{code:c,message:'Geolocation error: '+message+'.'});},_handleGeolocationResponse:function _handleGeolocationResponse(pos){var lat=pos.coords.latitude,lng=pos.coords.longitude,latlng=new L.LatLng(lat,lng),bounds=latlng.toBounds(pos.coords.accuracy),options=this._locateOptions;if(options.setView){var zoom=this.getBoundsZoom(bounds);this.setView(latlng,options.maxZoom?Math.min(zoom,options.maxZoom):zoom);}
var data={latlng:latlng,bounds:bounds,timestamp:pos.timestamp};for(var i in pos.coords){if(typeof pos.coords[i]==='number'){data[i]=pos.coords[i];}}
this.fire('locationfound',data);},addHandler:function addHandler(name,HandlerClass){if(!HandlerClass){return this;}
var handler=this[name]=new HandlerClass(this);this._handlers.push(handler);if(this.options[name]){handler.enable();}
return this;},remove:function remove(){this._initEvents(true);if(this._containerId!==this._container._leaflet_id){throw new Error('Map container is being reused by another instance');}
try{delete this._container._leaflet_id;delete this._containerId;}catch(e){this._container._leaflet_id=undefined;this._containerId=undefined;}
L.DomUtil.remove(this._mapPane);if(this._clearControlPos){this._clearControlPos();}
this._clearHandlers();if(this._loaded){this.fire('unload');}
for(var i in this._layers){this._layers[i].remove();}
return this;},createPane:function createPane(name,container){var className='leaflet-pane'+(name?' leaflet-'+name.replace('Pane','')+'-pane':''),pane=L.DomUtil.create('div',className,container||this._mapPane);if(name){this._panes[name]=pane;}
return pane;},getCenter:function getCenter(){this._checkIfLoaded();if(this._lastCenter&&!this._moved()){return this._lastCenter;}
return this.layerPointToLatLng(this._getCenterLayerPoint());},getZoom:function getZoom(){return this._zoom;},getBounds:function getBounds(){var bounds=this.getPixelBounds(),sw=this.unproject(bounds.getBottomLeft()),ne=this.unproject(bounds.getTopRight());return new L.LatLngBounds(sw,ne);},getMinZoom:function getMinZoom(){return this.options.minZoom===undefined?this._layersMinZoom||0:this.options.minZoom;},getMaxZoom:function getMaxZoom(){return this.options.maxZoom===undefined?this._layersMaxZoom===undefined?Infinity:this._layersMaxZoom:this.options.maxZoom;},getBoundsZoom:function getBoundsZoom(bounds,inside,padding){bounds=L.latLngBounds(bounds);padding=L.point(padding||[0,0]);var zoom=this.getZoom()||0,min=this.getMinZoom(),max=this.getMaxZoom(),nw=bounds.getNorthWest(),se=bounds.getSouthEast(),size=this.getSize().subtract(padding),boundsSize=L.bounds(this.project(se,zoom),this.project(nw,zoom)).getSize(),snap=L.Browser.any3d?this.options.zoomSnap:1;var scale=Math.min(size.x/boundsSize.x,size.y/boundsSize.y);zoom=this.getScaleZoom(scale,zoom);if(snap){zoom=Math.round(zoom/(snap/100))*(snap/100);zoom=inside?Math.ceil(zoom/snap)*snap:Math.floor(zoom/snap)*snap;}
return Math.max(min,Math.min(max,zoom));},getSize:function getSize(){if(!this._size||this._sizeChanged){this._size=new L.Point(this._container.clientWidth||0,this._container.clientHeight||0);this._sizeChanged=false;}
return this._size.clone();},getPixelBounds:function getPixelBounds(center,zoom){var topLeftPoint=this._getTopLeftPoint(center,zoom);return new L.Bounds(topLeftPoint,topLeftPoint.add(this.getSize()));},getPixelOrigin:function getPixelOrigin(){this._checkIfLoaded();return this._pixelOrigin;},getPixelWorldBounds:function getPixelWorldBounds(zoom){return this.options.crs.getProjectedBounds(zoom===undefined?this.getZoom():zoom);},getPane:function getPane(pane){return typeof pane==='string'?this._panes[pane]:pane;},getPanes:function getPanes(){return this._panes;},getContainer:function getContainer(){return this._container;},getZoomScale:function getZoomScale(toZoom,fromZoom){var crs=this.options.crs;fromZoom=fromZoom===undefined?this._zoom:fromZoom;return crs.scale(toZoom)/crs.scale(fromZoom);},getScaleZoom:function getScaleZoom(scale,fromZoom){var crs=this.options.crs;fromZoom=fromZoom===undefined?this._zoom:fromZoom;var zoom=crs.zoom(scale*crs.scale(fromZoom));return isNaN(zoom)?Infinity:zoom;},project:function project(latlng,zoom){zoom=zoom===undefined?this._zoom:zoom;return this.options.crs.latLngToPoint(L.latLng(latlng),zoom);},unproject:function unproject(point,zoom){zoom=zoom===undefined?this._zoom:zoom;return this.options.crs.pointToLatLng(L.point(point),zoom);},layerPointToLatLng:function layerPointToLatLng(point){var projectedPoint=L.point(point).add(this.getPixelOrigin());return this.unproject(projectedPoint);},latLngToLayerPoint:function latLngToLayerPoint(latlng){var projectedPoint=this.project(L.latLng(latlng))._round();return projectedPoint._subtract(this.getPixelOrigin());},wrapLatLng:function wrapLatLng(latlng){return this.options.crs.wrapLatLng(L.latLng(latlng));},wrapLatLngBounds:function wrapLatLngBounds(latlng){return this.options.crs.wrapLatLngBounds(L.latLngBounds(latlng));},distance:function distance(latlng1,latlng2){return this.options.crs.distance(L.latLng(latlng1),L.latLng(latlng2));},containerPointToLayerPoint:function containerPointToLayerPoint(point){return L.point(point).subtract(this._getMapPanePos());},layerPointToContainerPoint:function layerPointToContainerPoint(point){return L.point(point).add(this._getMapPanePos());},containerPointToLatLng:function containerPointToLatLng(point){var layerPoint=this.containerPointToLayerPoint(L.point(point));return this.layerPointToLatLng(layerPoint);},latLngToContainerPoint:function latLngToContainerPoint(latlng){return this.layerPointToContainerPoint(this.latLngToLayerPoint(L.latLng(latlng)));},mouseEventToContainerPoint:function mouseEventToContainerPoint(e){return L.DomEvent.getMousePosition(e,this._container);},mouseEventToLayerPoint:function mouseEventToLayerPoint(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e));},mouseEventToLatLng:function mouseEventToLatLng(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e));},_initContainer:function _initContainer(id){var container=this._container=L.DomUtil.get(id);if(!container){throw new Error('Map container not found.');}else if(container._leaflet_id){throw new Error('Map container is already initialized.');}
L.DomEvent.addListener(container,'scroll',this._onScroll,this);this._containerId=L.Util.stamp(container);},_initLayout:function _initLayout(){var container=this._container;this._fadeAnimated=this.options.fadeAnimation&&L.Browser.any3d;L.DomUtil.addClass(container,'leaflet-container'+(L.Browser.touch?' leaflet-touch':'')+(L.Browser.retina?' leaflet-retina':'')+(L.Browser.ielt9?' leaflet-oldie':'')+(L.Browser.safari?' leaflet-safari':'')+(this._fadeAnimated?' leaflet-fade-anim':''));var position=L.DomUtil.getStyle(container,'position');if(position!=='absolute'&&position!=='relative'&&position!=='fixed'){container.style.position='relative';}
this._initPanes();if(this._initControlPos){this._initControlPos();}},_initPanes:function _initPanes(){var panes=this._panes={};this._paneRenderers={};this._mapPane=this.createPane('mapPane',this._container);L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));this.createPane('tilePane');this.createPane('shadowPane');this.createPane('overlayPane');this.createPane('markerPane');this.createPane('tooltipPane');this.createPane('popupPane');if(!this.options.markerZoomAnimation){L.DomUtil.addClass(panes.markerPane,'leaflet-zoom-hide');L.DomUtil.addClass(panes.shadowPane,'leaflet-zoom-hide');}},_resetView:function _resetView(center,zoom){L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));var loading=!this._loaded;this._loaded=true;zoom=this._limitZoom(zoom);this.fire('viewprereset');var zoomChanged=this._zoom!==zoom;this._moveStart(zoomChanged)._move(center,zoom)._moveEnd(zoomChanged);this.fire('viewreset');if(loading){this.fire('load');}},_moveStart:function _moveStart(zoomChanged){if(zoomChanged){this.fire('zoomstart');}
return this.fire('movestart');},_move:function _move(center,zoom,data){if(zoom===undefined){zoom=this._zoom;}
var zoomChanged=this._zoom!==zoom;this._zoom=zoom;this._lastCenter=center;this._pixelOrigin=this._getNewPixelOrigin(center);if(zoomChanged||data&&data.pinch){this.fire('zoom',data);}
return this.fire('move',data);},_moveEnd:function _moveEnd(zoomChanged){if(zoomChanged){this.fire('zoomend');}
return this.fire('moveend');},_stop:function _stop(){L.Util.cancelAnimFrame(this._flyToFrame);if(this._panAnim){this._panAnim.stop();}
return this;},_rawPanBy:function _rawPanBy(offset){L.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(offset));},_getZoomSpan:function _getZoomSpan(){return this.getMaxZoom()-this.getMinZoom();},_panInsideMaxBounds:function _panInsideMaxBounds(){if(!this._enforcingBounds){this.panInsideBounds(this.options.maxBounds);}},_checkIfLoaded:function _checkIfLoaded(){if(!this._loaded){throw new Error('Set map center and zoom first.');}},_initEvents:function _initEvents(remove){if(!L.DomEvent){return;}
this._targets={};this._targets[L.stamp(this._container)]=this;var onOff=remove?'off':'on';L.DomEvent[onOff](this._container,'click dblclick mousedown mouseup '+'mouseover mouseout mousemove contextmenu keypress',this._handleDOMEvent,this);if(this.options.trackResize){L.DomEvent[onOff](window,'resize',this._onResize,this);}
if(L.Browser.any3d&&this.options.transform3DLimit){this[onOff]('moveend',this._onMoveEnd);}},_onResize:function _onResize(){L.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=L.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:true});},this);},_onScroll:function _onScroll(){this._container.scrollTop=0;this._container.scrollLeft=0;},_onMoveEnd:function _onMoveEnd(){var pos=this._getMapPanePos();if(Math.max(Math.abs(pos.x),Math.abs(pos.y))>=this.options.transform3DLimit){this._resetView(this.getCenter(),this.getZoom());}},_findEventTargets:function _findEventTargets(e,type){var targets=[],target,isHover=type==='mouseout'||type==='mouseover',src=e.target||e.srcElement,dragging=false;while(src){target=this._targets[L.stamp(src)];if(target&&(type==='click'||type==='preclick')&&!e._simulated&&this._draggableMoved(target)){dragging=true;break;}
if(target&&target.listens(type,true)){if(isHover&&!L.DomEvent._isExternalTarget(src,e)){break;}
targets.push(target);if(isHover){break;}}
if(src===this._container){break;}
src=src.parentNode;}
if(!targets.length&&!dragging&&!isHover&&L.DomEvent._isExternalTarget(src,e)){targets=[this];}
return targets;},_handleDOMEvent:function _handleDOMEvent(e){if(!this._loaded||L.DomEvent._skipped(e)){return;}
var type=e.type==='keypress'&&e.keyCode===13?'click':e.type;if(type==='mousedown'){L.DomUtil.preventOutline(e.target||e.srcElement);}
this._fireDOMEvent(e,type);},_fireDOMEvent:function _fireDOMEvent(e,type,targets){if(e.type==='click'){var synth=L.Util.extend({},e);synth.type='preclick';this._fireDOMEvent(synth,synth.type,targets);}
if(e._stopped){return;}
targets=(targets||[]).concat(this._findEventTargets(e,type));if(!targets.length){return;}
var target=targets[0];if(type==='contextmenu'&&target.listens(type,true)){L.DomEvent.preventDefault(e);}
var data={originalEvent:e};if(e.type!=='keypress'){var isMarker=target instanceof L.Marker;data.containerPoint=isMarker?this.latLngToContainerPoint(target.getLatLng()):this.mouseEventToContainerPoint(e);data.layerPoint=this.containerPointToLayerPoint(data.containerPoint);data.latlng=isMarker?target.getLatLng():this.layerPointToLatLng(data.layerPoint);}
for(var i=0;i<targets.length;i++){targets[i].fire(type,data,true);if(data.originalEvent._stopped||targets[i].options.nonBubblingEvents&&L.Util.indexOf(targets[i].options.nonBubblingEvents,type)!==-1){return;}}},_draggableMoved:function _draggableMoved(obj){obj=obj.dragging&&obj.dragging.enabled()?obj:this;return obj.dragging&&obj.dragging.moved()||this.boxZoom&&this.boxZoom.moved();},_clearHandlers:function _clearHandlers(){for(var i=0,len=this._handlers.length;i<len;i++){this._handlers[i].disable();}},whenReady:function whenReady(callback,context){if(this._loaded){callback.call(context||this,{target:this});}else{this.on('load',callback,context);}
return this;},_getMapPanePos:function _getMapPanePos(){return L.DomUtil.getPosition(this._mapPane)||new L.Point(0,0);},_moved:function _moved(){var pos=this._getMapPanePos();return pos&&!pos.equals([0,0]);},_getTopLeftPoint:function _getTopLeftPoint(center,zoom){var pixelOrigin=center&&zoom!==undefined?this._getNewPixelOrigin(center,zoom):this.getPixelOrigin();return pixelOrigin.subtract(this._getMapPanePos());},_getNewPixelOrigin:function _getNewPixelOrigin(center,zoom){var viewHalf=this.getSize()._divideBy(2);return this.project(center,zoom)._subtract(viewHalf)._add(this._getMapPanePos())._round();},_latLngToNewLayerPoint:function _latLngToNewLayerPoint(latlng,zoom,center){var topLeft=this._getNewPixelOrigin(center,zoom);return this.project(latlng,zoom)._subtract(topLeft);},_latLngBoundsToNewLayerBounds:function _latLngBoundsToNewLayerBounds(latLngBounds,zoom,center){var topLeft=this._getNewPixelOrigin(center,zoom);return L.bounds([this.project(latLngBounds.getSouthWest(),zoom)._subtract(topLeft),this.project(latLngBounds.getNorthWest(),zoom)._subtract(topLeft),this.project(latLngBounds.getSouthEast(),zoom)._subtract(topLeft),this.project(latLngBounds.getNorthEast(),zoom)._subtract(topLeft)]);},_getCenterLayerPoint:function _getCenterLayerPoint(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2));},_getCenterOffset:function _getCenterOffset(latlng){return this.latLngToLayerPoint(latlng).subtract(this._getCenterLayerPoint());},_limitCenter:function _limitCenter(center,zoom,bounds){if(!bounds){return center;}
var centerPoint=this.project(center,zoom),viewHalf=this.getSize().divideBy(2),viewBounds=new L.Bounds(centerPoint.subtract(viewHalf),centerPoint.add(viewHalf)),offset=this._getBoundsOffset(viewBounds,bounds,zoom);if(offset.round().equals([0,0])){return center;}
return this.unproject(centerPoint.add(offset),zoom);},_limitOffset:function _limitOffset(offset,bounds){if(!bounds){return offset;}
var viewBounds=this.getPixelBounds(),newBounds=new L.Bounds(viewBounds.min.add(offset),viewBounds.max.add(offset));return offset.add(this._getBoundsOffset(newBounds,bounds));},_getBoundsOffset:function _getBoundsOffset(pxBounds,maxBounds,zoom){var projectedMaxBounds=L.bounds(this.project(maxBounds.getNorthEast(),zoom),this.project(maxBounds.getSouthWest(),zoom)),minOffset=projectedMaxBounds.min.subtract(pxBounds.min),maxOffset=projectedMaxBounds.max.subtract(pxBounds.max),dx=this._rebound(minOffset.x,-maxOffset.x),dy=this._rebound(minOffset.y,-maxOffset.y);return new L.Point(dx,dy);},_rebound:function _rebound(left,right){return left+right>0?Math.round(left-right)/2:Math.max(0,Math.ceil(left))-Math.max(0,Math.floor(right));},_limitZoom:function _limitZoom(zoom){var min=this.getMinZoom(),max=this.getMaxZoom(),snap=L.Browser.any3d?this.options.zoomSnap:1;if(snap){zoom=Math.round(zoom/snap)*snap;}
return Math.max(min,Math.min(max,zoom));},_onPanTransitionStep:function _onPanTransitionStep(){this.fire('move');},_onPanTransitionEnd:function _onPanTransitionEnd(){L.DomUtil.removeClass(this._mapPane,'leaflet-pan-anim');this.fire('moveend');},_tryAnimatedPan:function _tryAnimatedPan(center,options){var offset=this._getCenterOffset(center)._floor();if((options&&options.animate)!==true&&!this.getSize().contains(offset)){return false;}
this.panBy(offset,options);return true;},_createAnimProxy:function _createAnimProxy(){var proxy=this._proxy=L.DomUtil.create('div','leaflet-proxy leaflet-zoom-animated');this._panes.mapPane.appendChild(proxy);this.on('zoomanim',function(e){var prop=L.DomUtil.TRANSFORM,transform=proxy.style[prop];L.DomUtil.setTransform(proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1));if(transform===proxy.style[prop]&&this._animatingZoom){this._onZoomTransitionEnd();}},this);this.on('load moveend',function(){var c=this.getCenter(),z=this.getZoom();L.DomUtil.setTransform(proxy,this.project(c,z),this.getZoomScale(z,1));},this);},_catchTransitionEnd:function _catchTransitionEnd(e){if(this._animatingZoom&&e.propertyName.indexOf('transform')>=0){this._onZoomTransitionEnd();}},_nothingToAnimate:function _nothingToAnimate(){return!this._container.getElementsByClassName('leaflet-zoom-animated').length;},_tryAnimatedZoom:function _tryAnimatedZoom(center,zoom,options){if(this._animatingZoom){return true;}
options=options||{};if(!this._zoomAnimated||options.animate===false||this._nothingToAnimate()||Math.abs(zoom-this._zoom)>this.options.zoomAnimationThreshold){return false;}
var scale=this.getZoomScale(zoom),offset=this._getCenterOffset(center)._divideBy(1-1/scale);if(options.animate!==true&&!this.getSize().contains(offset)){return false;}
L.Util.requestAnimFrame(function(){this._moveStart(true)._animateZoom(center,zoom,true);},this);return true;},_animateZoom:function _animateZoom(center,zoom,startAnim,noUpdate){if(startAnim){this._animatingZoom=true;this._animateToCenter=center;this._animateToZoom=zoom;L.DomUtil.addClass(this._mapPane,'leaflet-zoom-anim');}
this.fire('zoomanim',{center:center,zoom:zoom,noUpdate:noUpdate});setTimeout(L.bind(this._onZoomTransitionEnd,this),250);},_onZoomTransitionEnd:function _onZoomTransitionEnd(){if(!this._animatingZoom){return;}
L.DomUtil.removeClass(this._mapPane,'leaflet-zoom-anim');this._animatingZoom=false;this._move(this._animateToCenter,this._animateToZoom);L.Util.requestAnimFrame(function(){this._moveEnd(true);},this);}});L.map=function(id,options){return new L.Map(id,options);};L.Layer=L.Evented.extend({options:{pane:'overlayPane',nonBubblingEvents:[],attribution:null},addTo:function addTo(map){map.addLayer(this);return this;},remove:function remove(){return this.removeFrom(this._map||this._mapToAdd);},removeFrom:function removeFrom(obj){if(obj){obj.removeLayer(this);}
return this;},getPane:function getPane(name){return this._map.getPane(name?this.options[name]||name:this.options.pane);},addInteractiveTarget:function addInteractiveTarget(targetEl){this._map._targets[L.stamp(targetEl)]=this;return this;},removeInteractiveTarget:function removeInteractiveTarget(targetEl){delete this._map._targets[L.stamp(targetEl)];return this;},getAttribution:function getAttribution(){return this.options.attribution;},_layerAdd:function _layerAdd(e){var map=e.target;if(!map.hasLayer(this)){return;}
this._map=map;this._zoomAnimated=map._zoomAnimated;if(this.getEvents){var events=this.getEvents();map.on(events,this);this.once('remove',function(){map.off(events,this);},this);}
this.onAdd(map);if(this.getAttribution&&map.attributionControl){map.attributionControl.addAttribution(this.getAttribution());}
this.fire('add');map.fire('layeradd',{layer:this});}});L.Map.include({addLayer:function addLayer(layer){var id=L.stamp(layer);if(this._layers[id]){return this;}
this._layers[id]=layer;layer._mapToAdd=this;if(layer.beforeAdd){layer.beforeAdd(this);}
this.whenReady(layer._layerAdd,layer);return this;},removeLayer:function removeLayer(layer){var id=L.stamp(layer);if(!this._layers[id]){return this;}
if(this._loaded){layer.onRemove(this);}
if(layer.getAttribution&&this.attributionControl){this.attributionControl.removeAttribution(layer.getAttribution());}
delete this._layers[id];if(this._loaded){this.fire('layerremove',{layer:layer});layer.fire('remove');}
layer._map=layer._mapToAdd=null;return this;},hasLayer:function hasLayer(layer){return!!layer&&L.stamp(layer)in this._layers;},eachLayer:function eachLayer(method,context){for(var i in this._layers){method.call(context,this._layers[i]);}
return this;},_addLayers:function _addLayers(layers){layers=layers?L.Util.isArray(layers)?layers:[layers]:[];for(var i=0,len=layers.length;i<len;i++){this.addLayer(layers[i]);}},_addZoomLimit:function _addZoomLimit(layer){if(isNaN(layer.options.maxZoom)||!isNaN(layer.options.minZoom)){this._zoomBoundLayers[L.stamp(layer)]=layer;this._updateZoomLevels();}},_removeZoomLimit:function _removeZoomLimit(layer){var id=L.stamp(layer);if(this._zoomBoundLayers[id]){delete this._zoomBoundLayers[id];this._updateZoomLevels();}},_updateZoomLevels:function _updateZoomLevels(){var minZoom=Infinity,maxZoom=-Infinity,oldZoomSpan=this._getZoomSpan();for(var i in this._zoomBoundLayers){var options=this._zoomBoundLayers[i].options;minZoom=options.minZoom===undefined?minZoom:Math.min(minZoom,options.minZoom);maxZoom=options.maxZoom===undefined?maxZoom:Math.max(maxZoom,options.maxZoom);}
this._layersMaxZoom=maxZoom===-Infinity?undefined:maxZoom;this._layersMinZoom=minZoom===Infinity?undefined:minZoom;if(oldZoomSpan!==this._getZoomSpan()){this.fire('zoomlevelschange');}
if(this.options.maxZoom===undefined&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom){this.setZoom(this._layersMaxZoom);}
if(this.options.minZoom===undefined&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom){this.setZoom(this._layersMinZoom);}}});var eventsKey='_leaflet_events';L.DomEvent={on:function on(obj,types,fn,context){if(typeof types==='object'){for(var type in types){this._on(obj,type,types[type],fn);}}else{types=L.Util.splitWords(types);for(var i=0,len=types.length;i<len;i++){this._on(obj,types[i],fn,context);}}
return this;},off:function off(obj,types,fn,context){if(typeof types==='object'){for(var type in types){this._off(obj,type,types[type],fn);}}else{types=L.Util.splitWords(types);for(var i=0,len=types.length;i<len;i++){this._off(obj,types[i],fn,context);}}
return this;},_on:function _on(obj,type,fn,context){var id=type+L.stamp(fn)+(context?'_'+L.stamp(context):'');if(obj[eventsKey]&&obj[eventsKey][id]){return this;}
var handler=function handler(e){return fn.call(context||obj,e||window.event);};var originalHandler=handler;if(L.Browser.pointer&&type.indexOf('touch')===0){this.addPointerListener(obj,type,handler,id);}else if(L.Browser.touch&&type==='dblclick'&&this.addDoubleTapListener&&!(L.Browser.pointer&&L.Browser.chrome)){this.addDoubleTapListener(obj,handler,id);}else if('addEventListener'in obj){if(type==='mousewheel'){obj.addEventListener('onwheel'in obj?'wheel':'mousewheel',handler,false);}else if(type==='mouseenter'||type==='mouseleave'){handler=function handler(e){e=e||window.event;if(L.DomEvent._isExternalTarget(obj,e)){originalHandler(e);}};obj.addEventListener(type==='mouseenter'?'mouseover':'mouseout',handler,false);}else{if(type==='click'&&L.Browser.android){handler=function handler(e){return L.DomEvent._filterClick(e,originalHandler);};}
obj.addEventListener(type,handler,false);}}else if('attachEvent'in obj){obj.attachEvent('on'+type,handler);}
obj[eventsKey]=obj[eventsKey]||{};obj[eventsKey][id]=handler;return this;},_off:function _off(obj,type,fn,context){var id=type+L.stamp(fn)+(context?'_'+L.stamp(context):''),handler=obj[eventsKey]&&obj[eventsKey][id];if(!handler){return this;}
if(L.Browser.pointer&&type.indexOf('touch')===0){this.removePointerListener(obj,type,id);}else if(L.Browser.touch&&type==='dblclick'&&this.removeDoubleTapListener){this.removeDoubleTapListener(obj,id);}else if('removeEventListener'in obj){if(type==='mousewheel'){obj.removeEventListener('onwheel'in obj?'wheel':'mousewheel',handler,false);}else{obj.removeEventListener(type==='mouseenter'?'mouseover':type==='mouseleave'?'mouseout':type,handler,false);}}else if('detachEvent'in obj){obj.detachEvent('on'+type,handler);}
obj[eventsKey][id]=null;return this;},stopPropagation:function stopPropagation(e){if(e.stopPropagation){e.stopPropagation();}else if(e.originalEvent){e.originalEvent._stopped=true;}else{e.cancelBubble=true;}
L.DomEvent._skipped(e);return this;},disableScrollPropagation:function disableScrollPropagation(el){return L.DomEvent.on(el,'mousewheel',L.DomEvent.stopPropagation);},disableClickPropagation:function disableClickPropagation(el){var stop=L.DomEvent.stopPropagation;L.DomEvent.on(el,L.Draggable.START.join(' '),stop);return L.DomEvent.on(el,{click:L.DomEvent._fakeStop,dblclick:stop});},preventDefault:function preventDefault(e){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}
return this;},stop:function stop(e){return L.DomEvent.preventDefault(e).stopPropagation(e);},getMousePosition:function getMousePosition(e,container){if(!container){return new L.Point(e.clientX,e.clientY);}
var rect=container.getBoundingClientRect();return new L.Point(e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop);},_wheelPxFactor:L.Browser.win&&L.Browser.chrome?2:L.Browser.gecko?window.devicePixelRatio:1,getWheelDelta:function getWheelDelta(e){return L.Browser.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/L.DomEvent._wheelPxFactor:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0;},_skipEvents:{},_fakeStop:function _fakeStop(e){L.DomEvent._skipEvents[e.type]=true;},_skipped:function _skipped(e){var skipped=this._skipEvents[e.type];this._skipEvents[e.type]=false;return skipped;},_isExternalTarget:function _isExternalTarget(el,e){var related=e.relatedTarget;if(!related){return true;}
try{while(related&&related!==el){related=related.parentNode;}}catch(err){return false;}
return related!==el;},_filterClick:function _filterClick(e,handler){var timeStamp=e.timeStamp||e.originalEvent&&e.originalEvent.timeStamp,elapsed=L.DomEvent._lastClick&&timeStamp-L.DomEvent._lastClick;if(elapsed&&elapsed>100&&elapsed<500||e.target._simulatedClick&&!e._simulated){L.DomEvent.stop(e);return;}
L.DomEvent._lastClick=timeStamp;handler(e);}};L.DomEvent.addListener=L.DomEvent.on;L.DomEvent.removeListener=L.DomEvent.off;L.PosAnimation=L.Evented.extend({run:function run(el,newPos,duration,easeLinearity){this.stop();this._el=el;this._inProgress=true;this._duration=duration||0.25;this._easeOutPower=1/Math.max(easeLinearity||0.5,0.2);this._startPos=L.DomUtil.getPosition(el);this._offset=newPos.subtract(this._startPos);this._startTime=+new Date();this.fire('start');this._animate();},stop:function stop(){if(!this._inProgress){return;}
this._step(true);this._complete();},_animate:function _animate(){this._animId=L.Util.requestAnimFrame(this._animate,this);this._step();},_step:function _step(round){var elapsed=+new Date()-this._startTime,duration=this._duration*1000;if(elapsed<duration){this._runFrame(this._easeOut(elapsed/duration),round);}else{this._runFrame(1);this._complete();}},_runFrame:function _runFrame(progress,round){var pos=this._startPos.add(this._offset.multiplyBy(progress));if(round){pos._round();}
L.DomUtil.setPosition(this._el,pos);this.fire('step');},_complete:function _complete(){L.Util.cancelAnimFrame(this._animId);this._inProgress=false;this.fire('end');},_easeOut:function _easeOut(t){return 1-Math.pow(1-t,this._easeOutPower);}});L.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:L.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function project(latlng){var d=Math.PI/180,r=this.R,y=latlng.lat*d,tmp=this.R_MINOR/r,e=Math.sqrt(1-tmp*tmp),con=e*Math.sin(y);var ts=Math.tan(Math.PI/4-y/2)/Math.pow((1-con)/(1+con),e/2);y=-r*Math.log(Math.max(ts,1E-10));return new L.Point(latlng.lng*d*r,y);},unproject:function unproject(point){var d=180/Math.PI,r=this.R,tmp=this.R_MINOR/r,e=Math.sqrt(1-tmp*tmp),ts=Math.exp(-point.y/r),phi=Math.PI/2-2*Math.atan(ts);for(var i=0,dphi=0.1,con;i<15&&Math.abs(dphi)>1e-7;i++){con=e*Math.sin(phi);con=Math.pow((1-con)/(1+con),e/2);dphi=Math.PI/2-2*Math.atan(ts*con)-phi;phi+=dphi;}
return new L.LatLng(phi*d,point.x*d/r);}};L.CRS.EPSG3395=L.extend({},L.CRS.Earth,{code:'EPSG:3395',projection:L.Projection.Mercator,transformation:function(){var scale=0.5/(Math.PI*L.Projection.Mercator.R);return new L.Transformation(scale,0.5,-scale,0.5);}()});L.GridLayer=L.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:L.Browser.mobile,updateWhenZooming:true,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:undefined,noWrap:false,pane:'tilePane',className:'',keepBuffer:2},initialize:function initialize(options){L.setOptions(this,options);},onAdd:function onAdd(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update();},beforeAdd:function beforeAdd(map){map._addZoomLimit(this);},onRemove:function onRemove(map){this._removeAllTiles();L.DomUtil.remove(this._container);map._removeZoomLimit(this);this._container=null;this._tileZoom=null;},bringToFront:function bringToFront(){if(this._map){L.DomUtil.toFront(this._container);this._setAutoZIndex(Math.max);}
return this;},bringToBack:function bringToBack(){if(this._map){L.DomUtil.toBack(this._container);this._setAutoZIndex(Math.min);}
return this;},getContainer:function getContainer(){return this._container;},setOpacity:function setOpacity(opacity){this.options.opacity=opacity;this._updateOpacity();return this;},setZIndex:function setZIndex(zIndex){this.options.zIndex=zIndex;this._updateZIndex();return this;},isLoading:function isLoading(){return this._loading;},redraw:function redraw(){if(this._map){this._removeAllTiles();this._update();}
return this;},getEvents:function getEvents(){var events={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};if(!this.options.updateWhenIdle){if(!this._onMove){this._onMove=L.Util.throttle(this._onMoveEnd,this.options.updateInterval,this);}
events.move=this._onMove;}
if(this._zoomAnimated){events.zoomanim=this._animateZoom;}
return events;},createTile:function createTile(){return document.createElement('div');},getTileSize:function getTileSize(){var s=this.options.tileSize;return s instanceof L.Point?s:new L.Point(s,s);},_updateZIndex:function _updateZIndex(){if(this._container&&this.options.zIndex!==undefined&&this.options.zIndex!==null){this._container.style.zIndex=this.options.zIndex;}},_setAutoZIndex:function _setAutoZIndex(compare){var layers=this.getPane().children,edgeZIndex=-compare(-Infinity,Infinity);for(var i=0,len=layers.length,zIndex;i<len;i++){zIndex=layers[i].style.zIndex;if(layers[i]!==this._container&&zIndex){edgeZIndex=compare(edgeZIndex,+zIndex);}}
if(isFinite(edgeZIndex)){this.options.zIndex=edgeZIndex+compare(-1,1);this._updateZIndex();}},_updateOpacity:function _updateOpacity(){if(!this._map){return;}
if(L.Browser.ielt9){return;}
L.DomUtil.setOpacity(this._container,this.options.opacity);var now=+new Date(),nextFrame=false,willPrune=false;for(var key in this._tiles){var tile=this._tiles[key];if(!tile.current||!tile.loaded){continue;}
var fade=Math.min(1,(now-tile.loaded)/200);L.DomUtil.setOpacity(tile.el,fade);if(fade<1){nextFrame=true;}else{if(tile.active){willPrune=true;}
tile.active=true;}}
if(willPrune&&!this._noPrune){this._pruneTiles();}
if(nextFrame){L.Util.cancelAnimFrame(this._fadeFrame);this._fadeFrame=L.Util.requestAnimFrame(this._updateOpacity,this);}},_initContainer:function _initContainer(){if(this._container){return;}
this._container=L.DomUtil.create('div','leaflet-layer '+(this.options.className||''));this._updateZIndex();if(this.options.opacity<1){this._updateOpacity();}
this.getPane().appendChild(this._container);},_updateLevels:function _updateLevels(){var zoom=this._tileZoom,maxZoom=this.options.maxZoom;if(zoom===undefined){return undefined;}
for(var z in this._levels){if(this._levels[z].el.children.length||z===zoom){this._levels[z].el.style.zIndex=maxZoom-Math.abs(zoom-z);}else{L.DomUtil.remove(this._levels[z].el);this._removeTilesAtZoom(z);delete this._levels[z];}}
var level=this._levels[zoom],map=this._map;if(!level){level=this._levels[zoom]={};level.el=L.DomUtil.create('div','leaflet-tile-container leaflet-zoom-animated',this._container);level.el.style.zIndex=maxZoom;level.origin=map.project(map.unproject(map.getPixelOrigin()),zoom).round();level.zoom=zoom;this._setZoomTransform(level,map.getCenter(),map.getZoom());L.Util.falseFn(level.el.offsetWidth);}
this._level=level;return level;},_pruneTiles:function _pruneTiles(){if(!this._map){return;}
var key,tile;var zoom=this._map.getZoom();if(zoom>this.options.maxZoom||zoom<this.options.minZoom){this._removeAllTiles();return;}
for(key in this._tiles){tile=this._tiles[key];tile.retain=tile.current;}
for(key in this._tiles){tile=this._tiles[key];if(tile.current&&!tile.active){var coords=tile.coords;if(!this._retainParent(coords.x,coords.y,coords.z,coords.z-5)){this._retainChildren(coords.x,coords.y,coords.z,coords.z+2);}}}
for(key in this._tiles){if(!this._tiles[key].retain){this._removeTile(key);}}},_removeTilesAtZoom:function _removeTilesAtZoom(zoom){for(var key in this._tiles){if(this._tiles[key].coords.z!==zoom){continue;}
this._removeTile(key);}},_removeAllTiles:function _removeAllTiles(){for(var key in this._tiles){this._removeTile(key);}},_invalidateAll:function _invalidateAll(){for(var z in this._levels){L.DomUtil.remove(this._levels[z].el);delete this._levels[z];}
this._removeAllTiles();this._tileZoom=null;},_retainParent:function _retainParent(x,y,z,minZoom){var x2=Math.floor(x/2),y2=Math.floor(y/2),z2=z-1,coords2=new L.Point(+x2,+y2);coords2.z=+z2;var key=this._tileCoordsToKey(coords2),tile=this._tiles[key];if(tile&&tile.active){tile.retain=true;return true;}else if(tile&&tile.loaded){tile.retain=true;}
if(z2>minZoom){return this._retainParent(x2,y2,z2,minZoom);}
return false;},_retainChildren:function _retainChildren(x,y,z,maxZoom){for(var i=2*x;i<2*x+2;i++){for(var j=2*y;j<2*y+2;j++){var coords=new L.Point(i,j);coords.z=z+1;var key=this._tileCoordsToKey(coords),tile=this._tiles[key];if(tile&&tile.active){tile.retain=true;continue;}else if(tile&&tile.loaded){tile.retain=true;}
if(z+1<maxZoom){this._retainChildren(i,j,z+1,maxZoom);}}}},_resetView:function _resetView(e){var animating=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),animating,animating);},_animateZoom:function _animateZoom(e){this._setView(e.center,e.zoom,true,e.noUpdate);},_setView:function _setView(center,zoom,noPrune,noUpdate){var tileZoom=Math.round(zoom);if(this.options.maxZoom!==undefined&&tileZoom>this.options.maxZoom||this.options.minZoom!==undefined&&tileZoom<this.options.minZoom){tileZoom=undefined;}
var tileZoomChanged=this.options.updateWhenZooming&&tileZoom!==this._tileZoom;if(!noUpdate||tileZoomChanged){this._tileZoom=tileZoom;if(this._abortLoading){this._abortLoading();}
this._updateLevels();this._resetGrid();if(tileZoom!==undefined){this._update(center);}
if(!noPrune){this._pruneTiles();}
this._noPrune=!!noPrune;}
this._setZoomTransforms(center,zoom);},_setZoomTransforms:function _setZoomTransforms(center,zoom){for(var i in this._levels){this._setZoomTransform(this._levels[i],center,zoom);}},_setZoomTransform:function _setZoomTransform(level,center,zoom){var scale=this._map.getZoomScale(zoom,level.zoom),translate=level.origin.multiplyBy(scale).subtract(this._map._getNewPixelOrigin(center,zoom)).round();if(L.Browser.any3d){L.DomUtil.setTransform(level.el,translate,scale);}else{L.DomUtil.setPosition(level.el,translate);}},_resetGrid:function _resetGrid(){var map=this._map,crs=map.options.crs,tileSize=this._tileSize=this.getTileSize(),tileZoom=this._tileZoom;var bounds=this._map.getPixelWorldBounds(this._tileZoom);if(bounds){this._globalTileRange=this._pxBoundsToTileRange(bounds);}
this._wrapX=crs.wrapLng&&!this.options.noWrap&&[Math.floor(map.project([0,crs.wrapLng[0]],tileZoom).x/tileSize.x),Math.ceil(map.project([0,crs.wrapLng[1]],tileZoom).x/tileSize.y)];this._wrapY=crs.wrapLat&&!this.options.noWrap&&[Math.floor(map.project([crs.wrapLat[0],0],tileZoom).y/tileSize.x),Math.ceil(map.project([crs.wrapLat[1],0],tileZoom).y/tileSize.y)];},_onMoveEnd:function _onMoveEnd(){if(!this._map||this._map._animatingZoom){return;}
this._update();},_getTiledPixelBounds:function _getTiledPixelBounds(center){var map=this._map,mapZoom=map._animatingZoom?Math.max(map._animateToZoom,map.getZoom()):map.getZoom(),scale=map.getZoomScale(mapZoom,this._tileZoom),pixelCenter=map.project(center,this._tileZoom).floor(),halfSize=map.getSize().divideBy(scale*2);return new L.Bounds(pixelCenter.subtract(halfSize),pixelCenter.add(halfSize));},_update:function _update(center){var map=this._map;if(!map){return;}
var zoom=map.getZoom();if(center===undefined){center=map.getCenter();}
if(this._tileZoom===undefined){return;}
var pixelBounds=this._getTiledPixelBounds(center),tileRange=this._pxBoundsToTileRange(pixelBounds),tileCenter=tileRange.getCenter(),queue=[],margin=this.options.keepBuffer,noPruneRange=new L.Bounds(tileRange.getBottomLeft().subtract([margin,-margin]),tileRange.getTopRight().add([margin,-margin]));for(var key in this._tiles){var c=this._tiles[key].coords;if(c.z!==this._tileZoom||!noPruneRange.contains(L.point(c.x,c.y))){this._tiles[key].current=false;}}
if(Math.abs(zoom-this._tileZoom)>1){this._setView(center,zoom);return;}
for(var j=tileRange.min.y;j<=tileRange.max.y;j++){for(var i=tileRange.min.x;i<=tileRange.max.x;i++){var coords=new L.Point(i,j);coords.z=this._tileZoom;if(!this._isValidTile(coords)){continue;}
var tile=this._tiles[this._tileCoordsToKey(coords)];if(tile){tile.current=true;}else{queue.push(coords);}}}
queue.sort(function(a,b){return a.distanceTo(tileCenter)-b.distanceTo(tileCenter);});if(queue.length!==0){if(!this._loading){this._loading=true;this.fire('loading');}
var fragment=document.createDocumentFragment();for(i=0;i<queue.length;i++){this._addTile(queue[i],fragment);}
this._level.el.appendChild(fragment);}},_isValidTile:function _isValidTile(coords){var crs=this._map.options.crs;if(!crs.infinite){var bounds=this._globalTileRange;if(!crs.wrapLng&&(coords.x<bounds.min.x||coords.x>bounds.max.x)||!crs.wrapLat&&(coords.y<bounds.min.y||coords.y>bounds.max.y)){return false;}}
if(!this.options.bounds){return true;}
var tileBounds=this._tileCoordsToBounds(coords);return L.latLngBounds(this.options.bounds).overlaps(tileBounds);},_keyToBounds:function _keyToBounds(key){return this._tileCoordsToBounds(this._keyToTileCoords(key));},_tileCoordsToBounds:function _tileCoordsToBounds(coords){var map=this._map,tileSize=this.getTileSize(),nwPoint=coords.scaleBy(tileSize),sePoint=nwPoint.add(tileSize),nw=map.unproject(nwPoint,coords.z),se=map.unproject(sePoint,coords.z),bounds=new L.LatLngBounds(nw,se);if(!this.options.noWrap){map.wrapLatLngBounds(bounds);}
return bounds;},_tileCoordsToKey:function _tileCoordsToKey(coords){return coords.x+':'+coords.y+':'+coords.z;},_keyToTileCoords:function _keyToTileCoords(key){var k=key.split(':'),coords=new L.Point(+k[0],+k[1]);coords.z=+k[2];return coords;},_removeTile:function _removeTile(key){var tile=this._tiles[key];if(!tile){return;}
L.DomUtil.remove(tile.el);delete this._tiles[key];this.fire('tileunload',{tile:tile.el,coords:this._keyToTileCoords(key)});},_initTile:function _initTile(tile){L.DomUtil.addClass(tile,'leaflet-tile');var tileSize=this.getTileSize();tile.style.width=tileSize.x+'px';tile.style.height=tileSize.y+'px';tile.onselectstart=L.Util.falseFn;tile.onmousemove=L.Util.falseFn;if(L.Browser.ielt9&&this.options.opacity<1){L.DomUtil.setOpacity(tile,this.options.opacity);}
if(L.Browser.android&&!L.Browser.android23){tile.style.WebkitBackfaceVisibility='hidden';}},_addTile:function _addTile(coords,container){var tilePos=this._getTilePos(coords),key=this._tileCoordsToKey(coords);var tile=this.createTile(this._wrapCoords(coords),L.bind(this._tileReady,this,coords));this._initTile(tile);if(this.createTile.length<2){L.Util.requestAnimFrame(L.bind(this._tileReady,this,coords,null,tile));}
L.DomUtil.setPosition(tile,tilePos);this._tiles[key]={el:tile,coords:coords,current:true};container.appendChild(tile);this.fire('tileloadstart',{tile:tile,coords:coords});},_tileReady:function _tileReady(coords,err,tile){if(!this._map){return;}
if(err){this.fire('tileerror',{error:err,tile:tile,coords:coords});}
var key=this._tileCoordsToKey(coords);tile=this._tiles[key];if(!tile){return;}
tile.loaded=+new Date();if(this._map._fadeAnimated){L.DomUtil.setOpacity(tile.el,0);L.Util.cancelAnimFrame(this._fadeFrame);this._fadeFrame=L.Util.requestAnimFrame(this._updateOpacity,this);}else{tile.active=true;this._pruneTiles();}
if(!err){L.DomUtil.addClass(tile.el,'leaflet-tile-loaded');this.fire('tileload',{tile:tile.el,coords:coords});}
if(this._noTilesToLoad()){this._loading=false;this.fire('load');if(L.Browser.ielt9||!this._map._fadeAnimated){L.Util.requestAnimFrame(this._pruneTiles,this);}else{setTimeout(L.bind(this._pruneTiles,this),250);}}},_getTilePos:function _getTilePos(coords){return coords.scaleBy(this.getTileSize()).subtract(this._level.origin);},_wrapCoords:function _wrapCoords(coords){var newCoords=new L.Point(this._wrapX?L.Util.wrapNum(coords.x,this._wrapX):coords.x,this._wrapY?L.Util.wrapNum(coords.y,this._wrapY):coords.y);newCoords.z=coords.z;return newCoords;},_pxBoundsToTileRange:function _pxBoundsToTileRange(bounds){var tileSize=this.getTileSize();return new L.Bounds(bounds.min.unscaleBy(tileSize).floor(),bounds.max.unscaleBy(tileSize).ceil().subtract([1,1]));},_noTilesToLoad:function _noTilesToLoad(){for(var key in this._tiles){if(!this._tiles[key].loaded){return false;}}
return true;}});L.gridLayer=function(options){return new L.GridLayer(options);};L.TileLayer=L.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:'abc',errorTileUrl:'',zoomOffset:0,tms:false,zoomReverse:false,detectRetina:false,crossOrigin:false},initialize:function initialize(url,options){this._url=url;options=L.setOptions(this,options);if(options.detectRetina&&L.Browser.retina&&options.maxZoom>0){options.tileSize=Math.floor(options.tileSize/2);if(!options.zoomReverse){options.zoomOffset++;options.maxZoom--;}else{options.zoomOffset--;options.minZoom++;}
options.minZoom=Math.max(0,options.minZoom);}
if(typeof options.subdomains==='string'){options.subdomains=options.subdomains.split('');}
if(!L.Browser.android){this.on('tileunload',this._onTileRemove);}},setUrl:function setUrl(url,noRedraw){this._url=url;if(!noRedraw){this.redraw();}
return this;},createTile:function createTile(coords,done){var tile=document.createElement('img');L.DomEvent.on(tile,'load',L.bind(this._tileOnLoad,this,done,tile));L.DomEvent.on(tile,'error',L.bind(this._tileOnError,this,done,tile));if(this.options.crossOrigin){tile.crossOrigin='';}
tile.alt='';tile.setAttribute('role','presentation');tile.src=this.getTileUrl(coords);return tile;},getTileUrl:function getTileUrl(coords){var data={r:L.Browser.retina?'@2x':'',s:this._getSubdomain(coords),x:coords.x,y:coords.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var invertedY=this._globalTileRange.max.y-coords.y;if(this.options.tms){data['y']=invertedY;}
data['-y']=invertedY;}
return L.Util.template(this._url,L.extend(data,this.options));},_tileOnLoad:function _tileOnLoad(done,tile){if(L.Browser.ielt9){setTimeout(L.bind(done,this,null,tile),0);}else{done(null,tile);}},_tileOnError:function _tileOnError(done,tile,e){var errorUrl=this.options.errorTileUrl;if(errorUrl&&tile.src!==errorUrl){tile.src=errorUrl;}
done(e,tile);},getTileSize:function getTileSize(){var map=this._map,tileSize=L.GridLayer.prototype.getTileSize.call(this),zoom=this._tileZoom+this.options.zoomOffset,minNativeZoom=this.options.minNativeZoom,maxNativeZoom=this.options.maxNativeZoom;if(minNativeZoom!==null&&zoom<minNativeZoom){return tileSize.divideBy(map.getZoomScale(minNativeZoom,zoom)).round();}
if(maxNativeZoom!==null&&zoom>maxNativeZoom){return tileSize.divideBy(map.getZoomScale(maxNativeZoom,zoom)).round();}
return tileSize;},_onTileRemove:function _onTileRemove(e){e.tile.onload=null;},_getZoomForUrl:function _getZoomForUrl(){var zoom=this._tileZoom,maxZoom=this.options.maxZoom,zoomReverse=this.options.zoomReverse,zoomOffset=this.options.zoomOffset,minNativeZoom=this.options.minNativeZoom,maxNativeZoom=this.options.maxNativeZoom;if(zoomReverse){zoom=maxZoom-zoom;}
zoom+=zoomOffset;if(minNativeZoom!==null&&zoom<minNativeZoom){return minNativeZoom;}
if(maxNativeZoom!==null&&zoom>maxNativeZoom){return maxNativeZoom;}
return zoom;},_getSubdomain:function _getSubdomain(tilePoint){var index=Math.abs(tilePoint.x+tilePoint.y)%this.options.subdomains.length;return this.options.subdomains[index];},_abortLoading:function _abortLoading(){var i,tile;for(i in this._tiles){if(this._tiles[i].coords.z!==this._tileZoom){tile=this._tiles[i].el;tile.onload=L.Util.falseFn;tile.onerror=L.Util.falseFn;if(!tile.complete){tile.src=L.Util.emptyImageUrl;L.DomUtil.remove(tile);}}}}});L.tileLayer=function(url,options){return new L.TileLayer(url,options);};L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:'WMS',request:'GetMap',layers:'',styles:'',format:'image/jpeg',transparent:false,version:'1.1.1'},options:{crs:null,uppercase:false},initialize:function initialize(url,options){this._url=url;var wmsParams=L.extend({},this.defaultWmsParams);for(var i in options){if(!(i in this.options)){wmsParams[i]=options[i];}}
options=L.setOptions(this,options);wmsParams.width=wmsParams.height=options.tileSize*(options.detectRetina&&L.Browser.retina?2:1);this.wmsParams=wmsParams;},onAdd:function onAdd(map){this._crs=this.options.crs||map.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);var projectionKey=this._wmsVersion>=1.3?'crs':'srs';this.wmsParams[projectionKey]=this._crs.code;L.TileLayer.prototype.onAdd.call(this,map);},getTileUrl:function getTileUrl(coords){var tileBounds=this._tileCoordsToBounds(coords),nw=this._crs.project(tileBounds.getNorthWest()),se=this._crs.project(tileBounds.getSouthEast()),bbox=(this._wmsVersion>=1.3&&this._crs===L.CRS.EPSG4326?[se.y,nw.x,nw.y,se.x]:[nw.x,se.y,se.x,nw.y]).join(','),url=L.TileLayer.prototype.getTileUrl.call(this,coords);return url+L.Util.getParamString(this.wmsParams,url,this.options.uppercase)+(this.options.uppercase?'&BBOX=':'&bbox=')+bbox;},setParams:function setParams(params,noRedraw){L.extend(this.wmsParams,params);if(!noRedraw){this.redraw();}
return this;}});L.tileLayer.wms=function(url,options){return new L.TileLayer.WMS(url,options);};L.ImageOverlay=L.Layer.extend({options:{opacity:1,alt:'',interactive:false,crossOrigin:false},initialize:function initialize(url,bounds,options){this._url=url;this._bounds=L.latLngBounds(bounds);L.setOptions(this,options);},onAdd:function onAdd(){if(!this._image){this._initImage();if(this.options.opacity<1){this._updateOpacity();}}
if(this.options.interactive){L.DomUtil.addClass(this._image,'leaflet-interactive');this.addInteractiveTarget(this._image);}
this.getPane().appendChild(this._image);this._reset();},onRemove:function onRemove(){L.DomUtil.remove(this._image);if(this.options.interactive){this.removeInteractiveTarget(this._image);}},setOpacity:function setOpacity(opacity){this.options.opacity=opacity;if(this._image){this._updateOpacity();}
return this;},setStyle:function setStyle(styleOpts){if(styleOpts.opacity){this.setOpacity(styleOpts.opacity);}
return this;},bringToFront:function bringToFront(){if(this._map){L.DomUtil.toFront(this._image);}
return this;},bringToBack:function bringToBack(){if(this._map){L.DomUtil.toBack(this._image);}
return this;},setUrl:function setUrl(url){this._url=url;if(this._image){this._image.src=url;}
return this;},setBounds:function setBounds(bounds){this._bounds=bounds;if(this._map){this._reset();}
return this;},getEvents:function getEvents(){var events={zoom:this._reset,viewreset:this._reset};if(this._zoomAnimated){events.zoomanim=this._animateZoom;}
return events;},getBounds:function getBounds(){return this._bounds;},getElement:function getElement(){return this._image;},_initImage:function _initImage(){var img=this._image=L.DomUtil.create('img','leaflet-image-layer '+(this._zoomAnimated?'leaflet-zoom-animated':''));img.onselectstart=L.Util.falseFn;img.onmousemove=L.Util.falseFn;img.onload=L.bind(this.fire,this,'load');if(this.options.crossOrigin){img.crossOrigin='';}
img.src=this._url;img.alt=this.options.alt;},_animateZoom:function _animateZoom(e){var scale=this._map.getZoomScale(e.zoom),offset=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;L.DomUtil.setTransform(this._image,offset,scale);},_reset:function _reset(){var image=this._image,bounds=new L.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),size=bounds.getSize();L.DomUtil.setPosition(image,bounds.min);image.style.width=size.x+'px';image.style.height=size.y+'px';},_updateOpacity:function _updateOpacity(){L.DomUtil.setOpacity(this._image,this.options.opacity);}});L.imageOverlay=function(url,bounds,options){return new L.ImageOverlay(url,bounds,options);};L.Icon=L.Class.extend({initialize:function initialize(options){L.setOptions(this,options);},createIcon:function createIcon(oldIcon){return this._createIcon('icon',oldIcon);},createShadow:function createShadow(oldIcon){return this._createIcon('shadow',oldIcon);},_createIcon:function _createIcon(name,oldIcon){var src=this._getIconUrl(name);if(!src){if(name==='icon'){throw new Error('iconUrl not set in Icon options (see the docs).');}
return null;}
var img=this._createImg(src,oldIcon&&oldIcon.tagName==='IMG'?oldIcon:null);this._setIconStyles(img,name);return img;},_setIconStyles:function _setIconStyles(img,name){var options=this.options;var sizeOption=options[name+'Size'];if(typeof sizeOption==='number'){sizeOption=[sizeOption,sizeOption];}
var size=L.point(sizeOption),anchor=L.point(name==='shadow'&&options.shadowAnchor||options.iconAnchor||size&&size.divideBy(2,true));img.className='leaflet-marker-'+name+' '+(options.className||'');if(anchor){img.style.marginLeft=-anchor.x+'px';img.style.marginTop=-anchor.y+'px';}
if(size){img.style.width=size.x+'px';img.style.height=size.y+'px';}},_createImg:function _createImg(src,el){el=el||document.createElement('img');el.src=src;return el;},_getIconUrl:function _getIconUrl(name){return L.Browser.retina&&this.options[name+'RetinaUrl']||this.options[name+'Url'];}});L.icon=function(options){return new L.Icon(options);};L.Icon.Default=L.Icon.extend({options:{iconUrl:'marker-icon.png',iconRetinaUrl:'marker-icon-2x.png',shadowUrl:'marker-shadow.png',iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function _getIconUrl(name){if(!L.Icon.Default.imagePath){L.Icon.Default.imagePath=this._detectIconPath();}
return(this.options.imagePath||L.Icon.Default.imagePath)+L.Icon.prototype._getIconUrl.call(this,name);},_detectIconPath:function _detectIconPath(){var el=L.DomUtil.create('div','leaflet-default-icon-path',document.body);var path=L.DomUtil.getStyle(el,'background-image')||L.DomUtil.getStyle(el,'backgroundImage');document.body.removeChild(el);return path.indexOf('url')===0?path.replace(/^url\([\"\']?/,'').replace(/marker-icon\.png[\"\']?\)$/,''):'';}});L.Marker=L.Layer.extend({options:{icon:new L.Icon.Default(),interactive:true,draggable:false,keyboard:true,title:'',alt:'',zIndexOffset:0,opacity:1,riseOnHover:false,riseOffset:250,pane:'markerPane',nonBubblingEvents:['click','dblclick','mouseover','mouseout','contextmenu']},initialize:function initialize(latlng,options){L.setOptions(this,options);this._latlng=L.latLng(latlng);},onAdd:function onAdd(map){this._zoomAnimated=this._zoomAnimated&&map.options.markerZoomAnimation;if(this._zoomAnimated){map.on('zoomanim',this._animateZoom,this);}
this._initIcon();this.update();},onRemove:function onRemove(map){if(this.dragging&&this.dragging.enabled()){this.options.draggable=true;this.dragging.removeHooks();}
if(this._zoomAnimated){map.off('zoomanim',this._animateZoom,this);}
this._removeIcon();this._removeShadow();},getEvents:function getEvents(){return{zoom:this.update,viewreset:this.update};},getLatLng:function getLatLng(){return this._latlng;},setLatLng:function setLatLng(latlng){var oldLatLng=this._latlng;this._latlng=L.latLng(latlng);this.update();return this.fire('move',{oldLatLng:oldLatLng,latlng:this._latlng});},setZIndexOffset:function setZIndexOffset(offset){this.options.zIndexOffset=offset;return this.update();},setIcon:function setIcon(icon){this.options.icon=icon;if(this._map){this._initIcon();this.update();}
if(this._popup){this.bindPopup(this._popup,this._popup.options);}
return this;},getElement:function getElement(){return this._icon;},update:function update(){if(this._icon){var pos=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(pos);}
return this;},_initIcon:function _initIcon(){var options=this.options,classToAdd='leaflet-zoom-'+(this._zoomAnimated?'animated':'hide');var icon=options.icon.createIcon(this._icon),addIcon=false;if(icon!==this._icon){if(this._icon){this._removeIcon();}
addIcon=true;if(options.title){icon.title=options.title;}
if(options.alt){icon.alt=options.alt;}}
L.DomUtil.addClass(icon,classToAdd);if(options.keyboard){icon.tabIndex='0';}
this._icon=icon;if(options.riseOnHover){this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});}
var newShadow=options.icon.createShadow(this._shadow),addShadow=false;if(newShadow!==this._shadow){this._removeShadow();addShadow=true;}
if(newShadow){L.DomUtil.addClass(newShadow,classToAdd);newShadow.alt='';}
this._shadow=newShadow;if(options.opacity<1){this._updateOpacity();}
if(addIcon){this.getPane().appendChild(this._icon);}
this._initInteraction();if(newShadow&&addShadow){this.getPane('shadowPane').appendChild(this._shadow);}},_removeIcon:function _removeIcon(){if(this.options.riseOnHover){this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});}
L.DomUtil.remove(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null;},_removeShadow:function _removeShadow(){if(this._shadow){L.DomUtil.remove(this._shadow);}
this._shadow=null;},_setPos:function _setPos(pos){L.DomUtil.setPosition(this._icon,pos);if(this._shadow){L.DomUtil.setPosition(this._shadow,pos);}
this._zIndex=pos.y+this.options.zIndexOffset;this._resetZIndex();},_updateZIndex:function _updateZIndex(offset){this._icon.style.zIndex=this._zIndex+offset;},_animateZoom:function _animateZoom(opt){var pos=this._map._latLngToNewLayerPoint(this._latlng,opt.zoom,opt.center).round();this._setPos(pos);},_initInteraction:function _initInteraction(){if(!this.options.interactive){return;}
L.DomUtil.addClass(this._icon,'leaflet-interactive');this.addInteractiveTarget(this._icon);if(L.Handler.MarkerDrag){var draggable=this.options.draggable;if(this.dragging){draggable=this.dragging.enabled();this.dragging.disable();}
this.dragging=new L.Handler.MarkerDrag(this);if(draggable){this.dragging.enable();}}},setOpacity:function setOpacity(opacity){this.options.opacity=opacity;if(this._map){this._updateOpacity();}
return this;},_updateOpacity:function _updateOpacity(){var opacity=this.options.opacity;L.DomUtil.setOpacity(this._icon,opacity);if(this._shadow){L.DomUtil.setOpacity(this._shadow,opacity);}},_bringToFront:function _bringToFront(){this._updateZIndex(this.options.riseOffset);},_resetZIndex:function _resetZIndex(){this._updateZIndex(0);},_getPopupAnchor:function _getPopupAnchor(){return this.options.icon.options.popupAnchor||[0,0];},_getTooltipAnchor:function _getTooltipAnchor(){return this.options.icon.options.tooltipAnchor||[0,0];}});L.marker=function(latlng,options){return new L.Marker(latlng,options);};L.DivIcon=L.Icon.extend({options:{iconSize:[12,12],html:false,bgPos:null,className:'leaflet-div-icon'},createIcon:function createIcon(oldIcon){var div=oldIcon&&oldIcon.tagName==='DIV'?oldIcon:document.createElement('div'),options=this.options;div.innerHTML=options.html!==false?options.html:'';if(options.bgPos){var bgPos=L.point(options.bgPos);div.style.backgroundPosition=-bgPos.x+'px '+-bgPos.y+'px';}
this._setIconStyles(div,'icon');return div;},createShadow:function createShadow(){return null;}});L.divIcon=function(options){return new L.DivIcon(options);};L.DivOverlay=L.Layer.extend({options:{offset:[0,7],className:'',pane:'popupPane'},initialize:function initialize(options,source){L.setOptions(this,options);this._source=source;},onAdd:function onAdd(map){this._zoomAnimated=map._zoomAnimated;if(!this._container){this._initLayout();}
if(map._fadeAnimated){L.DomUtil.setOpacity(this._container,0);}
clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();if(map._fadeAnimated){L.DomUtil.setOpacity(this._container,1);}
this.bringToFront();},onRemove:function onRemove(map){if(map._fadeAnimated){L.DomUtil.setOpacity(this._container,0);this._removeTimeout=setTimeout(L.bind(L.DomUtil.remove,L.DomUtil,this._container),200);}else{L.DomUtil.remove(this._container);}},getLatLng:function getLatLng(){return this._latlng;},setLatLng:function setLatLng(latlng){this._latlng=L.latLng(latlng);if(this._map){this._updatePosition();this._adjustPan();}
return this;},getContent:function getContent(){return this._content;},setContent:function setContent(content){this._content=content;this.update();return this;},getElement:function getElement(){return this._container;},update:function update(){if(!this._map){return;}
this._container.style.visibility='hidden';this._updateContent();this._updateLayout();this._updatePosition();this._container.style.visibility='';this._adjustPan();},getEvents:function getEvents(){var events={zoom:this._updatePosition,viewreset:this._updatePosition};if(this._zoomAnimated){events.zoomanim=this._animateZoom;}
return events;},isOpen:function isOpen(){return!!this._map&&this._map.hasLayer(this);},bringToFront:function bringToFront(){if(this._map){L.DomUtil.toFront(this._container);}
return this;},bringToBack:function bringToBack(){if(this._map){L.DomUtil.toBack(this._container);}
return this;},_updateContent:function _updateContent(){if(!this._content){return;}
var node=this._contentNode;var content=typeof this._content==='function'?this._content(this._source||this):this._content;if(typeof content==='string'){node.innerHTML=content;}else{while(node.hasChildNodes()){node.removeChild(node.firstChild);}
node.appendChild(content);}
this.fire('contentupdate');},_updatePosition:function _updatePosition(){if(!this._map){return;}
var pos=this._map.latLngToLayerPoint(this._latlng),offset=L.point(this.options.offset),anchor=this._getAnchor();if(this._zoomAnimated){L.DomUtil.setPosition(this._container,pos.add(anchor));}else{offset=offset.add(pos).add(anchor);}
var bottom=this._containerBottom=-offset.y,left=this._containerLeft=-Math.round(this._containerWidth/2)+offset.x;this._container.style.bottom=bottom+'px';this._container.style.left=left+'px';},_getAnchor:function _getAnchor(){return[0,0];}});L.Popup=L.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:true,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:false,closeButton:true,autoClose:true,className:''},openOn:function openOn(map){map.openPopup(this);return this;},onAdd:function onAdd(map){L.DivOverlay.prototype.onAdd.call(this,map);map.fire('popupopen',{popup:this});if(this._source){this._source.fire('popupopen',{popup:this},true);if(!(this._source instanceof L.Path)){this._source.on('preclick',L.DomEvent.stopPropagation);}}},onRemove:function onRemove(map){L.DivOverlay.prototype.onRemove.call(this,map);map.fire('popupclose',{popup:this});if(this._source){this._source.fire('popupclose',{popup:this},true);if(!(this._source instanceof L.Path)){this._source.off('preclick',L.DomEvent.stopPropagation);}}},getEvents:function getEvents(){var events=L.DivOverlay.prototype.getEvents.call(this);if('closeOnClick'in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick){events.preclick=this._close;}
if(this.options.keepInView){events.moveend=this._adjustPan;}
return events;},_close:function _close(){if(this._map){this._map.closePopup(this);}},_initLayout:function _initLayout(){var prefix='leaflet-popup',container=this._container=L.DomUtil.create('div',prefix+' '+(this.options.className||'')+' leaflet-zoom-animated');if(this.options.closeButton){var closeButton=this._closeButton=L.DomUtil.create('a',prefix+'-close-button',container);closeButton.href='#close';closeButton.innerHTML='&#215;';L.DomEvent.on(closeButton,'click',this._onCloseButtonClick,this);}
var wrapper=this._wrapper=L.DomUtil.create('div',prefix+'-content-wrapper',container);this._contentNode=L.DomUtil.create('div',prefix+'-content',wrapper);L.DomEvent.disableClickPropagation(wrapper).disableScrollPropagation(this._contentNode).on(wrapper,'contextmenu',L.DomEvent.stopPropagation);this._tipContainer=L.DomUtil.create('div',prefix+'-tip-container',container);this._tip=L.DomUtil.create('div',prefix+'-tip',this._tipContainer);},_updateLayout:function _updateLayout(){var container=this._contentNode,style=container.style;style.width='';style.whiteSpace='nowrap';var width=container.offsetWidth;width=Math.min(width,this.options.maxWidth);width=Math.max(width,this.options.minWidth);style.width=width+1+'px';style.whiteSpace='';style.height='';var height=container.offsetHeight,maxHeight=this.options.maxHeight,scrolledClass='leaflet-popup-scrolled';if(maxHeight&&height>maxHeight){style.height=maxHeight+'px';L.DomUtil.addClass(container,scrolledClass);}else{L.DomUtil.removeClass(container,scrolledClass);}
this._containerWidth=this._container.offsetWidth;},_animateZoom:function _animateZoom(e){var pos=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),anchor=this._getAnchor();L.DomUtil.setPosition(this._container,pos.add(anchor));},_adjustPan:function _adjustPan(){if(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress){return;}
var map=this._map,marginBottom=parseInt(L.DomUtil.getStyle(this._container,'marginBottom'),10)||0,containerHeight=this._container.offsetHeight+marginBottom,containerWidth=this._containerWidth,layerPos=new L.Point(this._containerLeft,-containerHeight-this._containerBottom);layerPos._add(L.DomUtil.getPosition(this._container));var containerPos=map.layerPointToContainerPoint(layerPos),padding=L.point(this.options.autoPanPadding),paddingTL=L.point(this.options.autoPanPaddingTopLeft||padding),paddingBR=L.point(this.options.autoPanPaddingBottomRight||padding),size=map.getSize(),dx=0,dy=0;if(containerPos.x+containerWidth+paddingBR.x>size.x){dx=containerPos.x+containerWidth-size.x+paddingBR.x;}
if(containerPos.x-dx-paddingTL.x<0){dx=containerPos.x-paddingTL.x;}
if(containerPos.y+containerHeight+paddingBR.y>size.y){dy=containerPos.y+containerHeight-size.y+paddingBR.y;}
if(containerPos.y-dy-paddingTL.y<0){dy=containerPos.y-paddingTL.y;}
if(dx||dy){map.fire('autopanstart').panBy([dx,dy]);}},_onCloseButtonClick:function _onCloseButtonClick(e){this._close();L.DomEvent.stop(e);},_getAnchor:function _getAnchor(){return L.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0]);}});L.popup=function(options,source){return new L.Popup(options,source);};L.Map.mergeOptions({closePopupOnClick:true});L.Map.include({openPopup:function openPopup(popup,latlng,options){if(!(popup instanceof L.Popup)){popup=new L.Popup(options).setContent(popup);}
if(latlng){popup.setLatLng(latlng);}
if(this.hasLayer(popup)){return this;}
if(this._popup&&this._popup.options.autoClose){this.closePopup();}
this._popup=popup;return this.addLayer(popup);},closePopup:function closePopup(popup){if(!popup||popup===this._popup){popup=this._popup;this._popup=null;}
if(popup){this.removeLayer(popup);}
return this;}});L.Layer.include({bindPopup:function bindPopup(content,options){if(content instanceof L.Popup){L.setOptions(content,options);this._popup=content;content._source=this;}else{if(!this._popup||options){this._popup=new L.Popup(options,this);}
this._popup.setContent(content);}
if(!this._popupHandlersAdded){this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup});this._popupHandlersAdded=true;}
return this;},unbindPopup:function unbindPopup(){if(this._popup){this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup});this._popupHandlersAdded=false;this._popup=null;}
return this;},openPopup:function openPopup(layer,latlng){if(!(layer instanceof L.Layer)){latlng=layer;layer=this;}
if(layer instanceof L.FeatureGroup){for(var id in this._layers){layer=this._layers[id];break;}}
if(!latlng){latlng=layer.getCenter?layer.getCenter():layer.getLatLng();}
if(this._popup&&this._map){this._popup._source=layer;this._popup.update();this._map.openPopup(this._popup,latlng);}
return this;},closePopup:function closePopup(){if(this._popup){this._popup._close();}
return this;},togglePopup:function togglePopup(target){if(this._popup){if(this._popup._map){this.closePopup();}else{this.openPopup(target);}}
return this;},isPopupOpen:function isPopupOpen(){return this._popup?this._popup.isOpen():false;},setPopupContent:function setPopupContent(content){if(this._popup){this._popup.setContent(content);}
return this;},getPopup:function getPopup(){return this._popup;},_openPopup:function _openPopup(e){var layer=e.layer||e.target;if(!this._popup){return;}
if(!this._map){return;}
L.DomEvent.stop(e);if(layer instanceof L.Path){this.openPopup(e.layer||e.target,e.latlng);return;}
if(this._map.hasLayer(this._popup)&&this._popup._source===layer){this.closePopup();}else{this.openPopup(layer,e.latlng);}},_movePopup:function _movePopup(e){this._popup.setLatLng(e.latlng);}});L.Tooltip=L.DivOverlay.extend({options:{pane:'tooltipPane',offset:[0,0],direction:'auto',permanent:false,sticky:false,interactive:false,opacity:0.9},onAdd:function onAdd(map){L.DivOverlay.prototype.onAdd.call(this,map);this.setOpacity(this.options.opacity);map.fire('tooltipopen',{tooltip:this});if(this._source){this._source.fire('tooltipopen',{tooltip:this},true);}},onRemove:function onRemove(map){L.DivOverlay.prototype.onRemove.call(this,map);map.fire('tooltipclose',{tooltip:this});if(this._source){this._source.fire('tooltipclose',{tooltip:this},true);}},getEvents:function getEvents(){var events=L.DivOverlay.prototype.getEvents.call(this);if(L.Browser.touch&&!this.options.permanent){events.preclick=this._close;}
return events;},_close:function _close(){if(this._map){this._map.closeTooltip(this);}},_initLayout:function _initLayout(){var prefix='leaflet-tooltip',className=prefix+' '+(this.options.className||'')+' leaflet-zoom-'+(this._zoomAnimated?'animated':'hide');this._contentNode=this._container=L.DomUtil.create('div',className);},_updateLayout:function _updateLayout(){},_adjustPan:function _adjustPan(){},_setPosition:function _setPosition(pos){var map=this._map,container=this._container,centerPoint=map.latLngToContainerPoint(map.getCenter()),tooltipPoint=map.layerPointToContainerPoint(pos),direction=this.options.direction,tooltipWidth=container.offsetWidth,tooltipHeight=container.offsetHeight,offset=L.point(this.options.offset),anchor=this._getAnchor();if(direction==='top'){pos=pos.add(L.point(-tooltipWidth/2+offset.x,-tooltipHeight+offset.y+anchor.y,true));}else if(direction==='bottom'){pos=pos.subtract(L.point(tooltipWidth/2-offset.x,-offset.y,true));}else if(direction==='center'){pos=pos.subtract(L.point(tooltipWidth/2+offset.x,tooltipHeight/2-anchor.y+offset.y,true));}else if(direction==='right'||direction==='auto'&&tooltipPoint.x<centerPoint.x){direction='right';pos=pos.add(L.point(offset.x+anchor.x,anchor.y-tooltipHeight/2+offset.y,true));}else{direction='left';pos=pos.subtract(L.point(tooltipWidth+anchor.x-offset.x,tooltipHeight/2-anchor.y-offset.y,true));}
L.DomUtil.removeClass(container,'leaflet-tooltip-right');L.DomUtil.removeClass(container,'leaflet-tooltip-left');L.DomUtil.removeClass(container,'leaflet-tooltip-top');L.DomUtil.removeClass(container,'leaflet-tooltip-bottom');L.DomUtil.addClass(container,'leaflet-tooltip-'+direction);L.DomUtil.setPosition(container,pos);},_updatePosition:function _updatePosition(){var pos=this._map.latLngToLayerPoint(this._latlng);this._setPosition(pos);},setOpacity:function setOpacity(opacity){this.options.opacity=opacity;if(this._container){L.DomUtil.setOpacity(this._container,opacity);}},_animateZoom:function _animateZoom(e){var pos=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(pos);},_getAnchor:function _getAnchor(){return L.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0]);}});L.tooltip=function(options,source){return new L.Tooltip(options,source);};L.Map.include({openTooltip:function openTooltip(tooltip,latlng,options){if(!(tooltip instanceof L.Tooltip)){tooltip=new L.Tooltip(options).setContent(tooltip);}
if(latlng){tooltip.setLatLng(latlng);}
if(this.hasLayer(tooltip)){return this;}
return this.addLayer(tooltip);},closeTooltip:function closeTooltip(tooltip){if(tooltip){this.removeLayer(tooltip);}
return this;}});L.Layer.include({bindTooltip:function bindTooltip(content,options){if(content instanceof L.Tooltip){L.setOptions(content,options);this._tooltip=content;content._source=this;}else{if(!this._tooltip||options){this._tooltip=L.tooltip(options,this);}
this._tooltip.setContent(content);}
this._initTooltipInteractions();if(this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)){this.openTooltip();}
return this;},unbindTooltip:function unbindTooltip(){if(this._tooltip){this._initTooltipInteractions(true);this.closeTooltip();this._tooltip=null;}
return this;},_initTooltipInteractions:function _initTooltipInteractions(remove){if(!remove&&this._tooltipHandlersAdded){return;}
var onOff=remove?'off':'on',events={remove:this.closeTooltip,move:this._moveTooltip};if(!this._tooltip.options.permanent){events.mouseover=this._openTooltip;events.mouseout=this.closeTooltip;if(this._tooltip.options.sticky){events.mousemove=this._moveTooltip;}
if(L.Browser.touch){events.click=this._openTooltip;}}else{events.add=this._openTooltip;}
this[onOff](events);this._tooltipHandlersAdded=!remove;},openTooltip:function openTooltip(layer,latlng){if(!(layer instanceof L.Layer)){latlng=layer;layer=this;}
if(layer instanceof L.FeatureGroup){for(var id in this._layers){layer=this._layers[id];break;}}
if(!latlng){latlng=layer.getCenter?layer.getCenter():layer.getLatLng();}
if(this._tooltip&&this._map){this._tooltip._source=layer;this._tooltip.update();this._map.openTooltip(this._tooltip,latlng);if(this._tooltip.options.interactive&&this._tooltip._container){L.DomUtil.addClass(this._tooltip._container,'leaflet-clickable');this.addInteractiveTarget(this._tooltip._container);}}
return this;},closeTooltip:function closeTooltip(){if(this._tooltip){this._tooltip._close();if(this._tooltip.options.interactive&&this._tooltip._container){L.DomUtil.removeClass(this._tooltip._container,'leaflet-clickable');this.removeInteractiveTarget(this._tooltip._container);}}
return this;},toggleTooltip:function toggleTooltip(target){if(this._tooltip){if(this._tooltip._map){this.closeTooltip();}else{this.openTooltip(target);}}
return this;},isTooltipOpen:function isTooltipOpen(){return this._tooltip.isOpen();},setTooltipContent:function setTooltipContent(content){if(this._tooltip){this._tooltip.setContent(content);}
return this;},getTooltip:function getTooltip(){return this._tooltip;},_openTooltip:function _openTooltip(e){var layer=e.layer||e.target;if(!this._tooltip||!this._map){return;}
this.openTooltip(layer,this._tooltip.options.sticky?e.latlng:undefined);},_moveTooltip:function _moveTooltip(e){var latlng=e.latlng,containerPoint,layerPoint;if(this._tooltip.options.sticky&&e.originalEvent){containerPoint=this._map.mouseEventToContainerPoint(e.originalEvent);layerPoint=this._map.containerPointToLayerPoint(containerPoint);latlng=this._map.layerPointToLatLng(layerPoint);}
this._tooltip.setLatLng(latlng);}});L.LayerGroup=L.Layer.extend({initialize:function initialize(layers){this._layers={};var i,len;if(layers){for(i=0,len=layers.length;i<len;i++){this.addLayer(layers[i]);}}},addLayer:function addLayer(layer){var id=this.getLayerId(layer);this._layers[id]=layer;if(this._map){this._map.addLayer(layer);}
return this;},removeLayer:function removeLayer(layer){var id=layer in this._layers?layer:this.getLayerId(layer);if(this._map&&this._layers[id]){this._map.removeLayer(this._layers[id]);}
delete this._layers[id];return this;},hasLayer:function hasLayer(layer){return!!layer&&(layer in this._layers||this.getLayerId(layer)in this._layers);},clearLayers:function clearLayers(){for(var i in this._layers){this.removeLayer(this._layers[i]);}
return this;},invoke:function invoke(methodName){var args=Array.prototype.slice.call(arguments,1),i,layer;for(i in this._layers){layer=this._layers[i];if(layer[methodName]){layer[methodName].apply(layer,args);}}
return this;},onAdd:function onAdd(map){for(var i in this._layers){map.addLayer(this._layers[i]);}},onRemove:function onRemove(map){for(var i in this._layers){map.removeLayer(this._layers[i]);}},eachLayer:function eachLayer(method,context){for(var i in this._layers){method.call(context,this._layers[i]);}
return this;},getLayer:function getLayer(id){return this._layers[id];},getLayers:function getLayers(){var layers=[];for(var i in this._layers){layers.push(this._layers[i]);}
return layers;},setZIndex:function setZIndex(zIndex){return this.invoke('setZIndex',zIndex);},getLayerId:function getLayerId(layer){return L.stamp(layer);}});L.layerGroup=function(layers){return new L.LayerGroup(layers);};L.FeatureGroup=L.LayerGroup.extend({addLayer:function addLayer(layer){if(this.hasLayer(layer)){return this;}
layer.addEventParent(this);L.LayerGroup.prototype.addLayer.call(this,layer);return this.fire('layeradd',{layer:layer});},removeLayer:function removeLayer(layer){if(!this.hasLayer(layer)){return this;}
if(layer in this._layers){layer=this._layers[layer];}
layer.removeEventParent(this);L.LayerGroup.prototype.removeLayer.call(this,layer);return this.fire('layerremove',{layer:layer});},setStyle:function setStyle(style){return this.invoke('setStyle',style);},bringToFront:function bringToFront(){return this.invoke('bringToFront');},bringToBack:function bringToBack(){return this.invoke('bringToBack');},getBounds:function getBounds(){var bounds=new L.LatLngBounds();for(var id in this._layers){var layer=this._layers[id];bounds.extend(layer.getBounds?layer.getBounds():layer.getLatLng());}
return bounds;}});L.featureGroup=function(layers){return new L.FeatureGroup(layers);};L.Renderer=L.Layer.extend({options:{padding:0.1},initialize:function initialize(options){L.setOptions(this,options);L.stamp(this);this._layers=this._layers||{};},onAdd:function onAdd(){if(!this._container){this._initContainer();if(this._zoomAnimated){L.DomUtil.addClass(this._container,'leaflet-zoom-animated');}}
this.getPane().appendChild(this._container);this._update();this.on('update',this._updatePaths,this);},onRemove:function onRemove(){L.DomUtil.remove(this._container);this.off('update',this._updatePaths,this);},getEvents:function getEvents(){var events={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};if(this._zoomAnimated){events.zoomanim=this._onAnimZoom;}
return events;},_onAnimZoom:function _onAnimZoom(ev){this._updateTransform(ev.center,ev.zoom);},_onZoom:function _onZoom(){this._updateTransform(this._map.getCenter(),this._map.getZoom());},_updateTransform:function _updateTransform(center,zoom){var scale=this._map.getZoomScale(zoom,this._zoom),position=L.DomUtil.getPosition(this._container),viewHalf=this._map.getSize().multiplyBy(0.5+this.options.padding),currentCenterPoint=this._map.project(this._center,zoom),destCenterPoint=this._map.project(center,zoom),centerOffset=destCenterPoint.subtract(currentCenterPoint),topLeftOffset=viewHalf.multiplyBy(-scale).add(position).add(viewHalf).subtract(centerOffset);if(L.Browser.any3d){L.DomUtil.setTransform(this._container,topLeftOffset,scale);}else{L.DomUtil.setPosition(this._container,topLeftOffset);}},_reset:function _reset(){this._update();this._updateTransform(this._center,this._zoom);for(var id in this._layers){this._layers[id]._reset();}},_onZoomEnd:function _onZoomEnd(){for(var id in this._layers){this._layers[id]._project();}},_updatePaths:function _updatePaths(){for(var id in this._layers){this._layers[id]._update();}},_update:function _update(){var p=this.options.padding,size=this._map.getSize(),min=this._map.containerPointToLayerPoint(size.multiplyBy(-p)).round();this._bounds=new L.Bounds(min,min.add(size.multiplyBy(1+p*2)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom();}});L.Map.include({getRenderer:function getRenderer(layer){var renderer=layer.options.renderer||this._getPaneRenderer(layer.options.pane)||this.options.renderer||this._renderer;if(!renderer){renderer=this._renderer=this.options.preferCanvas&&L.canvas()||L.svg();}
if(!this.hasLayer(renderer)){this.addLayer(renderer);}
return renderer;},_getPaneRenderer:function _getPaneRenderer(name){if(name==='overlayPane'||name===undefined){return false;}
var renderer=this._paneRenderers[name];if(renderer===undefined){renderer=L.SVG&&L.svg({pane:name})||L.Canvas&&L.canvas({pane:name});this._paneRenderers[name]=renderer;}
return renderer;}});L.Path=L.Layer.extend({options:{stroke:true,color:'#3388ff',weight:3,opacity:1,lineCap:'round',lineJoin:'round',dashArray:null,dashOffset:null,fill:false,fillColor:null,fillOpacity:0.2,fillRule:'evenodd',interactive:true},beforeAdd:function beforeAdd(map){this._renderer=map.getRenderer(this);},onAdd:function onAdd(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this);},onRemove:function onRemove(){this._renderer._removePath(this);},redraw:function redraw(){if(this._map){this._renderer._updatePath(this);}
return this;},setStyle:function setStyle(style){L.setOptions(this,style);if(this._renderer){this._renderer._updateStyle(this);}
return this;},bringToFront:function bringToFront(){if(this._renderer){this._renderer._bringToFront(this);}
return this;},bringToBack:function bringToBack(){if(this._renderer){this._renderer._bringToBack(this);}
return this;},getElement:function getElement(){return this._path;},_reset:function _reset(){this._project();this._update();},_clickTolerance:function _clickTolerance(){return(this.options.stroke?this.options.weight/2:0)+(L.Browser.touch?10:0);}});L.LineUtil={simplify:function simplify(points,tolerance){if(!tolerance||!points.length){return points.slice();}
var sqTolerance=tolerance*tolerance;points=this._reducePoints(points,sqTolerance);points=this._simplifyDP(points,sqTolerance);return points;},pointToSegmentDistance:function pointToSegmentDistance(p,p1,p2){return Math.sqrt(this._sqClosestPointOnSegment(p,p1,p2,true));},closestPointOnSegment:function closestPointOnSegment(p,p1,p2){return this._sqClosestPointOnSegment(p,p1,p2);},_simplifyDP:function _simplifyDP(points,sqTolerance){var len=points.length,ArrayConstructor=typeof Uint8Array!==undefined+''?Uint8Array:Array,markers=new ArrayConstructor(len);markers[0]=markers[len-1]=1;this._simplifyDPStep(points,markers,sqTolerance,0,len-1);var i,newPoints=[];for(i=0;i<len;i++){if(markers[i]){newPoints.push(points[i]);}}
return newPoints;},_simplifyDPStep:function _simplifyDPStep(points,markers,sqTolerance,first,last){var maxSqDist=0,index,i,sqDist;for(i=first+1;i<=last-1;i++){sqDist=this._sqClosestPointOnSegment(points[i],points[first],points[last],true);if(sqDist>maxSqDist){index=i;maxSqDist=sqDist;}}
if(maxSqDist>sqTolerance){markers[index]=1;this._simplifyDPStep(points,markers,sqTolerance,first,index);this._simplifyDPStep(points,markers,sqTolerance,index,last);}},_reducePoints:function _reducePoints(points,sqTolerance){var reducedPoints=[points[0]];for(var i=1,prev=0,len=points.length;i<len;i++){if(this._sqDist(points[i],points[prev])>sqTolerance){reducedPoints.push(points[i]);prev=i;}}
if(prev<len-1){reducedPoints.push(points[len-1]);}
return reducedPoints;},clipSegment:function clipSegment(a,b,bounds,useLastCode,round){var codeA=useLastCode?this._lastCode:this._getBitCode(a,bounds),codeB=this._getBitCode(b,bounds),codeOut,p,newCode;this._lastCode=codeB;while(true){if(!(codeA|codeB)){return[a,b];}
if(codeA&codeB){return false;}
codeOut=codeA||codeB;p=this._getEdgeIntersection(a,b,codeOut,bounds,round);newCode=this._getBitCode(p,bounds);if(codeOut===codeA){a=p;codeA=newCode;}else{b=p;codeB=newCode;}}},_getEdgeIntersection:function _getEdgeIntersection(a,b,code,bounds,round){var dx=b.x-a.x,dy=b.y-a.y,min=bounds.min,max=bounds.max,x,y;if(code&8){x=a.x+dx*(max.y-a.y)/dy;y=max.y;}else if(code&4){x=a.x+dx*(min.y-a.y)/dy;y=min.y;}else if(code&2){x=max.x;y=a.y+dy*(max.x-a.x)/dx;}else if(code&1){x=min.x;y=a.y+dy*(min.x-a.x)/dx;}
return new L.Point(x,y,round);},_getBitCode:function _getBitCode(p,bounds){var code=0;if(p.x<bounds.min.x){code|=1;}else if(p.x>bounds.max.x){code|=2;}
if(p.y<bounds.min.y){code|=4;}else if(p.y>bounds.max.y){code|=8;}
return code;},_sqDist:function _sqDist(p1,p2){var dx=p2.x-p1.x,dy=p2.y-p1.y;return dx*dx+dy*dy;},_sqClosestPointOnSegment:function _sqClosestPointOnSegment(p,p1,p2,sqDist){var x=p1.x,y=p1.y,dx=p2.x-x,dy=p2.y-y,dot=dx*dx+dy*dy,t;if(dot>0){t=((p.x-x)*dx+(p.y-y)*dy)/dot;if(t>1){x=p2.x;y=p2.y;}else if(t>0){x+=dx*t;y+=dy*t;}}
dx=p.x-x;dy=p.y-y;return sqDist?dx*dx+dy*dy:new L.Point(x,y);}};L.Polyline=L.Path.extend({options:{smoothFactor:1.0,noClip:false},initialize:function initialize(latlngs,options){L.setOptions(this,options);this._setLatLngs(latlngs);},getLatLngs:function getLatLngs(){return this._latlngs;},setLatLngs:function setLatLngs(latlngs){this._setLatLngs(latlngs);return this.redraw();},isEmpty:function isEmpty(){return!this._latlngs.length;},closestLayerPoint:function closestLayerPoint(p){var minDistance=Infinity,minPoint=null,closest=L.LineUtil._sqClosestPointOnSegment,p1,p2;for(var j=0,jLen=this._parts.length;j<jLen;j++){var points=this._parts[j];for(var i=1,len=points.length;i<len;i++){p1=points[i-1];p2=points[i];var sqDist=closest(p,p1,p2,true);if(sqDist<minDistance){minDistance=sqDist;minPoint=closest(p,p1,p2);}}}
if(minPoint){minPoint.distance=Math.sqrt(minDistance);}
return minPoint;},getCenter:function getCenter(){if(!this._map){throw new Error('Must add layer to map before using getCenter()');}
var i,halfDist,segDist,dist,p1,p2,ratio,points=this._rings[0],len=points.length;if(!len){return null;}
for(i=0,halfDist=0;i<len-1;i++){halfDist+=points[i].distanceTo(points[i+1])/2;}
if(halfDist===0){return this._map.layerPointToLatLng(points[0]);}
for(i=0,dist=0;i<len-1;i++){p1=points[i];p2=points[i+1];segDist=p1.distanceTo(p2);dist+=segDist;if(dist>halfDist){ratio=(dist-halfDist)/segDist;return this._map.layerPointToLatLng([p2.x-ratio*(p2.x-p1.x),p2.y-ratio*(p2.y-p1.y)]);}}},getBounds:function getBounds(){return this._bounds;},addLatLng:function addLatLng(latlng,latlngs){latlngs=latlngs||this._defaultShape();latlng=L.latLng(latlng);latlngs.push(latlng);this._bounds.extend(latlng);return this.redraw();},_setLatLngs:function _setLatLngs(latlngs){this._bounds=new L.LatLngBounds();this._latlngs=this._convertLatLngs(latlngs);},_defaultShape:function _defaultShape(){return L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0];},_convertLatLngs:function _convertLatLngs(latlngs){var result=[],flat=L.Polyline._flat(latlngs);for(var i=0,len=latlngs.length;i<len;i++){if(flat){result[i]=L.latLng(latlngs[i]);this._bounds.extend(result[i]);}else{result[i]=this._convertLatLngs(latlngs[i]);}}
return result;},_project:function _project(){var pxBounds=new L.Bounds();this._rings=[];this._projectLatlngs(this._latlngs,this._rings,pxBounds);var w=this._clickTolerance(),p=new L.Point(w,w);if(this._bounds.isValid()&&pxBounds.isValid()){pxBounds.min._subtract(p);pxBounds.max._add(p);this._pxBounds=pxBounds;}},_projectLatlngs:function _projectLatlngs(latlngs,result,projectedBounds){var flat=latlngs[0]instanceof L.LatLng,len=latlngs.length,i,ring;if(flat){ring=[];for(i=0;i<len;i++){ring[i]=this._map.latLngToLayerPoint(latlngs[i]);projectedBounds.extend(ring[i]);}
result.push(ring);}else{for(i=0;i<len;i++){this._projectLatlngs(latlngs[i],result,projectedBounds);}}},_clipPoints:function _clipPoints(){var bounds=this._renderer._bounds;this._parts=[];if(!this._pxBounds||!this._pxBounds.intersects(bounds)){return;}
if(this.options.noClip){this._parts=this._rings;return;}
var parts=this._parts,i,j,k,len,len2,segment,points;for(i=0,k=0,len=this._rings.length;i<len;i++){points=this._rings[i];for(j=0,len2=points.length;j<len2-1;j++){segment=L.LineUtil.clipSegment(points[j],points[j+1],bounds,j,true);if(!segment){continue;}
parts[k]=parts[k]||[];parts[k].push(segment[0]);if(segment[1]!==points[j+1]||j===len2-2){parts[k].push(segment[1]);k++;}}}},_simplifyPoints:function _simplifyPoints(){var parts=this._parts,tolerance=this.options.smoothFactor;for(var i=0,len=parts.length;i<len;i++){parts[i]=L.LineUtil.simplify(parts[i],tolerance);}},_update:function _update(){if(!this._map){return;}
this._clipPoints();this._simplifyPoints();this._updatePath();},_updatePath:function _updatePath(){this._renderer._updatePoly(this);}});L.polyline=function(latlngs,options){return new L.Polyline(latlngs,options);};L.Polyline._flat=function(latlngs){return!L.Util.isArray(latlngs[0])||typeof latlngs[0][0]!=='object'&&typeof latlngs[0][0]!=='undefined';};L.PolyUtil={};L.PolyUtil.clipPolygon=function(points,bounds,round){var clippedPoints,edges=[1,4,2,8],i,j,k,a,b,len,edge,p,lu=L.LineUtil;for(i=0,len=points.length;i<len;i++){points[i]._code=lu._getBitCode(points[i],bounds);}
for(k=0;k<4;k++){edge=edges[k];clippedPoints=[];for(i=0,len=points.length,j=len-1;i<len;j=i++){a=points[i];b=points[j];if(!(a._code&edge)){if(b._code&edge){p=lu._getEdgeIntersection(b,a,edge,bounds,round);p._code=lu._getBitCode(p,bounds);clippedPoints.push(p);}
clippedPoints.push(a);}else if(!(b._code&edge)){p=lu._getEdgeIntersection(b,a,edge,bounds,round);p._code=lu._getBitCode(p,bounds);clippedPoints.push(p);}}
points=clippedPoints;}
return points;};L.Polygon=L.Polyline.extend({options:{fill:true},isEmpty:function isEmpty(){return!this._latlngs.length||!this._latlngs[0].length;},getCenter:function getCenter(){if(!this._map){throw new Error('Must add layer to map before using getCenter()');}
var i,j,p1,p2,f,area,x,y,center,points=this._rings[0],len=points.length;if(!len){return null;}
area=x=y=0;for(i=0,j=len-1;i<len;j=i++){p1=points[i];p2=points[j];f=p1.y*p2.x-p2.y*p1.x;x+=(p1.x+p2.x)*f;y+=(p1.y+p2.y)*f;area+=f*3;}
if(area===0){center=points[0];}else{center=[x/area,y/area];}
return this._map.layerPointToLatLng(center);},_convertLatLngs:function _convertLatLngs(latlngs){var result=L.Polyline.prototype._convertLatLngs.call(this,latlngs),len=result.length;if(len>=2&&result[0]instanceof L.LatLng&&result[0].equals(result[len-1])){result.pop();}
return result;},_setLatLngs:function _setLatLngs(latlngs){L.Polyline.prototype._setLatLngs.call(this,latlngs);if(L.Polyline._flat(this._latlngs)){this._latlngs=[this._latlngs];}},_defaultShape:function _defaultShape(){return L.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0];},_clipPoints:function _clipPoints(){var bounds=this._renderer._bounds,w=this.options.weight,p=new L.Point(w,w);bounds=new L.Bounds(bounds.min.subtract(p),bounds.max.add(p));this._parts=[];if(!this._pxBounds||!this._pxBounds.intersects(bounds)){return;}
if(this.options.noClip){this._parts=this._rings;return;}
for(var i=0,len=this._rings.length,clipped;i<len;i++){clipped=L.PolyUtil.clipPolygon(this._rings[i],bounds,true);if(clipped.length){this._parts.push(clipped);}}},_updatePath:function _updatePath(){this._renderer._updatePoly(this,true);}});L.polygon=function(latlngs,options){return new L.Polygon(latlngs,options);};L.Rectangle=L.Polygon.extend({initialize:function initialize(latLngBounds,options){L.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(latLngBounds),options);},setBounds:function setBounds(latLngBounds){return this.setLatLngs(this._boundsToLatLngs(latLngBounds));},_boundsToLatLngs:function _boundsToLatLngs(latLngBounds){latLngBounds=L.latLngBounds(latLngBounds);return[latLngBounds.getSouthWest(),latLngBounds.getNorthWest(),latLngBounds.getNorthEast(),latLngBounds.getSouthEast()];}});L.rectangle=function(latLngBounds,options){return new L.Rectangle(latLngBounds,options);};L.CircleMarker=L.Path.extend({options:{fill:true,radius:10},initialize:function initialize(latlng,options){L.setOptions(this,options);this._latlng=L.latLng(latlng);this._radius=this.options.radius;},setLatLng:function setLatLng(latlng){this._latlng=L.latLng(latlng);this.redraw();return this.fire('move',{latlng:this._latlng});},getLatLng:function getLatLng(){return this._latlng;},setRadius:function setRadius(radius){this.options.radius=this._radius=radius;return this.redraw();},getRadius:function getRadius(){return this._radius;},setStyle:function setStyle(options){var radius=options&&options.radius||this._radius;L.Path.prototype.setStyle.call(this,options);this.setRadius(radius);return this;},_project:function _project(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds();},_updateBounds:function _updateBounds(){var r=this._radius,r2=this._radiusY||r,w=this._clickTolerance(),p=[r+w,r2+w];this._pxBounds=new L.Bounds(this._point.subtract(p),this._point.add(p));},_update:function _update(){if(this._map){this._updatePath();}},_updatePath:function _updatePath(){this._renderer._updateCircle(this);},_empty:function _empty(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds);}});L.circleMarker=function(latlng,options){return new L.CircleMarker(latlng,options);};L.Circle=L.CircleMarker.extend({initialize:function initialize(latlng,options,legacyOptions){if(typeof options==='number'){options=L.extend({},legacyOptions,{radius:options});}
L.setOptions(this,options);this._latlng=L.latLng(latlng);if(isNaN(this.options.radius)){throw new Error('Circle radius cannot be NaN');}
this._mRadius=this.options.radius;},setRadius:function setRadius(radius){this._mRadius=radius;return this.redraw();},getRadius:function getRadius(){return this._mRadius;},getBounds:function getBounds(){var half=[this._radius,this._radiusY||this._radius];return new L.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(half)),this._map.layerPointToLatLng(this._point.add(half)));},setStyle:L.Path.prototype.setStyle,_project:function _project(){var lng=this._latlng.lng,lat=this._latlng.lat,map=this._map,crs=map.options.crs;if(crs.distance===L.CRS.Earth.distance){var d=Math.PI/180,latR=this._mRadius/L.CRS.Earth.R/d,top=map.project([lat+latR,lng]),bottom=map.project([lat-latR,lng]),p=top.add(bottom).divideBy(2),lat2=map.unproject(p).lat,lngR=Math.acos((Math.cos(latR*d)-Math.sin(lat*d)*Math.sin(lat2*d))/(Math.cos(lat*d)*Math.cos(lat2*d)))/d;if(isNaN(lngR)||lngR===0){lngR=latR/Math.cos(Math.PI/180*lat);}
this._point=p.subtract(map.getPixelOrigin());this._radius=isNaN(lngR)?0:Math.max(Math.round(p.x-map.project([lat2,lng-lngR]).x),1);this._radiusY=Math.max(Math.round(p.y-top.y),1);}else{var latlng2=crs.unproject(crs.project(this._latlng).subtract([this._mRadius,0]));this._point=map.latLngToLayerPoint(this._latlng);this._radius=this._point.x-map.latLngToLayerPoint(latlng2).x;}
this._updateBounds();}});L.circle=function(latlng,options,legacyOptions){return new L.Circle(latlng,options,legacyOptions);};L.SVG=L.Renderer.extend({getEvents:function getEvents(){var events=L.Renderer.prototype.getEvents.call(this);events.zoomstart=this._onZoomStart;return events;},_initContainer:function _initContainer(){this._container=L.SVG.create('svg');this._container.setAttribute('pointer-events','none');this._rootGroup=L.SVG.create('g');this._container.appendChild(this._rootGroup);},_onZoomStart:function _onZoomStart(){this._update();},_update:function _update(){if(this._map._animatingZoom&&this._bounds){return;}
L.Renderer.prototype._update.call(this);var b=this._bounds,size=b.getSize(),container=this._container;if(!this._svgSize||!this._svgSize.equals(size)){this._svgSize=size;container.setAttribute('width',size.x);container.setAttribute('height',size.y);}
L.DomUtil.setPosition(container,b.min);container.setAttribute('viewBox',[b.min.x,b.min.y,size.x,size.y].join(' '));this.fire('update');},_initPath:function _initPath(layer){var path=layer._path=L.SVG.create('path');if(layer.options.className){L.DomUtil.addClass(path,layer.options.className);}
if(layer.options.interactive){L.DomUtil.addClass(path,'leaflet-interactive');}
this._updateStyle(layer);this._layers[L.stamp(layer)]=layer;},_addPath:function _addPath(layer){this._rootGroup.appendChild(layer._path);layer.addInteractiveTarget(layer._path);},_removePath:function _removePath(layer){L.DomUtil.remove(layer._path);layer.removeInteractiveTarget(layer._path);delete this._layers[L.stamp(layer)];},_updatePath:function _updatePath(layer){layer._project();layer._update();},_updateStyle:function _updateStyle(layer){var path=layer._path,options=layer.options;if(!path){return;}
if(options.stroke){path.setAttribute('stroke',options.color);path.setAttribute('stroke-opacity',options.opacity);path.setAttribute('stroke-width',options.weight);path.setAttribute('stroke-linecap',options.lineCap);path.setAttribute('stroke-linejoin',options.lineJoin);if(options.dashArray){path.setAttribute('stroke-dasharray',options.dashArray);}else{path.removeAttribute('stroke-dasharray');}
if(options.dashOffset){path.setAttribute('stroke-dashoffset',options.dashOffset);}else{path.removeAttribute('stroke-dashoffset');}}else{path.setAttribute('stroke','none');}
if(options.fill){path.setAttribute('fill',options.fillColor||options.color);path.setAttribute('fill-opacity',options.fillOpacity);path.setAttribute('fill-rule',options.fillRule||'evenodd');}else{path.setAttribute('fill','none');}},_updatePoly:function _updatePoly(layer,closed){this._setPath(layer,L.SVG.pointsToPath(layer._parts,closed));},_updateCircle:function _updateCircle(layer){var p=layer._point,r=layer._radius,r2=layer._radiusY||r,arc='a'+r+','+r2+' 0 1,0 ';var d=layer._empty()?'M0 0':'M'+(p.x-r)+','+p.y+arc+r*2+',0 '+arc+-r*2+',0 ';this._setPath(layer,d);},_setPath:function _setPath(layer,path){layer._path.setAttribute('d',path);},_bringToFront:function _bringToFront(layer){L.DomUtil.toFront(layer._path);},_bringToBack:function _bringToBack(layer){L.DomUtil.toBack(layer._path);}});L.extend(L.SVG,{create:function create(name){return document.createElementNS('http://www.w3.org/2000/svg',name);},pointsToPath:function pointsToPath(rings,closed){var str='',i,j,len,len2,points,p;for(i=0,len=rings.length;i<len;i++){points=rings[i];for(j=0,len2=points.length;j<len2;j++){p=points[j];str+=(j?'L':'M')+p.x+' '+p.y;}
str+=closed?L.Browser.svg?'z':'x':'';}
return str||'M0 0';}});L.Browser.svg=!!(document.createElementNS&&L.SVG.create('svg').createSVGRect);L.svg=function(options){return L.Browser.svg||L.Browser.vml?new L.SVG(options):null;};L.Browser.vml=!L.Browser.svg&&function(){try{var div=document.createElement('div');div.innerHTML='<v:shape adj="1"/>';var shape=div.firstChild;shape.style.behavior='url(#default#VML)';return shape&&typeof shape.adj==='object';}catch(e){return false;}}();L.SVG.include(!L.Browser.vml?{}:{_initContainer:function _initContainer(){this._container=L.DomUtil.create('div','leaflet-vml-container');},_update:function _update(){if(this._map._animatingZoom){return;}
L.Renderer.prototype._update.call(this);this.fire('update');},_initPath:function _initPath(layer){var container=layer._container=L.SVG.create('shape');L.DomUtil.addClass(container,'leaflet-vml-shape '+(this.options.className||''));container.coordsize='1 1';layer._path=L.SVG.create('path');container.appendChild(layer._path);this._updateStyle(layer);this._layers[L.stamp(layer)]=layer;},_addPath:function _addPath(layer){var container=layer._container;this._container.appendChild(container);if(layer.options.interactive){layer.addInteractiveTarget(container);}},_removePath:function _removePath(layer){var container=layer._container;L.DomUtil.remove(container);layer.removeInteractiveTarget(container);delete this._layers[L.stamp(layer)];},_updateStyle:function _updateStyle(layer){var stroke=layer._stroke,fill=layer._fill,options=layer.options,container=layer._container;container.stroked=!!options.stroke;container.filled=!!options.fill;if(options.stroke){if(!stroke){stroke=layer._stroke=L.SVG.create('stroke');}
container.appendChild(stroke);stroke.weight=options.weight+'px';stroke.color=options.color;stroke.opacity=options.opacity;if(options.dashArray){stroke.dashStyle=L.Util.isArray(options.dashArray)?options.dashArray.join(' '):options.dashArray.replace(/( *, *)/g,' ');}else{stroke.dashStyle='';}
stroke.endcap=options.lineCap.replace('butt','flat');stroke.joinstyle=options.lineJoin;}else if(stroke){container.removeChild(stroke);layer._stroke=null;}
if(options.fill){if(!fill){fill=layer._fill=L.SVG.create('fill');}
container.appendChild(fill);fill.color=options.fillColor||options.color;fill.opacity=options.fillOpacity;}else if(fill){container.removeChild(fill);layer._fill=null;}},_updateCircle:function _updateCircle(layer){var p=layer._point.round(),r=Math.round(layer._radius),r2=Math.round(layer._radiusY||r);this._setPath(layer,layer._empty()?'M0 0':'AL '+p.x+','+p.y+' '+r+','+r2+' 0,'+65535*360);},_setPath:function _setPath(layer,path){layer._path.v=path;},_bringToFront:function _bringToFront(layer){L.DomUtil.toFront(layer._container);},_bringToBack:function _bringToBack(layer){L.DomUtil.toBack(layer._container);}});if(L.Browser.vml){L.SVG.create=function(){try{document.namespaces.add('lvml','urn:schemas-microsoft-com:vml');return function(name){return document.createElement('<lvml:'+name+' class="lvml">');};}catch(e){return function(name){return document.createElement('<'+name+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">');};}}();}
L.Canvas=L.Renderer.extend({getEvents:function getEvents(){var events=L.Renderer.prototype.getEvents.call(this);events.viewprereset=this._onViewPreReset;return events;},_onViewPreReset:function _onViewPreReset(){this._postponeUpdatePaths=true;},onAdd:function onAdd(){L.Renderer.prototype.onAdd.call(this);this._draw();},_initContainer:function _initContainer(){var container=this._container=document.createElement('canvas');L.DomEvent.on(container,'mousemove',L.Util.throttle(this._onMouseMove,32,this),this).on(container,'click dblclick mousedown mouseup contextmenu',this._onClick,this).on(container,'mouseout',this._handleMouseOut,this);this._ctx=container.getContext('2d');},_updatePaths:function _updatePaths(){if(this._postponeUpdatePaths){return;}
var layer;this._redrawBounds=null;for(var id in this._layers){layer=this._layers[id];layer._update();}
this._redraw();},_update:function _update(){if(this._map._animatingZoom&&this._bounds){return;}
this._drawnLayers={};L.Renderer.prototype._update.call(this);var b=this._bounds,container=this._container,size=b.getSize(),m=L.Browser.retina?2:1;L.DomUtil.setPosition(container,b.min);container.width=m*size.x;container.height=m*size.y;container.style.width=size.x+'px';container.style.height=size.y+'px';if(L.Browser.retina){this._ctx.scale(2,2);}
this._ctx.translate(-b.min.x,-b.min.y);this.fire('update');},_reset:function _reset(){L.Renderer.prototype._reset.call(this);if(this._postponeUpdatePaths){this._postponeUpdatePaths=false;this._updatePaths();}},_initPath:function _initPath(layer){this._updateDashArray(layer);this._layers[L.stamp(layer)]=layer;var order=layer._order={layer:layer,prev:this._drawLast,next:null};if(this._drawLast){this._drawLast.next=order;}
this._drawLast=order;this._drawFirst=this._drawFirst||this._drawLast;},_addPath:function _addPath(layer){this._requestRedraw(layer);},_removePath:function _removePath(layer){var order=layer._order;var next=order.next;var prev=order.prev;if(next){next.prev=prev;}else{this._drawLast=prev;}
if(prev){prev.next=next;}else{this._drawFirst=next;}
delete layer._order;delete this._layers[L.stamp(layer)];this._requestRedraw(layer);},_updatePath:function _updatePath(layer){this._extendRedrawBounds(layer);layer._project();layer._update();this._requestRedraw(layer);},_updateStyle:function _updateStyle(layer){this._updateDashArray(layer);this._requestRedraw(layer);},_updateDashArray:function _updateDashArray(layer){if(layer.options.dashArray){var parts=layer.options.dashArray.split(','),dashArray=[],i;for(i=0;i<parts.length;i++){dashArray.push(Number(parts[i]));}
layer.options._dashArray=dashArray;}},_requestRedraw:function _requestRedraw(layer){if(!this._map){return;}
this._extendRedrawBounds(layer);this._redrawRequest=this._redrawRequest||L.Util.requestAnimFrame(this._redraw,this);},_extendRedrawBounds:function _extendRedrawBounds(layer){var padding=(layer.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new L.Bounds();this._redrawBounds.extend(layer._pxBounds.min.subtract([padding,padding]));this._redrawBounds.extend(layer._pxBounds.max.add([padding,padding]));},_redraw:function _redraw(){this._redrawRequest=null;if(this._redrawBounds){this._redrawBounds.min._floor();this._redrawBounds.max._ceil();}
this._clear();this._draw();this._redrawBounds=null;},_clear:function _clear(){var bounds=this._redrawBounds;if(bounds){var size=bounds.getSize();this._ctx.clearRect(bounds.min.x,bounds.min.y,size.x,size.y);}else{this._ctx.clearRect(0,0,this._container.width,this._container.height);}},_draw:function _draw(){var layer,bounds=this._redrawBounds;this._ctx.save();if(bounds){var size=bounds.getSize();this._ctx.beginPath();this._ctx.rect(bounds.min.x,bounds.min.y,size.x,size.y);this._ctx.clip();}
this._drawing=true;for(var order=this._drawFirst;order;order=order.next){layer=order.layer;if(!bounds||layer._pxBounds&&layer._pxBounds.intersects(bounds)){layer._updatePath();}}
this._drawing=false;this._ctx.restore();},_updatePoly:function _updatePoly(layer,closed){if(!this._drawing){return;}
var i,j,len2,p,parts=layer._parts,len=parts.length,ctx=this._ctx;if(!len){return;}
this._drawnLayers[layer._leaflet_id]=layer;ctx.beginPath();if(ctx.setLineDash){ctx.setLineDash(layer.options&&layer.options._dashArray||[]);}
for(i=0;i<len;i++){for(j=0,len2=parts[i].length;j<len2;j++){p=parts[i][j];ctx[j?'lineTo':'moveTo'](p.x,p.y);}
if(closed){ctx.closePath();}}
this._fillStroke(ctx,layer);},_updateCircle:function _updateCircle(layer){if(!this._drawing||layer._empty()){return;}
var p=layer._point,ctx=this._ctx,r=layer._radius,s=(layer._radiusY||r)/r;this._drawnLayers[layer._leaflet_id]=layer;if(s!==1){ctx.save();ctx.scale(1,s);}
ctx.beginPath();ctx.arc(p.x,p.y/s,r,0,Math.PI*2,false);if(s!==1){ctx.restore();}
this._fillStroke(ctx,layer);},_fillStroke:function _fillStroke(ctx,layer){var options=layer.options;if(options.fill){ctx.globalAlpha=options.fillOpacity;ctx.fillStyle=options.fillColor||options.color;ctx.fill(options.fillRule||'evenodd');}
if(options.stroke&&options.weight!==0){ctx.globalAlpha=options.opacity;ctx.lineWidth=options.weight;ctx.strokeStyle=options.color;ctx.lineCap=options.lineCap;ctx.lineJoin=options.lineJoin;ctx.stroke();}},_onClick:function _onClick(e){var point=this._map.mouseEventToLayerPoint(e),layer,clickedLayer;for(var order=this._drawFirst;order;order=order.next){layer=order.layer;if(layer.options.interactive&&layer._containsPoint(point)&&!this._map._draggableMoved(layer)){clickedLayer=layer;}}
if(clickedLayer){L.DomEvent._fakeStop(e);this._fireEvent([clickedLayer],e);}},_onMouseMove:function _onMouseMove(e){if(!this._map||this._map.dragging.moving()||this._map._animatingZoom){return;}
var point=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,point);},_handleMouseOut:function _handleMouseOut(e){var layer=this._hoveredLayer;if(layer){L.DomUtil.removeClass(this._container,'leaflet-interactive');this._fireEvent([layer],e,'mouseout');this._hoveredLayer=null;}},_handleMouseHover:function _handleMouseHover(e,point){var layer,candidateHoveredLayer;for(var order=this._drawFirst;order;order=order.next){layer=order.layer;if(layer.options.interactive&&layer._containsPoint(point)){candidateHoveredLayer=layer;}}
if(candidateHoveredLayer!==this._hoveredLayer){this._handleMouseOut(e);if(candidateHoveredLayer){L.DomUtil.addClass(this._container,'leaflet-interactive');this._fireEvent([candidateHoveredLayer],e,'mouseover');this._hoveredLayer=candidateHoveredLayer;}}
if(this._hoveredLayer){this._fireEvent([this._hoveredLayer],e);}},_fireEvent:function _fireEvent(layers,e,type){this._map._fireDOMEvent(e,type||e.type,layers);},_bringToFront:function _bringToFront(layer){var order=layer._order;var next=order.next;var prev=order.prev;if(next){next.prev=prev;}else{return;}
if(prev){prev.next=next;}else if(next){this._drawFirst=next;}
order.prev=this._drawLast;this._drawLast.next=order;order.next=null;this._drawLast=order;this._requestRedraw(layer);},_bringToBack:function _bringToBack(layer){var order=layer._order;var next=order.next;var prev=order.prev;if(prev){prev.next=next;}else{return;}
if(next){next.prev=prev;}else if(prev){this._drawLast=prev;}
order.prev=null;order.next=this._drawFirst;this._drawFirst.prev=order;this._drawFirst=order;this._requestRedraw(layer);}});L.Browser.canvas=function(){return!!document.createElement('canvas').getContext;}();L.canvas=function(options){return L.Browser.canvas?new L.Canvas(options):null;};L.Polyline.prototype._containsPoint=function(p,closed){var i,j,k,len,len2,part,w=this._clickTolerance();if(!this._pxBounds.contains(p)){return false;}
for(i=0,len=this._parts.length;i<len;i++){part=this._parts[i];for(j=0,len2=part.length,k=len2-1;j<len2;k=j++){if(!closed&&j===0){continue;}
if(L.LineUtil.pointToSegmentDistance(p,part[k],part[j])<=w){return true;}}}
return false;};L.Polygon.prototype._containsPoint=function(p){var inside=false,part,p1,p2,i,j,k,len,len2;if(!this._pxBounds.contains(p)){return false;}
for(i=0,len=this._parts.length;i<len;i++){part=this._parts[i];for(j=0,len2=part.length,k=len2-1;j<len2;k=j++){p1=part[j];p2=part[k];if(p1.y>p.y!==p2.y>p.y&&p.x<(p2.x-p1.x)*(p.y-p1.y)/(p2.y-p1.y)+p1.x){inside=!inside;}}}
return inside||L.Polyline.prototype._containsPoint.call(this,p,true);};L.CircleMarker.prototype._containsPoint=function(p){return p.distanceTo(this._point)<=this._radius+this._clickTolerance();};L.GeoJSON=L.FeatureGroup.extend({initialize:function initialize(geojson,options){L.setOptions(this,options);this._layers={};if(geojson){this.addData(geojson);}},addData:function addData(geojson){var features=L.Util.isArray(geojson)?geojson:geojson.features,i,len,feature;if(features){for(i=0,len=features.length;i<len;i++){feature=features[i];if(feature.geometries||feature.geometry||feature.features||feature.coordinates){this.addData(feature);}}
return this;}
var options=this.options;if(options.filter&&!options.filter(geojson)){return this;}
var layer=L.GeoJSON.geometryToLayer(geojson,options);if(!layer){return this;}
layer.feature=L.GeoJSON.asFeature(geojson);layer.defaultOptions=layer.options;this.resetStyle(layer);if(options.onEachFeature){options.onEachFeature(geojson,layer);}
return this.addLayer(layer);},resetStyle:function resetStyle(layer){layer.options=L.Util.extend({},layer.defaultOptions);this._setLayerStyle(layer,this.options.style);return this;},setStyle:function setStyle(style){return this.eachLayer(function(layer){this._setLayerStyle(layer,style);},this);},_setLayerStyle:function _setLayerStyle(layer,style){if(typeof style==='function'){style=style(layer.feature);}
if(layer.setStyle){layer.setStyle(style);}}});L.extend(L.GeoJSON,{geometryToLayer:function geometryToLayer(geojson,options){var geometry=geojson.type==='Feature'?geojson.geometry:geojson,coords=geometry?geometry.coordinates:null,layers=[],pointToLayer=options&&options.pointToLayer,coordsToLatLng=options&&options.coordsToLatLng||this.coordsToLatLng,latlng,latlngs,i,len;if(!coords&&!geometry){return null;}
switch(geometry.type){case'Point':latlng=coordsToLatLng(coords);return pointToLayer?pointToLayer(geojson,latlng):new L.Marker(latlng);case'MultiPoint':for(i=0,len=coords.length;i<len;i++){latlng=coordsToLatLng(coords[i]);layers.push(pointToLayer?pointToLayer(geojson,latlng):new L.Marker(latlng));}
return new L.FeatureGroup(layers);case'LineString':case'MultiLineString':latlngs=this.coordsToLatLngs(coords,geometry.type==='LineString'?0:1,coordsToLatLng);return new L.Polyline(latlngs,options);case'Polygon':case'MultiPolygon':latlngs=this.coordsToLatLngs(coords,geometry.type==='Polygon'?1:2,coordsToLatLng);return new L.Polygon(latlngs,options);case'GeometryCollection':for(i=0,len=geometry.geometries.length;i<len;i++){var layer=this.geometryToLayer({geometry:geometry.geometries[i],type:'Feature',properties:geojson.properties},options);if(layer){layers.push(layer);}}
return new L.FeatureGroup(layers);default:throw new Error('Invalid GeoJSON object.');}},coordsToLatLng:function coordsToLatLng(coords){return new L.LatLng(coords[1],coords[0],coords[2]);},coordsToLatLngs:function coordsToLatLngs(coords,levelsDeep,coordsToLatLng){var latlngs=[];for(var i=0,len=coords.length,latlng;i<len;i++){latlng=levelsDeep?this.coordsToLatLngs(coords[i],levelsDeep-1,coordsToLatLng):(coordsToLatLng||this.coordsToLatLng)(coords[i]);latlngs.push(latlng);}
return latlngs;},latLngToCoords:function latLngToCoords(latlng){return latlng.alt!==undefined?[latlng.lng,latlng.lat,latlng.alt]:[latlng.lng,latlng.lat];},latLngsToCoords:function latLngsToCoords(latlngs,levelsDeep,closed){var coords=[];for(var i=0,len=latlngs.length;i<len;i++){coords.push(levelsDeep?L.GeoJSON.latLngsToCoords(latlngs[i],levelsDeep-1,closed):L.GeoJSON.latLngToCoords(latlngs[i]));}
if(!levelsDeep&&closed){coords.push(coords[0]);}
return coords;},getFeature:function getFeature(layer,newGeometry){return layer.feature?L.extend({},layer.feature,{geometry:newGeometry}):L.GeoJSON.asFeature(newGeometry);},asFeature:function asFeature(geojson){if(geojson.type==='Feature'||geojson.type==='FeatureCollection'){return geojson;}
return{type:'Feature',properties:{},geometry:geojson};}});var PointToGeoJSON={toGeoJSON:function toGeoJSON(){return L.GeoJSON.getFeature(this,{type:'Point',coordinates:L.GeoJSON.latLngToCoords(this.getLatLng())});}};L.Marker.include(PointToGeoJSON);L.Circle.include(PointToGeoJSON);L.CircleMarker.include(PointToGeoJSON);L.Polyline.prototype.toGeoJSON=function(){var multi=!L.Polyline._flat(this._latlngs);var coords=L.GeoJSON.latLngsToCoords(this._latlngs,multi?1:0);return L.GeoJSON.getFeature(this,{type:(multi?'Multi':'')+'LineString',coordinates:coords});};L.Polygon.prototype.toGeoJSON=function(){var holes=!L.Polyline._flat(this._latlngs),multi=holes&&!L.Polyline._flat(this._latlngs[0]);var coords=L.GeoJSON.latLngsToCoords(this._latlngs,multi?2:holes?1:0,true);if(!holes){coords=[coords];}
return L.GeoJSON.getFeature(this,{type:(multi?'Multi':'')+'Polygon',coordinates:coords});};L.LayerGroup.include({toMultiPoint:function toMultiPoint(){var coords=[];this.eachLayer(function(layer){coords.push(layer.toGeoJSON().geometry.coordinates);});return L.GeoJSON.getFeature(this,{type:'MultiPoint',coordinates:coords});},toGeoJSON:function toGeoJSON(){var type=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(type==='MultiPoint'){return this.toMultiPoint();}
var isGeometryCollection=type==='GeometryCollection',jsons=[];this.eachLayer(function(layer){if(layer.toGeoJSON){var json=layer.toGeoJSON();jsons.push(isGeometryCollection?json.geometry:L.GeoJSON.asFeature(json));}});if(isGeometryCollection){return L.GeoJSON.getFeature(this,{geometries:jsons,type:'GeometryCollection'});}
return{type:'FeatureCollection',features:jsons};}});L.geoJSON=function(geojson,options){return new L.GeoJSON(geojson,options);};L.geoJson=L.geoJSON;L.Draggable=L.Evented.extend({options:{clickTolerance:3},statics:{START:L.Browser.touch?['touchstart','mousedown']:['mousedown'],END:{mousedown:'mouseup',touchstart:'touchend',pointerdown:'touchend',MSPointerDown:'touchend'},MOVE:{mousedown:'mousemove',touchstart:'touchmove',pointerdown:'touchmove',MSPointerDown:'touchmove'}},initialize:function initialize(element,dragStartTarget,preventOutline){this._element=element;this._dragStartTarget=dragStartTarget||element;this._preventOutline=preventOutline;},enable:function enable(){if(this._enabled){return;}
L.DomEvent.on(this._dragStartTarget,L.Draggable.START.join(' '),this._onDown,this);this._enabled=true;},disable:function disable(){if(!this._enabled){return;}
if(L.Draggable._dragging===this){this.finishDrag();}
L.DomEvent.off(this._dragStartTarget,L.Draggable.START.join(' '),this._onDown,this);this._enabled=false;this._moved=false;},_onDown:function _onDown(e){if(e._simulated||!this._enabled){return;}
this._moved=false;if(L.DomUtil.hasClass(this._element,'leaflet-zoom-anim')){return;}
if(L.Draggable._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches){return;}
L.Draggable._dragging=this;if(this._preventOutline){L.DomUtil.preventOutline(this._element);}
L.DomUtil.disableImageDrag();L.DomUtil.disableTextSelection();if(this._moving){return;}
this.fire('down');var first=e.touches?e.touches[0]:e;this._startPoint=new L.Point(first.clientX,first.clientY);L.DomEvent.on(document,L.Draggable.MOVE[e.type],this._onMove,this).on(document,L.Draggable.END[e.type],this._onUp,this);},_onMove:function _onMove(e){if(e._simulated||!this._enabled){return;}
if(e.touches&&e.touches.length>1){this._moved=true;return;}
var first=e.touches&&e.touches.length===1?e.touches[0]:e,newPoint=new L.Point(first.clientX,first.clientY),offset=newPoint.subtract(this._startPoint);if(!offset.x&&!offset.y){return;}
if(Math.abs(offset.x)+Math.abs(offset.y)<this.options.clickTolerance){return;}
L.DomEvent.preventDefault(e);if(!this._moved){this.fire('dragstart');this._moved=true;this._startPos=L.DomUtil.getPosition(this._element).subtract(offset);L.DomUtil.addClass(document.body,'leaflet-dragging');this._lastTarget=e.target||e.srcElement;if(window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance){this._lastTarget=this._lastTarget.correspondingUseElement;}
L.DomUtil.addClass(this._lastTarget,'leaflet-drag-target');}
this._newPos=this._startPos.add(offset);this._moving=true;L.Util.cancelAnimFrame(this._animRequest);this._lastEvent=e;this._animRequest=L.Util.requestAnimFrame(this._updatePosition,this,true);},_updatePosition:function _updatePosition(){var e={originalEvent:this._lastEvent};this.fire('predrag',e);L.DomUtil.setPosition(this._element,this._newPos);this.fire('drag',e);},_onUp:function _onUp(e){if(e._simulated||!this._enabled){return;}
this.finishDrag();},finishDrag:function finishDrag(){L.DomUtil.removeClass(document.body,'leaflet-dragging');if(this._lastTarget){L.DomUtil.removeClass(this._lastTarget,'leaflet-drag-target');this._lastTarget=null;}
for(var i in L.Draggable.MOVE){L.DomEvent.off(document,L.Draggable.MOVE[i],this._onMove,this).off(document,L.Draggable.END[i],this._onUp,this);}
L.DomUtil.enableImageDrag();L.DomUtil.enableTextSelection();if(this._moved&&this._moving){L.Util.cancelAnimFrame(this._animRequest);this.fire('dragend',{distance:this._newPos.distanceTo(this._startPos)});}
this._moving=false;L.Draggable._dragging=false;}});L.Handler=L.Class.extend({initialize:function initialize(map){this._map=map;},enable:function enable(){if(this._enabled){return this;}
this._enabled=true;this.addHooks();return this;},disable:function disable(){if(!this._enabled){return this;}
this._enabled=false;this.removeHooks();return this;},enabled:function enabled(){return!!this._enabled;}});L.Map.mergeOptions({dragging:true,inertia:!L.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:0.2,worldCopyJump:false,maxBoundsViscosity:0.0});L.Map.Drag=L.Handler.extend({addHooks:function addHooks(){if(!this._draggable){var map=this._map;this._draggable=new L.Draggable(map._mapPane,map._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on('predrag',this._onPreDragLimit,this);if(map.options.worldCopyJump){this._draggable.on('predrag',this._onPreDragWrap,this);map.on('zoomend',this._onZoomEnd,this);map.whenReady(this._onZoomEnd,this);}}
L.DomUtil.addClass(this._map._container,'leaflet-grab leaflet-touch-drag');this._draggable.enable();this._positions=[];this._times=[];},removeHooks:function removeHooks(){L.DomUtil.removeClass(this._map._container,'leaflet-grab');L.DomUtil.removeClass(this._map._container,'leaflet-touch-drag');this._draggable.disable();},moved:function moved(){return this._draggable&&this._draggable._moved;},moving:function moving(){return this._draggable&&this._draggable._moving;},_onDown:function _onDown(){this._map._stop();},_onDragStart:function _onDragStart(){var map=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var bounds=L.latLngBounds(this._map.options.maxBounds);this._offsetLimit=L.bounds(this._map.latLngToContainerPoint(bounds.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(bounds.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1.0,Math.max(0.0,this._map.options.maxBoundsViscosity));}else{this._offsetLimit=null;}
map.fire('movestart').fire('dragstart');if(map.options.inertia){this._positions=[];this._times=[];}},_onDrag:function _onDrag(e){if(this._map.options.inertia){var time=this._lastTime=+new Date(),pos=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(pos);this._times.push(time);if(time-this._times[0]>50){this._positions.shift();this._times.shift();}}
this._map.fire('move',e).fire('drag',e);},_onZoomEnd:function _onZoomEnd(){var pxCenter=this._map.getSize().divideBy(2),pxWorldCenter=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=pxWorldCenter.subtract(pxCenter).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x;},_viscousLimit:function _viscousLimit(value,threshold){return value-(value-threshold)*this._viscosity;},_onPreDragLimit:function _onPreDragLimit(){if(!this._viscosity||!this._offsetLimit){return;}
var offset=this._draggable._newPos.subtract(this._draggable._startPos);var limit=this._offsetLimit;if(offset.x<limit.min.x){offset.x=this._viscousLimit(offset.x,limit.min.x);}
if(offset.y<limit.min.y){offset.y=this._viscousLimit(offset.y,limit.min.y);}
if(offset.x>limit.max.x){offset.x=this._viscousLimit(offset.x,limit.max.x);}
if(offset.y>limit.max.y){offset.y=this._viscousLimit(offset.y,limit.max.y);}
this._draggable._newPos=this._draggable._startPos.add(offset);},_onPreDragWrap:function _onPreDragWrap(){var worldWidth=this._worldWidth,halfWidth=Math.round(worldWidth/2),dx=this._initialWorldOffset,x=this._draggable._newPos.x,newX1=(x-halfWidth+dx)%worldWidth+halfWidth-dx,newX2=(x+halfWidth+dx)%worldWidth-halfWidth-dx,newX=Math.abs(newX1+dx)<Math.abs(newX2+dx)?newX1:newX2;this._draggable._absPos=this._draggable._newPos.clone();this._draggable._newPos.x=newX;},_onDragEnd:function _onDragEnd(e){var map=this._map,options=map.options,noInertia=!options.inertia||this._times.length<2;map.fire('dragend',e);if(noInertia){map.fire('moveend');}else{var direction=this._lastPos.subtract(this._positions[0]),duration=(this._lastTime-this._times[0])/1000,ease=options.easeLinearity,speedVector=direction.multiplyBy(ease/duration),speed=speedVector.distanceTo([0,0]),limitedSpeed=Math.min(options.inertiaMaxSpeed,speed),limitedSpeedVector=speedVector.multiplyBy(limitedSpeed/speed),decelerationDuration=limitedSpeed/(options.inertiaDeceleration*ease),offset=limitedSpeedVector.multiplyBy(-decelerationDuration/2).round();if(!offset.x&&!offset.y){map.fire('moveend');}else{offset=map._limitOffset(offset,map.options.maxBounds);L.Util.requestAnimFrame(function(){map.panBy(offset,{duration:decelerationDuration,easeLinearity:ease,noMoveStart:true,animate:true});});}}}});L.Map.addInitHook('addHandler','dragging',L.Map.Drag);L.Map.mergeOptions({doubleClickZoom:true});L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function addHooks(){this._map.on('dblclick',this._onDoubleClick,this);},removeHooks:function removeHooks(){this._map.off('dblclick',this._onDoubleClick,this);},_onDoubleClick:function _onDoubleClick(e){var map=this._map,oldZoom=map.getZoom(),delta=map.options.zoomDelta,zoom=e.originalEvent.shiftKey?oldZoom-delta:oldZoom+delta;if(map.options.doubleClickZoom==='center'){map.setZoom(zoom);}else{map.setZoomAround(e.containerPoint,zoom);}}});L.Map.addInitHook('addHandler','doubleClickZoom',L.Map.DoubleClickZoom);L.Map.mergeOptions({scrollWheelZoom:true,wheelDebounceTime:40,wheelPxPerZoomLevel:60});L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function addHooks(){L.DomEvent.on(this._map._container,'mousewheel',this._onWheelScroll,this);this._delta=0;},removeHooks:function removeHooks(){L.DomEvent.off(this._map._container,'mousewheel',this._onWheelScroll,this);},_onWheelScroll:function _onWheelScroll(e){var delta=L.DomEvent.getWheelDelta(e);var debounce=this._map.options.wheelDebounceTime;this._delta+=delta;this._lastMousePos=this._map.mouseEventToContainerPoint(e);if(!this._startTime){this._startTime=+new Date();}
var left=Math.max(debounce-(+new Date()-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(L.bind(this._performZoom,this),left);L.DomEvent.stop(e);},_performZoom:function _performZoom(){var map=this._map,zoom=map.getZoom(),snap=this._map.options.zoomSnap||0;map._stop();var d2=this._delta/(this._map.options.wheelPxPerZoomLevel*4),d3=4*Math.log(2/(1+Math.exp(-Math.abs(d2))))/Math.LN2,d4=snap?Math.ceil(d3/snap)*snap:d3,delta=map._limitZoom(zoom+(this._delta>0?d4:-d4))-zoom;this._delta=0;this._startTime=null;if(!delta){return;}
if(map.options.scrollWheelZoom==='center'){map.setZoom(zoom+delta);}else{map.setZoomAround(this._lastMousePos,zoom+delta);}}});L.Map.addInitHook('addHandler','scrollWheelZoom',L.Map.ScrollWheelZoom);L.extend(L.DomEvent,{_touchstart:L.Browser.msPointer?'MSPointerDown':L.Browser.pointer?'pointerdown':'touchstart',_touchend:L.Browser.msPointer?'MSPointerUp':L.Browser.pointer?'pointerup':'touchend',addDoubleTapListener:function addDoubleTapListener(obj,handler,id){var last,touch,doubleTap=false,delay=250;function onTouchStart(e){var count;if(L.Browser.pointer){if(!L.Browser.edge||e.pointerType==='mouse'){return;}
count=L.DomEvent._pointersCount;}else{count=e.touches.length;}
if(count>1){return;}
var now=Date.now(),delta=now-(last||now);touch=e.touches?e.touches[0]:e;doubleTap=delta>0&&delta<=delay;last=now;}
function onTouchEnd(e){if(doubleTap&&!touch.cancelBubble){if(L.Browser.pointer){if(!L.Browser.edge||e.pointerType==='mouse'){return;}
var newTouch={},prop,i;for(i in touch){prop=touch[i];newTouch[i]=prop&&prop.bind?prop.bind(touch):prop;}
touch=newTouch;}
touch.type='dblclick';handler(touch);last=null;}}
var pre='_leaflet_',touchstart=this._touchstart,touchend=this._touchend;obj[pre+touchstart+id]=onTouchStart;obj[pre+touchend+id]=onTouchEnd;obj[pre+'dblclick'+id]=handler;obj.addEventListener(touchstart,onTouchStart,false);obj.addEventListener(touchend,onTouchEnd,false);obj.addEventListener('dblclick',handler,false);return this;},removeDoubleTapListener:function removeDoubleTapListener(obj,id){var pre='_leaflet_',touchstart=obj[pre+this._touchstart+id],touchend=obj[pre+this._touchend+id],dblclick=obj[pre+'dblclick'+id];obj.removeEventListener(this._touchstart,touchstart,false);obj.removeEventListener(this._touchend,touchend,false);if(!L.Browser.edge){obj.removeEventListener('dblclick',dblclick,false);}
return this;}});L.extend(L.DomEvent,{POINTER_DOWN:L.Browser.msPointer?'MSPointerDown':'pointerdown',POINTER_MOVE:L.Browser.msPointer?'MSPointerMove':'pointermove',POINTER_UP:L.Browser.msPointer?'MSPointerUp':'pointerup',POINTER_CANCEL:L.Browser.msPointer?'MSPointerCancel':'pointercancel',TAG_WHITE_LIST:['INPUT','SELECT','OPTION'],_pointers:{},_pointersCount:0,addPointerListener:function addPointerListener(obj,type,handler,id){if(type==='touchstart'){this._addPointerStart(obj,handler,id);}else if(type==='touchmove'){this._addPointerMove(obj,handler,id);}else if(type==='touchend'){this._addPointerEnd(obj,handler,id);}
return this;},removePointerListener:function removePointerListener(obj,type,id){var handler=obj['_leaflet_'+type+id];if(type==='touchstart'){obj.removeEventListener(this.POINTER_DOWN,handler,false);}else if(type==='touchmove'){obj.removeEventListener(this.POINTER_MOVE,handler,false);}else if(type==='touchend'){obj.removeEventListener(this.POINTER_UP,handler,false);obj.removeEventListener(this.POINTER_CANCEL,handler,false);}
return this;},_addPointerStart:function _addPointerStart(obj,handler,id){var onDown=L.bind(function(e){if(e.pointerType!=='mouse'&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){if(this.TAG_WHITE_LIST.indexOf(e.target.tagName)<0){L.DomEvent.preventDefault(e);}else{return;}}
this._handlePointer(e,handler);},this);obj['_leaflet_touchstart'+id]=onDown;obj.addEventListener(this.POINTER_DOWN,onDown,false);if(!this._pointerDocListener){var pointerUp=L.bind(this._globalPointerUp,this);document.documentElement.addEventListener(this.POINTER_DOWN,L.bind(this._globalPointerDown,this),true);document.documentElement.addEventListener(this.POINTER_MOVE,L.bind(this._globalPointerMove,this),true);document.documentElement.addEventListener(this.POINTER_UP,pointerUp,true);document.documentElement.addEventListener(this.POINTER_CANCEL,pointerUp,true);this._pointerDocListener=true;}},_globalPointerDown:function _globalPointerDown(e){this._pointers[e.pointerId]=e;this._pointersCount++;},_globalPointerMove:function _globalPointerMove(e){if(this._pointers[e.pointerId]){this._pointers[e.pointerId]=e;}},_globalPointerUp:function _globalPointerUp(e){delete this._pointers[e.pointerId];this._pointersCount--;},_handlePointer:function _handlePointer(e,handler){e.touches=[];for(var i in this._pointers){e.touches.push(this._pointers[i]);}
e.changedTouches=[e];handler(e);},_addPointerMove:function _addPointerMove(obj,handler,id){var onMove=L.bind(function(e){if((e.pointerType===e.MSPOINTER_TYPE_MOUSE||e.pointerType==='mouse')&&e.buttons===0){return;}
this._handlePointer(e,handler);},this);obj['_leaflet_touchmove'+id]=onMove;obj.addEventListener(this.POINTER_MOVE,onMove,false);},_addPointerEnd:function _addPointerEnd(obj,handler,id){var onUp=L.bind(function(e){this._handlePointer(e,handler);},this);obj['_leaflet_touchend'+id]=onUp;obj.addEventListener(this.POINTER_UP,onUp,false);obj.addEventListener(this.POINTER_CANCEL,onUp,false);}});L.Map.mergeOptions({touchZoom:L.Browser.touch&&!L.Browser.android23,bounceAtZoomLimits:true});L.Map.TouchZoom=L.Handler.extend({addHooks:function addHooks(){L.DomUtil.addClass(this._map._container,'leaflet-touch-zoom');L.DomEvent.on(this._map._container,'touchstart',this._onTouchStart,this);},removeHooks:function removeHooks(){L.DomUtil.removeClass(this._map._container,'leaflet-touch-zoom');L.DomEvent.off(this._map._container,'touchstart',this._onTouchStart,this);},_onTouchStart:function _onTouchStart(e){var map=this._map;if(!e.touches||e.touches.length!==2||map._animatingZoom||this._zooming){return;}
var p1=map.mouseEventToContainerPoint(e.touches[0]),p2=map.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=map.getSize()._divideBy(2);this._startLatLng=map.containerPointToLatLng(this._centerPoint);if(map.options.touchZoom!=='center'){this._pinchStartLatLng=map.containerPointToLatLng(p1.add(p2)._divideBy(2));}
this._startDist=p1.distanceTo(p2);this._startZoom=map.getZoom();this._moved=false;this._zooming=true;map._stop();L.DomEvent.on(document,'touchmove',this._onTouchMove,this).on(document,'touchend',this._onTouchEnd,this);L.DomEvent.preventDefault(e);},_onTouchMove:function _onTouchMove(e){if(!e.touches||e.touches.length!==2||!this._zooming){return;}
var map=this._map,p1=map.mouseEventToContainerPoint(e.touches[0]),p2=map.mouseEventToContainerPoint(e.touches[1]),scale=p1.distanceTo(p2)/this._startDist;this._zoom=map.getScaleZoom(scale,this._startZoom);if(!map.options.bounceAtZoomLimits&&(this._zoom<map.getMinZoom()&&scale<1||this._zoom>map.getMaxZoom()&&scale>1)){this._zoom=map._limitZoom(this._zoom);}
if(map.options.touchZoom==='center'){this._center=this._startLatLng;if(scale===1){return;}}else{var delta=p1._add(p2)._divideBy(2)._subtract(this._centerPoint);if(scale===1&&delta.x===0&&delta.y===0){return;}
this._center=map.unproject(map.project(this._pinchStartLatLng,this._zoom).subtract(delta),this._zoom);}
if(!this._moved){map._moveStart(true);this._moved=true;}
L.Util.cancelAnimFrame(this._animRequest);var moveFn=L.bind(map._move,map,this._center,this._zoom,{pinch:true,round:false});this._animRequest=L.Util.requestAnimFrame(moveFn,this,true);L.DomEvent.preventDefault(e);},_onTouchEnd:function _onTouchEnd(){if(!this._moved||!this._zooming){this._zooming=false;return;}
this._zooming=false;L.Util.cancelAnimFrame(this._animRequest);L.DomEvent.off(document,'touchmove',this._onTouchMove).off(document,'touchend',this._onTouchEnd);if(this._map.options.zoomAnimation){this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),true,this._map.options.zoomSnap);}else{this._map._resetView(this._center,this._map._limitZoom(this._zoom));}}});L.Map.addInitHook('addHandler','touchZoom',L.Map.TouchZoom);L.Map.mergeOptions({tap:true,tapTolerance:15});L.Map.Tap=L.Handler.extend({addHooks:function addHooks(){L.DomEvent.on(this._map._container,'touchstart',this._onDown,this);},removeHooks:function removeHooks(){L.DomEvent.off(this._map._container,'touchstart',this._onDown,this);},_onDown:function _onDown(e){if(!e.touches){return;}
L.DomEvent.preventDefault(e);this._fireClick=true;if(e.touches.length>1){this._fireClick=false;clearTimeout(this._holdTimeout);return;}
var first=e.touches[0],el=first.target;this._startPos=this._newPos=new L.Point(first.clientX,first.clientY);if(el.tagName&&el.tagName.toLowerCase()==='a'){L.DomUtil.addClass(el,'leaflet-active');}
this._holdTimeout=setTimeout(L.bind(function(){if(this._isTapValid()){this._fireClick=false;this._onUp();this._simulateEvent('contextmenu',first);}},this),1000);this._simulateEvent('mousedown',first);L.DomEvent.on(document,{touchmove:this._onMove,touchend:this._onUp},this);},_onUp:function _onUp(e){clearTimeout(this._holdTimeout);L.DomEvent.off(document,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&e&&e.changedTouches){var first=e.changedTouches[0],el=first.target;if(el&&el.tagName&&el.tagName.toLowerCase()==='a'){L.DomUtil.removeClass(el,'leaflet-active');}
this._simulateEvent('mouseup',first);if(this._isTapValid()){this._simulateEvent('click',first);}}},_isTapValid:function _isTapValid(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance;},_onMove:function _onMove(e){var first=e.touches[0];this._newPos=new L.Point(first.clientX,first.clientY);this._simulateEvent('mousemove',first);},_simulateEvent:function _simulateEvent(type,e){var simulatedEvent=document.createEvent('MouseEvents');simulatedEvent._simulated=true;e.target._simulatedClick=true;simulatedEvent.initMouseEvent(type,true,true,window,1,e.screenX,e.screenY,e.clientX,e.clientY,false,false,false,false,0,null);e.target.dispatchEvent(simulatedEvent);}});if(L.Browser.touch&&!L.Browser.pointer){L.Map.addInitHook('addHandler','tap',L.Map.Tap);}
L.Map.mergeOptions({boxZoom:true});L.Map.BoxZoom=L.Handler.extend({initialize:function initialize(map){this._map=map;this._container=map._container;this._pane=map._panes.overlayPane;},addHooks:function addHooks(){L.DomEvent.on(this._container,'mousedown',this._onMouseDown,this);},removeHooks:function removeHooks(){L.DomEvent.off(this._container,'mousedown',this._onMouseDown,this);},moved:function moved(){return this._moved;},_resetState:function _resetState(){this._moved=false;},_onMouseDown:function _onMouseDown(e){if(!e.shiftKey||e.which!==1&&e.button!==1){return false;}
this._resetState();L.DomUtil.disableTextSelection();L.DomUtil.disableImageDrag();this._startPoint=this._map.mouseEventToContainerPoint(e);L.DomEvent.on(document,{contextmenu:L.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this);},_onMouseMove:function _onMouseMove(e){if(!this._moved){this._moved=true;this._box=L.DomUtil.create('div','leaflet-zoom-box',this._container);L.DomUtil.addClass(this._container,'leaflet-crosshair');this._map.fire('boxzoomstart');}
this._point=this._map.mouseEventToContainerPoint(e);var bounds=new L.Bounds(this._point,this._startPoint),size=bounds.getSize();L.DomUtil.setPosition(this._box,bounds.min);this._box.style.width=size.x+'px';this._box.style.height=size.y+'px';},_finish:function _finish(){if(this._moved){L.DomUtil.remove(this._box);L.DomUtil.removeClass(this._container,'leaflet-crosshair');}
L.DomUtil.enableTextSelection();L.DomUtil.enableImageDrag();L.DomEvent.off(document,{contextmenu:L.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this);},_onMouseUp:function _onMouseUp(e){if(e.which!==1&&e.button!==1){return;}
this._finish();if(!this._moved){return;}
setTimeout(L.bind(this._resetState,this),0);var bounds=new L.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(bounds).fire('boxzoomend',{boxZoomBounds:bounds});},_onKeyDown:function _onKeyDown(e){if(e.keyCode===27){this._finish();}}});L.Map.addInitHook('addHandler','boxZoom',L.Map.BoxZoom);L.Map.mergeOptions({keyboard:true,keyboardPanDelta:80});L.Map.Keyboard=L.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function initialize(map){this._map=map;this._setPanDelta(map.options.keyboardPanDelta);this._setZoomDelta(map.options.zoomDelta);},addHooks:function addHooks(){var container=this._map._container;if(container.tabIndex<=0){container.tabIndex='0';}
L.DomEvent.on(container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this);},removeHooks:function removeHooks(){this._removeHooks();L.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this);},_onMouseDown:function _onMouseDown(){if(this._focused){return;}
var body=document.body,docEl=document.documentElement,top=body.scrollTop||docEl.scrollTop,left=body.scrollLeft||docEl.scrollLeft;this._map._container.focus();window.scrollTo(left,top);},_onFocus:function _onFocus(){this._focused=true;this._map.fire('focus');},_onBlur:function _onBlur(){this._focused=false;this._map.fire('blur');},_setPanDelta:function _setPanDelta(panDelta){var keys=this._panKeys={},codes=this.keyCodes,i,len;for(i=0,len=codes.left.length;i<len;i++){keys[codes.left[i]]=[-1*panDelta,0];}
for(i=0,len=codes.right.length;i<len;i++){keys[codes.right[i]]=[panDelta,0];}
for(i=0,len=codes.down.length;i<len;i++){keys[codes.down[i]]=[0,panDelta];}
for(i=0,len=codes.up.length;i<len;i++){keys[codes.up[i]]=[0,-1*panDelta];}},_setZoomDelta:function _setZoomDelta(zoomDelta){var keys=this._zoomKeys={},codes=this.keyCodes,i,len;for(i=0,len=codes.zoomIn.length;i<len;i++){keys[codes.zoomIn[i]]=zoomDelta;}
for(i=0,len=codes.zoomOut.length;i<len;i++){keys[codes.zoomOut[i]]=-zoomDelta;}},_addHooks:function _addHooks(){L.DomEvent.on(document,'keydown',this._onKeyDown,this);},_removeHooks:function _removeHooks(){L.DomEvent.off(document,'keydown',this._onKeyDown,this);},_onKeyDown:function _onKeyDown(e){if(e.altKey||e.ctrlKey||e.metaKey){return;}
var key=e.keyCode,map=this._map,offset;if(key in this._panKeys){if(map._panAnim&&map._panAnim._inProgress){return;}
offset=this._panKeys[key];if(e.shiftKey){offset=L.point(offset).multiplyBy(3);}
map.panBy(offset);if(map.options.maxBounds){map.panInsideBounds(map.options.maxBounds);}}else if(key in this._zoomKeys){map.setZoom(map.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[key]);}else if(key===27){map.closePopup();}else{return;}
L.DomEvent.stop(e);}});L.Map.addInitHook('addHandler','keyboard',L.Map.Keyboard);L.Handler.MarkerDrag=L.Handler.extend({initialize:function initialize(marker){this._marker=marker;},addHooks:function addHooks(){var icon=this._marker._icon;if(!this._draggable){this._draggable=new L.Draggable(icon,icon,true);}
this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();L.DomUtil.addClass(icon,'leaflet-marker-draggable');},removeHooks:function removeHooks(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();if(this._marker._icon){L.DomUtil.removeClass(this._marker._icon,'leaflet-marker-draggable');}},moved:function moved(){return this._draggable&&this._draggable._moved;},_onDragStart:function _onDragStart(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire('movestart').fire('dragstart');},_onDrag:function _onDrag(e){var marker=this._marker,shadow=marker._shadow,iconPos=L.DomUtil.getPosition(marker._icon),latlng=marker._map.layerPointToLatLng(iconPos);if(shadow){L.DomUtil.setPosition(shadow,iconPos);}
marker._latlng=latlng;e.latlng=latlng;e.oldLatLng=this._oldLatLng;marker.fire('move',e).fire('drag',e);},_onDragEnd:function _onDragEnd(e){delete this._oldLatLng;this._marker.fire('moveend').fire('dragend',e);}});L.Control=L.Class.extend({options:{position:'topright'},initialize:function initialize(options){L.setOptions(this,options);},getPosition:function getPosition(){return this.options.position;},setPosition:function setPosition(position){var map=this._map;if(map){map.removeControl(this);}
this.options.position=position;if(map){map.addControl(this);}
return this;},getContainer:function getContainer(){return this._container;},addTo:function addTo(map){this.remove();this._map=map;var container=this._container=this.onAdd(map),pos=this.getPosition(),corner=map._controlCorners[pos];L.DomUtil.addClass(container,'leaflet-control');if(pos.indexOf('bottom')!==-1){corner.insertBefore(container,corner.firstChild);}else{corner.appendChild(container);}
return this;},remove:function remove(){if(!this._map){return this;}
L.DomUtil.remove(this._container);if(this.onRemove){this.onRemove(this._map);}
this._map=null;return this;},_refocusOnMap:function _refocusOnMap(e){if(this._map&&e&&e.screenX>0&&e.screenY>0){this._map.getContainer().focus();}}});L.control=function(options){return new L.Control(options);};L.Map.include({addControl:function addControl(control){control.addTo(this);return this;},removeControl:function removeControl(control){control.remove();return this;},_initControlPos:function _initControlPos(){var corners=this._controlCorners={},l='leaflet-',container=this._controlContainer=L.DomUtil.create('div',l+'control-container',this._container);function createCorner(vSide,hSide){var className=l+vSide+' '+l+hSide;corners[vSide+hSide]=L.DomUtil.create('div',className,container);}
createCorner('top','left');createCorner('top','right');createCorner('bottom','left');createCorner('bottom','right');},_clearControlPos:function _clearControlPos(){L.DomUtil.remove(this._controlContainer);}});L.Control.Zoom=L.Control.extend({options:{position:'topleft',zoomInText:'+',zoomInTitle:'Zoom in',zoomOutText:'-',zoomOutTitle:'Zoom out'},onAdd:function onAdd(map){var zoomName='leaflet-control-zoom',container=L.DomUtil.create('div',zoomName+' leaflet-bar'),options=this.options;this._zoomInButton=this._createButton(options.zoomInText,options.zoomInTitle,zoomName+'-in',container,this._zoomIn);this._zoomOutButton=this._createButton(options.zoomOutText,options.zoomOutTitle,zoomName+'-out',container,this._zoomOut);this._updateDisabled();map.on('zoomend zoomlevelschange',this._updateDisabled,this);return container;},onRemove:function onRemove(map){map.off('zoomend zoomlevelschange',this._updateDisabled,this);},disable:function disable(){this._disabled=true;this._updateDisabled();return this;},enable:function enable(){this._disabled=false;this._updateDisabled();return this;},_zoomIn:function _zoomIn(e){if(!this._disabled&&this._map._zoom<this._map.getMaxZoom()){this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1));}},_zoomOut:function _zoomOut(e){if(!this._disabled&&this._map._zoom>this._map.getMinZoom()){this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1));}},_createButton:function _createButton(html,title,className,container,fn){var link=L.DomUtil.create('a',className,container);link.innerHTML=html;link.href='#';link.title=title;link.setAttribute('role','button');link.setAttribute('aria-label',title);L.DomEvent.on(link,'mousedown dblclick',L.DomEvent.stopPropagation).on(link,'click',L.DomEvent.stop).on(link,'click',fn,this).on(link,'click',this._refocusOnMap,this);return link;},_updateDisabled:function _updateDisabled(){var map=this._map,className='leaflet-disabled';L.DomUtil.removeClass(this._zoomInButton,className);L.DomUtil.removeClass(this._zoomOutButton,className);if(this._disabled||map._zoom===map.getMinZoom()){L.DomUtil.addClass(this._zoomOutButton,className);}
if(this._disabled||map._zoom===map.getMaxZoom()){L.DomUtil.addClass(this._zoomInButton,className);}}});L.Map.mergeOptions({zoomControl:true});L.Map.addInitHook(function(){if(this.options.zoomControl){this.zoomControl=new L.Control.Zoom();this.addControl(this.zoomControl);}});L.control.zoom=function(options){return new L.Control.Zoom(options);};L.Control.Attribution=L.Control.extend({options:{position:'bottomright',prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function initialize(options){L.setOptions(this,options);this._attributions={};},onAdd:function onAdd(map){map.attributionControl=this;this._container=L.DomUtil.create('div','leaflet-control-attribution');if(L.DomEvent){L.DomEvent.disableClickPropagation(this._container);}
for(var i in map._layers){if(map._layers[i].getAttribution){this.addAttribution(map._layers[i].getAttribution());}}
this._update();return this._container;},setPrefix:function setPrefix(prefix){this.options.prefix=prefix;this._update();return this;},addAttribution:function addAttribution(text){if(!text){return this;}
if(!this._attributions[text]){this._attributions[text]=0;}
this._attributions[text]++;this._update();return this;},removeAttribution:function removeAttribution(text){if(!text){return this;}
if(this._attributions[text]){this._attributions[text]--;this._update();}
return this;},_update:function _update(){if(!this._map){return;}
var attribs=[];for(var i in this._attributions){if(this._attributions[i]){attribs.push(i);}}
var prefixAndAttribs=[];if(this.options.prefix){prefixAndAttribs.push(this.options.prefix);}
if(attribs.length){prefixAndAttribs.push(attribs.join(', '));}
this._container.innerHTML=prefixAndAttribs.join(' | ');}});L.Map.mergeOptions({attributionControl:true});L.Map.addInitHook(function(){if(this.options.attributionControl){new L.Control.Attribution().addTo(this);}});L.control.attribution=function(options){return new L.Control.Attribution(options);};L.Control.Scale=L.Control.extend({options:{position:'bottomleft',maxWidth:100,metric:true,imperial:true},onAdd:function onAdd(map){var className='leaflet-control-scale',container=L.DomUtil.create('div',className),options=this.options;this._addScales(options,className+'-line',container);map.on(options.updateWhenIdle?'moveend':'move',this._update,this);map.whenReady(this._update,this);return container;},onRemove:function onRemove(map){map.off(this.options.updateWhenIdle?'moveend':'move',this._update,this);},_addScales:function _addScales(options,className,container){if(options.metric){this._mScale=L.DomUtil.create('div',className,container);}
if(options.imperial){this._iScale=L.DomUtil.create('div',className,container);}},_update:function _update(){var map=this._map,y=map.getSize().y/2;var maxMeters=map.distance(map.containerPointToLatLng([0,y]),map.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(maxMeters);},_updateScales:function _updateScales(maxMeters){if(this.options.metric&&maxMeters){this._updateMetric(maxMeters);}
if(this.options.imperial&&maxMeters){this._updateImperial(maxMeters);}},_updateMetric:function _updateMetric(maxMeters){var meters=this._getRoundNum(maxMeters),label=meters<1000?meters+' m':meters/1000+' km';this._updateScale(this._mScale,label,meters/maxMeters);},_updateImperial:function _updateImperial(maxMeters){var maxFeet=maxMeters*3.2808399,maxMiles,miles,feet;if(maxFeet>5280){maxMiles=maxFeet/5280;miles=this._getRoundNum(maxMiles);this._updateScale(this._iScale,miles+' mi',miles/maxMiles);}else{feet=this._getRoundNum(maxFeet);this._updateScale(this._iScale,feet+' ft',feet/maxFeet);}},_updateScale:function _updateScale(scale,text,ratio){scale.style.width=Math.round(this.options.maxWidth*ratio)+'px';scale.innerHTML=text;},_getRoundNum:function _getRoundNum(num){var pow10=Math.pow(10,(Math.floor(num)+'').length-1),d=num/pow10;d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1;return pow10*d;}});L.control.scale=function(options){return new L.Control.Scale(options);};L.Control.Layers=L.Control.extend({options:{collapsed:true,position:'topright',autoZIndex:true,hideSingleBase:false,sortLayers:false,sortFunction:function sortFunction(layerA,layerB,nameA,nameB){return nameA<nameB?-1:nameB<nameA?1:0;}},initialize:function initialize(baseLayers,overlays,options){L.setOptions(this,options);this._layers=[];this._lastZIndex=0;this._handlingClick=false;for(var i in baseLayers){this._addLayer(baseLayers[i],i);}
for(i in overlays){this._addLayer(overlays[i],i,true);}},onAdd:function onAdd(map){this._initLayout();this._update();this._map=map;map.on('zoomend',this._checkDisabledLayers,this);return this._container;},onRemove:function onRemove(){this._map.off('zoomend',this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++){this._layers[i].layer.off('add remove',this._onLayerChange,this);}},addBaseLayer:function addBaseLayer(layer,name){this._addLayer(layer,name);return this._map?this._update():this;},addOverlay:function addOverlay(layer,name){this._addLayer(layer,name,true);return this._map?this._update():this;},removeLayer:function removeLayer(layer){layer.off('add remove',this._onLayerChange,this);var obj=this._getLayer(L.stamp(layer));if(obj){this._layers.splice(this._layers.indexOf(obj),1);}
return this._map?this._update():this;},expand:function expand(){L.DomUtil.addClass(this._container,'leaflet-control-layers-expanded');this._form.style.height=null;var acceptableHeight=this._map.getSize().y-(this._container.offsetTop+50);if(acceptableHeight<this._form.clientHeight){L.DomUtil.addClass(this._form,'leaflet-control-layers-scrollbar');this._form.style.height=acceptableHeight+'px';}else{L.DomUtil.removeClass(this._form,'leaflet-control-layers-scrollbar');}
this._checkDisabledLayers();return this;},collapse:function collapse(){L.DomUtil.removeClass(this._container,'leaflet-control-layers-expanded');return this;},_initLayout:function _initLayout(){var className='leaflet-control-layers',container=this._container=L.DomUtil.create('div',className),collapsed=this.options.collapsed;container.setAttribute('aria-haspopup',true);L.DomEvent.disableClickPropagation(container);if(!L.Browser.touch){L.DomEvent.disableScrollPropagation(container);}
var form=this._form=L.DomUtil.create('form',className+'-list');if(collapsed){this._map.on('click',this.collapse,this);if(!L.Browser.android){L.DomEvent.on(container,{mouseenter:this.expand,mouseleave:this.collapse},this);}}
var link=this._layersLink=L.DomUtil.create('a',className+'-toggle',container);link.href='#';link.title='Layers';if(L.Browser.touch){L.DomEvent.on(link,'click',L.DomEvent.stop).on(link,'click',this.expand,this);}else{L.DomEvent.on(link,'focus',this.expand,this);}
L.DomEvent.on(form,'click',function(){setTimeout(L.bind(this._onInputClick,this),0);},this);if(!collapsed){this.expand();}
this._baseLayersList=L.DomUtil.create('div',className+'-base',form);this._separator=L.DomUtil.create('div',className+'-separator',form);this._overlaysList=L.DomUtil.create('div',className+'-overlays',form);container.appendChild(form);},_getLayer:function _getLayer(id){for(var i=0;i<this._layers.length;i++){if(this._layers[i]&&L.stamp(this._layers[i].layer)===id){return this._layers[i];}}},_addLayer:function _addLayer(layer,name,overlay){layer.on('add remove',this._onLayerChange,this);this._layers.push({layer:layer,name:name,overlay:overlay});if(this.options.sortLayers){this._layers.sort(L.bind(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name);},this));}
if(this.options.autoZIndex&&layer.setZIndex){this._lastZIndex++;layer.setZIndex(this._lastZIndex);}},_update:function _update(){if(!this._container){return this;}
L.DomUtil.empty(this._baseLayersList);L.DomUtil.empty(this._overlaysList);var baseLayersPresent,overlaysPresent,i,obj,baseLayersCount=0;for(i=0;i<this._layers.length;i++){obj=this._layers[i];this._addItem(obj);overlaysPresent=overlaysPresent||obj.overlay;baseLayersPresent=baseLayersPresent||!obj.overlay;baseLayersCount+=!obj.overlay?1:0;}
if(this.options.hideSingleBase){baseLayersPresent=baseLayersPresent&&baseLayersCount>1;this._baseLayersList.style.display=baseLayersPresent?'':'none';}
this._separator.style.display=overlaysPresent&&baseLayersPresent?'':'none';return this;},_onLayerChange:function _onLayerChange(e){if(!this._handlingClick){this._update();}
var obj=this._getLayer(L.stamp(e.target));var type=obj.overlay?e.type==='add'?'overlayadd':'overlayremove':e.type==='add'?'baselayerchange':null;if(type){this._map.fire(type,obj);}},_createRadioElement:function _createRadioElement(name,checked){var radioHtml='<input type="radio" class="leaflet-control-layers-selector" name="'+name+'"'+(checked?' checked="checked"':'')+'/>';var radioFragment=document.createElement('div');radioFragment.innerHTML=radioHtml;return radioFragment.firstChild;},_addItem:function _addItem(obj){var label=document.createElement('label'),checked=this._map.hasLayer(obj.layer),input;if(obj.overlay){input=document.createElement('input');input.type='checkbox';input.className='leaflet-control-layers-selector';input.defaultChecked=checked;}else{input=this._createRadioElement('leaflet-base-layers',checked);}
input.layerId=L.stamp(obj.layer);L.DomEvent.on(input,'click',this._onInputClick,this);var name=document.createElement('span');name.innerHTML=' '+obj.name;var holder=document.createElement('div');label.appendChild(holder);holder.appendChild(input);holder.appendChild(name);var container=obj.overlay?this._overlaysList:this._baseLayersList;container.appendChild(label);this._checkDisabledLayers();return label;},_onInputClick:function _onInputClick(){var inputs=this._form.getElementsByTagName('input'),input,layer,hasLayer;var addedLayers=[],removedLayers=[];this._handlingClick=true;for(var i=inputs.length-1;i>=0;i--){input=inputs[i];layer=this._getLayer(input.layerId).layer;hasLayer=this._map.hasLayer(layer);if(input.checked&&!hasLayer){addedLayers.push(layer);}else if(!input.checked&&hasLayer){removedLayers.push(layer);}}
for(i=0;i<removedLayers.length;i++){this._map.removeLayer(removedLayers[i]);}
for(i=0;i<addedLayers.length;i++){this._map.addLayer(addedLayers[i]);}
this._handlingClick=false;this._refocusOnMap();},_checkDisabledLayers:function _checkDisabledLayers(){var inputs=this._form.getElementsByTagName('input'),input,layer,zoom=this._map.getZoom();for(var i=inputs.length-1;i>=0;i--){input=inputs[i];layer=this._getLayer(input.layerId).layer;input.disabled=layer.options.minZoom!==undefined&&zoom<layer.options.minZoom||layer.options.maxZoom!==undefined&&zoom>layer.options.maxZoom;}},_expand:function _expand(){return this.expand();},_collapse:function _collapse(){return this.collapse();}});L.control.layers=function(baseLayers,overlays,options){return new L.Control.Layers(baseLayers,overlays,options);};})(window,document);});leafletSrc.Bounds.prototype.pad=function(bufferRatio){var min=this.min,max=this.max,heightBuffer=Math.abs(max.y-min.y)*bufferRatio,widthBuffer=Math.abs(max.x-min.x)*bufferRatio;return new leafletSrc.Bounds(new leafletSrc.point(min.x-widthBuffer,min.y-heightBuffer),new leafletSrc.point(max.x+widthBuffer,max.y+heightBuffer));};leafletSrc.Marker=leafletSrc.Marker.extend({options:leafletSrc.Util.extend({autoPan:false,autoPanPadding:[50,50],autoPanSpeed:10},leafletSrc.Marker.options)});leafletSrc.Handler.MarkerDrag=leafletSrc.Handler.MarkerDrag.extend({addHooks:function addHooks(){var icon=this._marker._icon;if(!this._draggable){this._draggable=new leafletSrc.Draggable(icon,icon,true);}
this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable();leafletSrc.DomUtil.addClass(icon,'leaflet-marker-draggable');},_adjustPan:function _adjustPan(e){var marker=this._marker,map=marker._map,padding=marker.options.autoPanPadding,speed=marker.options.autoPanSpeed;var iconPos=leafletSrc.DomUtil.getPosition(marker._icon),bounds=map.getPixelBounds(),origin=map.getPixelOrigin();var panBounds=leafletSrc.bounds(bounds.min._subtract(origin).add(padding),bounds.max._subtract(origin).subtract(padding));if(!panBounds.contains(iconPos)){var movement=leafletSrc.point((Math.max(panBounds.max.x,iconPos.x)-panBounds.max.x)/(bounds.max.x-panBounds.max.x)-(Math.min(panBounds.min.x,iconPos.x)-panBounds.min.x)/(bounds.min.x-panBounds.min.x),(Math.max(panBounds.max.y,iconPos.y)-panBounds.max.y)/(bounds.max.y-panBounds.max.y)-(Math.min(panBounds.min.y,iconPos.y)-panBounds.min.y)/(bounds.min.y-panBounds.min.y)).multiplyBy(speed);map.panBy(movement,{animate:false});this._draggable._newPos._add(movement);this._draggable._startPos._add(movement);leafletSrc.DomUtil.setPosition(marker._icon,this._draggable._newPos);this._onDrag(e);this._panRequest=leafletSrc.Util.requestAnimFrame(this._adjustPan.bind(this,e));}},_onPreDrag:function _onPreDrag(e){if(this._marker.options.autoPan){leafletSrc.Util.cancelAnimFrame(this._panRequest);this._panRequest=leafletSrc.Util.requestAnimFrame(this._adjustPan.bind(this,e));}},_onDragEnd:function _onDragEnd(e){leafletSrc.Util.cancelAnimFrame(this._panRequest);delete this._oldLatLng;this._marker.fire('moveend').fire('dragend',e);}});var createMarker=leafletSrc.marker;function createCircle(latLng,options){options=leafletSrc.Util.extend({clickable:false,editable:false,radius:300,zIndex:0},options);return new _class(latLng,options);}
var Util=leafletSrc.Util;var Circle=leafletSrc.Circle;var layerGroup=leafletSrc.layerGroup;var divIcon=leafletSrc.divIcon;var Draggable=leafletSrc.Draggable;var DomUtil=leafletSrc.DomUtil;var _class=function(_Circle){_inherits(_class,_Circle);function _class(center,options){_classCallCheck(this,_class);var _this=_possibleConstructorReturn(this,_Circle.call(this,center,Util.extend({moveIcon:divIcon({iconSize:[12,12],className:'maps__edit-icon maps__edit-icon--move'}),maxRadius:4000,minRadius:250,editable:false},options)));_this._guideOptions=Util.extend({},_this.options,{fill:false,opacity:0.4,editable:false});_this._markerGroup=layerGroup();_this._editCircle=null;return _this;}
_class.prototype.bindTooltip=function bindTooltip(content,options){var opt=Util.extend({permanent:true,direction:'right',sticky:false,opacity:1,anchor:'right',draggable:true},options);var ret=_Circle.prototype.bindTooltip.call(this,content,opt);if(opt.draggable){var tooltip=this.getTooltip(),el=tooltip.getElement(),draggable=new Draggable(el,el,true);el.style.pointerEvents='auto';draggable.on({drag:this._onMarkerDrag,dragstart:this._onMarkerDragStart,dragend:this._onMarkerDragEnd},this).enable();tooltip._draggable=draggable;}
return ret;};_class.prototype._updateBounds=function _updateBounds(){var tooltip=this._tooltip;_Circle.prototype._updateBounds.call(this);if(tooltip&&tooltip._map){tooltip._updatePosition();}};_class.prototype._getTooltipAnchor=function _getTooltipAnchor(){var anchor=this._tooltip.options.anchor;if(anchor){var circle=this._editCircle&&this._editCircle._map?this._editCircle:this,radius=circle._radius;var anchorPoint={x:anchor==='left'?-radius:anchor==='right'?radius:0,y:anchor==='top'?-radius:anchor==='bottom'?radius:0};return anchorPoint;}else if(_Circle.prototype._getTooltipAnchor){return _Circle.prototype._getTooltipAnchor.call(this);}else{return[0,0];}};_class.prototype._project=function _project(){_Circle.prototype._project.call(this);if(this.options.editable){this._initMarkers();}};_class.prototype._normalizeRadius=function _normalizeRadius(radius){var _options=this.options,minRadius=_options.minRadius,maxRadius=_options.maxRadius;if(typeof maxRadius==='number'){radius=Math.min(radius,maxRadius);}
if(typeof minRadius==='number'){radius=Math.max(radius,minRadius);}
return radius;};_class.prototype.setRadius=function setRadius(radius){radius=this._normalizeRadius(radius);this.fire('change',{latLng:this.getLatLng(),radius:radius});return _Circle.prototype.setRadius.call(this,radius);};_class.prototype.getCenter=function getCenter(){return _Circle.prototype.getLatLng.call(this);};_class.prototype.setEditable=function setEditable(editable){this.options.editable=editable;this.redraw();};_class.prototype.onAdd=function onAdd(map){this._markerGroup.addTo(map);return _Circle.prototype.onAdd.call(this,map);};_class.prototype.onRemove=function onRemove(map){this._markerGroup.removeFrom(map);return _Circle.prototype.onRemove.call(this,map);};_class.prototype._move=function _move(latLng){this._editCircle.setLatLng(latLng);this.fire('moving',{latLng:latLng});};_class.prototype._resize=function _resize(latLng){var moveLatLng=this.getLatLng();var radius=moveLatLng.distanceTo(latLng);radius=this._normalizeRadius(radius);this._editCircle.setRadius(radius);this.fire('resizing',{radius:radius});};_class.prototype._onMarkerDragStart=function _onMarkerDragStart(e){this._editCircle&&this._editCircle.remove();this._editCircle=createCircle(this.getLatLng(),Util.extend({},this._guideOptions,{radius:this.getRadius()})).addTo(this._map);};_class.prototype._onMarkerDragEnd=function _onMarkerDragEnd(e){this._editCircle.remove();this.setRadius(this._editCircle.getRadius());this.setLatLng(this._editCircle.getLatLng());this._editCircle=null;this.fire('change',{latLng:this.getLatLng(),radius:this.getRadius()});};_class.prototype._onMarkerDrag=function _onMarkerDrag(e){var target=e.target,latLng=target.getLatLng&&target.getLatLng()||this._map.layerPointToLatLng(DomUtil.getPosition(target._element));if(target===this._moveMarker){this._move(latLng);}else{this._resize(latLng);}};_class.prototype._bindMarker=function _bindMarker(marker){marker.on({drag:this._onMarkerDrag,dragstart:this._onMarkerDragStart,dragend:this._onMarkerDragEnd},this);this._markerGroup.addLayer(marker);};_class.prototype._initMarkers=function _initMarkers(){var _this2=this;if(!this._map){this._resizeMarkers=[];return;}
var map=this._map;var point=map.project(this.getLatLng()),delta=this._radius;this._markerGroup.clearLayers();this._resizeMarkers=[map.unproject([point.x+delta,point.y]),map.unproject([point.x,point.y+delta]),map.unproject([point.x-delta,point.y]),map.unproject([point.x,point.y-delta])].map(function(latLng,index){var marker=createMarker(latLng,{draggable:true,icon:_this2.options.moveIcon});_this2._bindMarker(marker);marker.addTo(map);return marker;});this._moveMarker&&this._moveMarker.remove();this._moveMarker=createMarker(this.getLatLng(),{draggable:true,icon:this.options.moveIcon});this._bindMarker(this._moveMarker);this._moveMarker.addTo(this._map);};return _class;}(Circle);var createPolyline=leafletSrc.polyline;var Util$1=leafletSrc.Util;var layerGroup$1=leafletSrc.layerGroup;var Polygon=leafletSrc.Polygon;var divIcon$1=leafletSrc.divIcon;var _class$1=function(_Polygon){_inherits(_class,_Polygon);function _class(path,options){_classCallCheck(this,_class);var _this=_possibleConstructorReturn(this,_Polygon.call(this,path,Util$1.extend({addIcon:divIcon$1({iconSize:[12,12],className:'maps__edit-icon maps__edit-icon--move maps__edit-icon--add'}),moveIcon:divIcon$1({iconSize:[12,12],className:'maps__edit-icon maps__edit-icon--move'}),editable:false},options)));_this._markerGroup=layerGroup$1();return _this;}
_class.prototype._project=function _project(){_Polygon.prototype._project.call(this);if(this.options.editable){this._initMarkers();}};_class.prototype.setEditable=function setEditable(editable){this.options.editable=editable;this.redraw();};_class.prototype.getPath=function getPath(){return _Polygon.prototype.getLatLngs.call(this)[0];};_class.prototype.onAdd=function onAdd(map){_Polygon.prototype.onAdd.call(this,map);this._markerGroup.addTo(map);};_class.prototype.onRemove=function onRemove(map){_Polygon.prototype.onRemove.call(this,map);this._markerGroup.removeFrom(map);this._polyline&&this._polyline.remove();};_class.prototype._addVertex=function _addVertex(latLng,position){if(typeof position==='number'){var path=this.getPath();path=[].concat(path.slice(0,position),[latLng],path.slice(position));this.setLatLngs(path);}else{this.addLatLng(latLng);}
this.fire('pointadd',{latLng:latLng});};_class.prototype._updateMarker=function _updateMarker(latLng,position){var latLngs=this.getPath();latLngs[position]=latLng;this.setLatLngs(latLngs);};_class.prototype._onMarkerDrag=function _onMarkerDrag(e){var marker=e.target;var path=this._polyline.getLatLngs();path[1]=marker.getLatLng();this._polyline.setLatLngs(path);};_class.prototype._onMarkerDragEnd=function _onMarkerDragEnd(e){var marker=e.target,index=marker.index,latLng=marker.getLatLng();if(this._resizeMarkers[index]===marker){this._updateMarker(latLng,index);}else{this._addVertex(latLng,index);}
this._polyline.remove();this._polyline=null;};_class.prototype._onMarkerDragStart=function _onMarkerDragStart(e){var marker=e.target;this._polyline=createPolyline([marker.prev,marker.getLatLng(),marker.next],Util$1.extend({},this.options,{opacity:0.4,fill:false})).addTo(this._map);};_class.prototype._onMarkerClick=function _onMarkerClick(e){var marker=e.target;var path=this.getPath();if(path.length<=3){return;}
path=[].concat(path.slice(0,marker.index),path.slice(marker.index+1));this._markerGroup.removeLayer(marker);this.setLatLngs(path);};_class.prototype._bindMarker=function _bindMarker(marker){marker.on({drag:this._onMarkerDrag,dragstart:this._onMarkerDragStart,dragend:this._onMarkerDragEnd},this);this._markerGroup.addLayer(marker);};_class.prototype._initMarkers=function _initMarkers(){var path=this.getPath();this._markerGroup.clearLayers();this._resizeMarkers=new Array(path.length);for(var i=0;i<path.length;i++){var nextPoint=path[(i+1)%path.length],prevPoint=path[(i+path.length-1)%path.length],point=path[i];var addMarker=createMarker([(prevPoint.lat+point.lat)/2,(prevPoint.lng+point.lng)/2],{draggable:true,icon:this.options.addIcon});addMarker.index=i;addMarker.prev=prevPoint;addMarker.next=point;this._bindMarker(addMarker);var resizeMarker=createMarker(point,{draggable:true,icon:this.options.moveIcon});resizeMarker.index=i;resizeMarker.prev=prevPoint;resizeMarker.next=nextPoint;this._bindMarker(resizeMarker);resizeMarker.on('click',this._onMarkerClick,this);this._markerGroup.addLayer(resizeMarker);this._resizeMarkers[i]=resizeMarker;}};return _class;}(Polygon);function debounce$1(fn){var time=arguments.length>1&&arguments[1]!==undefined?arguments[1]:500;var context=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this;var _timeout=void 0;return function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
if(_timeout){clearTimeout(_timeout);}
_timeout=setTimeout(function(){fn.apply(context,args);},time);return function(){clearTimeout(_timeout);};};}
var DrawHandler=leafletSrc.Handler.extend({includes:leafletSrc.Evented.prototype,clear:function clear(){}});function createPolygon(path,options){options=leafletSrc.Util.extend({},options);return new _class$1(path,options);}
var Util$3=leafletSrc.Util;var setOptions=leafletSrc.setOptions;var divIcon$2=leafletSrc.divIcon;var layerGroup$2=leafletSrc.layerGroup;var DomEvent=leafletSrc.DomEvent;var Browser=leafletSrc.Browser;var DrawPolygon=function(_DrawHandler){_inherits(DrawPolygon,_DrawHandler);function DrawPolygon(){_classCallCheck(this,DrawPolygon);return _possibleConstructorReturn(this,_DrawHandler.apply(this,arguments));}
DrawPolygon.prototype.initialize=function initialize(map,options){this._map=map;this._container=map._container;this._guideOptions=Util$3.extend({},options,{fill:true});setOptions(this,Util$3.extend({pathIcon:divIcon$2({iconSize:[16,16],className:'maps__edit-icon'}),closeIcon:divIcon$2({iconSize:[16,16],className:'maps__edit-icon maps__edit-icon--close'}),closeTitle:'Clicca per chiudere il poligono'},options));this._addVertex=debounce$1(this._addVertex,1000/30,this);};DrawPolygon.prototype.addHooks=function addHooks(){var map=this._map;this._polyline=createPolyline([],this._guideOptions);this._markerGroup=layerGroup$2();this._polyline.addTo(map);this._markerGroup.addTo(map);this._mapDblClickZoomable=this._map.doubleClickZoom.enabled();if(this._mapDblClickZoomable){this._map.doubleClickZoom.disable();}
map.on({mousemove:Browser.mobile?function(){}:this._onMouseMove,click:this._onClick,dblclick:this._onDblClick},this);};DrawPolygon.prototype.removeHooks=function removeHooks(){var map=this._map;map.off({mousemove:this._onMouseMove,click:this._onClick,dblclick:this._onDblClick},this);this._polyline.remove();this._polyline=null;this._markerGroup.remove();this._markerGroup=null;if(this._mapDblClickZoomable){this._map.doubleClickZoom.enable();}};DrawPolygon.prototype.clear=function clear(){if(this.enabled()){this._polyline.setLatLngs([]);this._markerGroup.clearLayers();}};DrawPolygon.prototype._completeDrawing=function _completeDrawing(e){var path=this._polyline.getLatLngs().slice(0,-1);this.fire('complete',{overlay:createPolygon(path,this.options)});this.disable();};DrawPolygon.prototype._addMarker=function _addMarker(latLng){var marker=createMarker(latLng,{draggable:false,icon:this.options.pathIcon});this._markerGroup.addLayer(marker);return marker;};DrawPolygon.prototype._addVertex=function _addVertex(latLng){var polyline=this._polyline,path=this._polyline.getLatLngs();this._addMarker(latLng);if(path.length===0){path.push(latLng);}else if(path.length===3){var markers=this._markerGroup.getLayers();this._markerGroup.removeLayer(markers[0]);var marker=createMarker(markers[0].getLatLng(),{icon:this.options.closeIcon,title:this.options.closeTitle});marker.on('click',this._completeDrawing,this);this._markerGroup.addLayer(marker);}
path[path.length-1]=latLng;path.push(latLng);polyline.setLatLngs(path);this.fire('pointadd',{latLng:latLng,overlay:polyline});};DrawPolygon.prototype._onDblClick=function _onDblClick(e){DomEvent.stop(e);this._blockAddVertex&&this._blockAddVertex();var path=this._polyline.getLatLngs();if(path.length>3){this._completeDrawing();}};DrawPolygon.prototype._onClick=function _onClick(e){var latLng=e.latlng;this._blockAddVertex=this._addVertex(latLng);};DrawPolygon.prototype._onMouseMove=function _onMouseMove(e){DomEvent.stop(e);var latLng=e.latlng;var path=this._polyline.getLatLngs();if(path.length===0){return;}
path[path.length-1]=latLng;this._polyline.setLatLngs(path);};return DrawPolygon;}(DrawHandler);var setOptions$1=leafletSrc.setOptions;var DomEvent$1=leafletSrc.DomEvent;var Util$4=leafletSrc.Util;var DrawCircle=function(_DrawHandler){_inherits(DrawCircle,_DrawHandler);function DrawCircle(){_classCallCheck(this,DrawCircle);return _possibleConstructorReturn(this,_DrawHandler.apply(this,arguments));}
DrawCircle.prototype.initialize=function initialize(map,options){this._map=map;this._guideOptions=leafletSrc.Util.extend({},options,{editable:false});setOptions$1(this,options);};DrawCircle.prototype._getZoomPropRadius=function _getZoomPropRadius(zoom){var radius=this.options.radius;var div=zoom<13?1:3;if(zoom<15){radius=Math.ceil(radius*(16/zoom)*(10/div)/1000)*1000;}
return radius;};DrawCircle.prototype._completeDrawing=function _completeDrawing(latLng,radius){this.fire('complete',{overlay:createCircle(latLng,Util$4.extend({},this.options,{radius:radius}))});this.disable();};DrawCircle.prototype._onClick=function _onClick(e){var zoom=this._map.getZoom();var radius=this._getZoomPropRadius(zoom);this._completeDrawing(e.latlng,radius);};DrawCircle.prototype._onMouseDown=function _onMouseDown(e){this._dragged=false;this._map.on({mousemove:this._onMouseMove,touchmove:this._onMouseMove},this);DomEvent$1.preventDefault(e.originalEvent).stopPropagation(e.originalEvent);};DrawCircle.prototype._onMouseUp=function _onMouseUp(e){this._map.off({mousemove:this._onMouseMove,touchmove:this._onMouseMove},this);DomEvent$1.off(document,{mouseup:this._onMouseUp,touchend:this._onMouseUp},this);if(this._dragged){this._completeDrawing(this._circle.getLatLng(),this._circle.getRadius());this._circle.remove();this._circle=null;}};DrawCircle.prototype._onMouseMove=function _onMouseMove(e){if(!this._dragged){this._circle=createCircle(e.latlng,this._guideOptions);this._circle.addTo(this._map);this._dragged=true;DomEvent$1.on(document,{mouseup:this._onMouseUp,touchend:this._onMouseUp},this);}
var radius=e.latlng.distanceTo(this._circle.getLatLng());this._circle.setRadius(this.options.maxRadius?Math.min(radius,this.options.maxRadius):radius);};DrawCircle.prototype.addHooks=function addHooks(){var draggable=this.options.draggable;if(draggable){this._mapDraggable=this._map.dragging.enabled();if(this._mapDraggable){this._map.dragging.disable();}}
var events={click:this._onClick};if(draggable){events['mousedown']=this._onMouseDown;events['touchstart']=this._onMouseDown;}
this._map.on(events,this);};DrawCircle.prototype.removeHooks=function removeHooks(){var draggable=this.options.draggable;if(draggable&&this._mapDraggable){this._map.dragging.enable();}
this._map.off({click:this._onClick,mousedown:this._onMouseDown,touchstart:this._onMouseDown,mousemove:this._onMouseMove,touchmove:this._onMouseMove},this);};return DrawCircle;}(DrawHandler);var Util$2=leafletSrc.Util;var Evented=leafletSrc.Evented;var DomUtil$1=leafletSrc.DomUtil;var DrawingModes={Polygon:'polygon',Circle:'circle'};var DrawingManager=function(_Evented){_inherits(DrawingManager,_Evented);function DrawingManager(map,options){_classCallCheck(this,DrawingManager);var _this=_possibleConstructorReturn(this,_Evented.call(this));_this._map=map;_this._mapContainer=_this._map.getContainer();_this.options=Util$2.extend({circleOptions:{radius:250,editable:true},polygonOptions:{editable:true},fitShape:true,fitPadding:0.2,drawingMode:null,editingClass:'maps--editing'},options);_this._drawingMode=_this.options.drawingMode;_this._handlers={};_this._shapes={};_this._addHandler(DrawingModes.Circle,new DrawCircle(map,_this.options.circleOptions));_this._addHandler(DrawingModes.Polygon,new DrawPolygon(map,_this.options.polygonOptions));return _this;}
DrawingManager.prototype._addHandler=function _addHandler(mode,handler){this._handlers[mode]=handler;handler.on('complete',this._onComplete,this);handler.on('pointadd',this._onPointAdd,this);};DrawingManager.prototype.onRemove=function onRemove(map){_Evented.prototype.onRemove.call(this,map);map.off('click',this._onClick);};DrawingManager.prototype.setShape=function setShape(mode,shape){this._shapes[mode]=shape;if(this._drawingMode===mode){this._showShape(mode);}};DrawingManager.prototype.getShape=function getShape(){return this._shapes[this._drawingMode];};DrawingManager.prototype._hideShape=function _hideShape(drawingMode){this._shapes[drawingMode]&&this._shapes[drawingMode].remove();};DrawingManager.prototype._showShape=function _showShape(drawingMode){var shape=this._shapes[drawingMode];this._map.addLayer(shape);if(this.options.fitShape){this._map.fitBounds(shape.getBounds().pad(this.options.fitPadding));}};DrawingManager.prototype._onComplete=function _onComplete(e){DomUtil$1.removeClass(this._mapContainer,this.options.editingClass);this.setShape(this._drawingMode,e.overlay);this.fire('overlaycomplete',e);this.fire(this._drawingMode+'complete',e);};DrawingManager.prototype._onPointAdd=function _onPointAdd(e){this.fire('pointadd',e);};DrawingManager.prototype._enableHandler=function _enableHandler(enabledMode){for(var mode in this._handlers){var handler=this._handlers[mode];if(mode===enabledMode){handler.enable();}else{handler.disable();}}};DrawingManager.prototype.getHandler=function getHandler(){var mode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._drawingMode;return this._handlers[mode];};DrawingManager.prototype.setDrawingMode=function setDrawingMode(drawingMode){var shape=this._shapes[drawingMode];if(drawingMode===this._drawingMode&&shape){return;}
this._hideShape(this._drawingMode);if(shape){this._enableHandler();this._showShape(drawingMode);DomUtil$1.removeClass(this._mapContainer,this.options.editingClass);}else{this._enableHandler(drawingMode);DomUtil$1.addClass(this._mapContainer,this.options.editingClass);}
this._drawingMode=drawingMode;return this.getHandler();};DrawingManager.prototype.getDrawingMode=function getDrawingMode(){return this._drawingMode;};DrawingManager.prototype.clear=function clear(){var mode=this._drawingMode;this._handlers[mode].clear();this._shapes[mode]&&this._shapes[mode].remove();this._shapes[mode]=null;this.setDrawingMode(mode);};return DrawingManager;}(Evented);var getPageLang=function getPageLang(){return document.documentElement&&document.documentElement.lang?document.documentElement.lang:'it-IT';};var CONFIG=__MAPS_SERVICES_CONFIG__;var ENV=CONFIG.env;var CONSUMER_KEY=CONFIG.consumerKey||'';var ATTRIBUTION='&copy; '+(CONFIG.attribution||'Immobiliare.it')+', <a href="http://osm.org/copyright" target="_blank" rel="noopener" >OpenStreetMap</a> contributors';var LANGUAGE=CONFIG.language||getPageLang();var TILES_URL_TEMPLATE=CONFIG.tilesUrlTemplate||'';var GEOCODE_URL_TEMPLATE=CONFIG.geocoderUrlTemplate||'';var GEOCODE_URL=GEOCODE_URL_TEMPLATE.replace('{service}','geocode');var REVERSE_GEOCODE_URL=GEOCODE_URL_TEMPLATE.replace('{service}','reverse');var AUTOCOMPLETE_GEOCODE_URL=GEOCODE_URL_TEMPLATE.replace('{service}','autocomplete');var GEOCODE_KEY=ENV==='dev'?'dev':CONSUMER_KEY;function serialize(data){var prefix=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var serialized=[];for(var key in data){var value=data[key];if(value==void 0){continue;}
key=prefix?prefix+('['+encodeURIComponent(key)+']'):encodeURIComponent(key);if(typeof value==='object'){var child=serialize(value,key);child&&serialized.push(child);}else{serialized.push(key+'='+encodeURIComponent(value));}}
return serialized.join('&');}
function join(url,querystring){var qsStart=url.indexOf('?');var anchorStart=url.indexOf('#');var anchor='';if(anchorStart!==-1){anchor=url.substring(anchorStart);url=url.substring(0,anchorStart);}
if(qsStart===-1){url+='?';}else if(qsStart<url.length-1){url+='&';}
return url+querystring+anchor;}
var SUBDOMAINS=CONFIG.tilesSubdomains||['01','02','03','04','05'];var normalizeLanguage=function normalizeLanguage(language){return language.substring(0,2).toLowerCase();};var getTilesUrl=function getTilesUrl(){var language=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'it';var scale=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return join(TILES_URL_TEMPLATE,serialize({language:normalizeLanguage(language),scale:scale}));};var Map$1=function(_L$Map){_inherits(Map,_L$Map);function Map(element){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Map);options=leafletSrc.Util.extend({fadeAnimation:false,scrollWheelZoom:false},options);var _this=_possibleConstructorReturn(this,_L$Map.call(this,element,options));_this.attributionControl.setPrefix('');var language=options.language||LANGUAGE;_this._tileLayer=new leafletSrc.TileLayer(getTilesUrl(language,leafletSrc.Browser.retina?2:1),{attribution:ATTRIBUTION,subdomains:SUBDOMAINS});_this._tileLayer.addTo(_this);if(options.zoomControl&&options.zoomControlPosition){_this.zoomControl.setPosition(options.zoomControlPosition);}
window._m=_this;return _this;}
Map.prototype.remove=function remove(){_L$Map.prototype.remove.call(this);window._m=null;};Map.prototype.getTileLayer=function getTileLayer(){return this._tileLayer;};return Map;}(leafletSrc.Map);__$styleInject(".leaflet-image-layer,.leaflet-layer,.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-pane,.leaflet-pane>canvas,.leaflet-pane>svg,.leaflet-tile,.leaflet-tile-container,.leaflet-zoom-box{position:absolute;left:0;top:0}.leaflet-container{overflow:hidden}.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-tile{-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-user-drag:none}.leaflet-safari .leaflet-tile{image-rendering:-webkit-optimize-contrast}.leaflet-safari .leaflet-tile-container{width:1600px;height:1600px;-webkit-transform-origin:0 0}.leaflet-marker-icon,.leaflet-marker-shadow{display:block}.leaflet-container .leaflet-marker-pane img,.leaflet-container .leaflet-overlay-pane svg,.leaflet-container .leaflet-shadow-pane img,.leaflet-container .leaflet-tile-pane img,.leaflet-container img.leaflet-image-layer{max-width:none!important}.leaflet-container.leaflet-touch-zoom{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.leaflet-container.leaflet-touch-drag{-ms-touch-action:pinch-zoom}.leaflet-container.leaflet-touch-drag.leaflet-touch-zoom{-ms-touch-action:none;touch-action:none}.leaflet-tile{filter:inherit;visibility:hidden}.leaflet-tile-loaded{visibility:inherit}.leaflet-zoom-box{width:0;height:0;-moz-box-sizing:border-box;box-sizing:border-box;z-index:800}.leaflet-overlay-pane svg{-moz-user-select:none}.leaflet-pane{z-index:400}.leaflet-tile-pane{z-index:200}.leaflet-overlay-pane{z-index:400}.leaflet-shadow-pane{z-index:500}.leaflet-marker-pane{z-index:600}.leaflet-tooltip-pane{z-index:650}.leaflet-popup-pane{z-index:700}.leaflet-map-pane canvas{z-index:100}.leaflet-map-pane svg{z-index:200}.leaflet-vml-shape{width:1px;height:1px}.lvml{behavior:url(#default#VML);display:inline-block;position:absolute}.leaflet-control{position:relative;z-index:800;pointer-events:visiblePainted;pointer-events:auto}.leaflet-bottom,.leaflet-top{position:absolute;z-index:1000;pointer-events:none}.leaflet-top{top:0}.leaflet-right{right:0}.leaflet-bottom{bottom:0}.leaflet-left{left:0}.leaflet-control{float:left;clear:both}.leaflet-right .leaflet-control{float:right}.leaflet-top .leaflet-control{margin-top:10px}.leaflet-bottom .leaflet-control{margin-bottom:10px}.leaflet-left .leaflet-control{margin-left:10px}.leaflet-right .leaflet-control{margin-right:10px}.leaflet-fade-anim .leaflet-tile{will-change:opacity}.leaflet-fade-anim .leaflet-popup{opacity:0;-webkit-transition:opacity .2s linear;-moz-transition:opacity .2s linear;-o-transition:opacity .2s linear;transition:opacity .2s linear}.leaflet-fade-anim .leaflet-map-pane .leaflet-popup{opacity:1}.leaflet-zoom-animated{-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0}.leaflet-zoom-anim .leaflet-zoom-animated{will-change:transform;-webkit-transition:-webkit-transform .25s cubic-bezier(0,0,.25,1);-moz-transition:-moz-transform .25s cubic-bezier(0,0,.25,1);-o-transition:-o-transform .25s cubic-bezier(0,0,.25,1);transition:transform .25s cubic-bezier(0,0,.25,1)}.leaflet-pan-anim .leaflet-tile,.leaflet-zoom-anim .leaflet-tile{-webkit-transition:none;-moz-transition:none;-o-transition:none;transition:none}.leaflet-zoom-anim .leaflet-zoom-hide{visibility:hidden}.leaflet-interactive{cursor:pointer}.leaflet-grab{cursor:-webkit-grab;cursor:-moz-grab}.leaflet-crosshair,.leaflet-crosshair .leaflet-interactive{cursor:crosshair}.leaflet-control,.leaflet-popup-pane{cursor:auto}.leaflet-dragging .leaflet-grab,.leaflet-dragging .leaflet-grab .leaflet-interactive,.leaflet-dragging .leaflet-marker-draggable{cursor:move;cursor:-webkit-grabbing;cursor:-moz-grabbing}.leaflet-image-layer,.leaflet-marker-icon,.leaflet-marker-shadow,.leaflet-pane>svg path,.leaflet-tile-container{pointer-events:none}.leaflet-image-layer.leaflet-interactive,.leaflet-marker-icon.leaflet-interactive,.leaflet-pane>svg path.leaflet-interactive{pointer-events:visiblePainted;pointer-events:auto}.leaflet-container{background:#ddd;outline:0}.leaflet-container a{color:#0078a8}.leaflet-container a.leaflet-active{outline:2px solid orange}.leaflet-zoom-box{border:2px dotted #38f;background:hsla(0,0%,100%,.5)}.leaflet-container{font:12px/1.5 Helvetica Neue,Arial,Helvetica,sans-serif}.leaflet-bar{box-shadow:0 1px 5px rgba(0,0,0,.65);border-radius:4px}.leaflet-bar a,.leaflet-bar a:hover{background-color:#fff;border-bottom:1px solid #ccc;width:26px;height:26px;line-height:26px;display:block;text-align:center;text-decoration:none;color:#000}.leaflet-bar a,.leaflet-control-layers-toggle{background-position:50% 50%;background-repeat:no-repeat;display:block}.leaflet-bar a:hover{background-color:#f4f4f4}.leaflet-bar a:first-child{border-top-left-radius:4px;border-top-right-radius:4px}.leaflet-bar a:last-child{border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:none}.leaflet-bar a.leaflet-disabled{cursor:default;background-color:#f4f4f4;color:#bbb}.leaflet-touch .leaflet-bar a{width:30px;height:30px;line-height:30px}.leaflet-control-zoom-in,.leaflet-control-zoom-out{font:700 18px Lucida Console,Monaco,monospace;text-indent:1px}.leaflet-control-zoom-out{font-size:20px}.leaflet-touch .leaflet-control-zoom-in{font-size:22px}.leaflet-touch .leaflet-control-zoom-out{font-size:24px}.leaflet-control-layers{box-shadow:0 1px 5px rgba(0,0,0,.4);background:#fff;border-radius:5px}.leaflet-control-layers-toggle{background-image:url(images/layers.png);width:36px;height:36px}.leaflet-retina .leaflet-control-layers-toggle{background-image:url(images/layers-2x.png);background-size:26px 26px}.leaflet-touch .leaflet-control-layers-toggle{width:44px;height:44px}.leaflet-control-layers-expanded .leaflet-control-layers-toggle,.leaflet-control-layers .leaflet-control-layers-list{display:none}.leaflet-control-layers-expanded .leaflet-control-layers-list{display:block;position:relative}.leaflet-control-layers-expanded{padding:6px 10px 6px 6px;color:#333;background:#fff}.leaflet-control-layers-scrollbar{overflow-y:scroll;padding-right:5px}.leaflet-control-layers-selector{margin-top:2px;position:relative;top:1px}.leaflet-control-layers label{display:block}.leaflet-control-layers-separator{height:0;border-top:1px solid #ddd;margin:5px -10px 5px -6px}.leaflet-default-icon-path{background-image:url(images/marker-icon.png)}.leaflet-container .leaflet-control-attribution{background:#fff;background:hsla(0,0%,100%,.7);margin:0}.leaflet-control-attribution,.leaflet-control-scale-line{padding:0 5px;color:#333}.leaflet-control-attribution a{text-decoration:none}.leaflet-control-attribution a:hover{text-decoration:underline}.leaflet-container .leaflet-control-attribution,.leaflet-container .leaflet-control-scale{font-size:11px}.leaflet-left .leaflet-control-scale{margin-left:5px}.leaflet-bottom .leaflet-control-scale{margin-bottom:5px}.leaflet-control-scale-line{border:2px solid #777;border-top:none;line-height:1.1;padding:2px 5px 1px;font-size:11px;white-space:nowrap;overflow:hidden;-moz-box-sizing:border-box;box-sizing:border-box;background:#fff;background:hsla(0,0%,100%,.5)}.leaflet-control-scale-line:not(:first-child){border-top:2px solid #777;border-bottom:none;margin-top:-2px}.leaflet-control-scale-line:not(:first-child):not(:last-child){border-bottom:2px solid #777}.leaflet-touch .leaflet-bar,.leaflet-touch .leaflet-control-attribution,.leaflet-touch .leaflet-control-layers{box-shadow:none}.leaflet-touch .leaflet-bar,.leaflet-touch .leaflet-control-layers{border:2px solid rgba(0,0,0,.2);background-clip:padding-box}.leaflet-popup{position:absolute;text-align:center;margin-bottom:20px}.leaflet-popup-content-wrapper{padding:1px;text-align:left;border-radius:12px}.leaflet-popup-content{margin:13px 19px;line-height:1.4}.leaflet-popup-content p{margin:18px 0}.leaflet-popup-tip-container{width:40px;height:20px;position:absolute;left:50%;margin-left:-20px;overflow:hidden;pointer-events:none}.leaflet-popup-tip{width:17px;height:17px;padding:1px;margin:-10px auto 0;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}.leaflet-popup-content-wrapper,.leaflet-popup-tip{background:#fff;color:#333;box-shadow:0 3px 14px rgba(0,0,0,.4)}.leaflet-container a.leaflet-popup-close-button{position:absolute;top:0;right:0;padding:4px 4px 0 0;border:none;text-align:center;width:18px;height:14px;font:16px/14px Tahoma,Verdana,sans-serif;color:#c3c3c3;text-decoration:none;font-weight:700;background:transparent}.leaflet-container a.leaflet-popup-close-button:hover{color:#999}.leaflet-popup-scrolled{overflow:auto;border-bottom:1px solid #ddd;border-top:1px solid #ddd}.leaflet-oldie .leaflet-popup-content-wrapper{zoom:1}.leaflet-oldie .leaflet-popup-tip{width:24px;margin:0 auto;-ms-filter:\"progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678)\";filter:progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678,M12=0.70710678,M21=-0.70710678,M22=0.70710678)}.leaflet-oldie .leaflet-popup-tip-container{margin-top:-1px}.leaflet-oldie .leaflet-control-layers,.leaflet-oldie .leaflet-control-zoom,.leaflet-oldie .leaflet-popup-content-wrapper,.leaflet-oldie .leaflet-popup-tip{border:1px solid #999}.leaflet-div-icon{background:#fff;border:1px solid #666}.leaflet-tooltip{position:absolute;padding:6px;background-color:#fff;border:1px solid #fff;border-radius:3px;color:#222;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;box-shadow:0 1px 3px rgba(0,0,0,.4)}.leaflet-tooltip.leaflet-clickable{cursor:pointer;pointer-events:auto}.leaflet-tooltip-bottom:before,.leaflet-tooltip-left:before,.leaflet-tooltip-right:before,.leaflet-tooltip-top:before{position:absolute;pointer-events:none;border:6px solid transparent;background:transparent;content:\"\"}.leaflet-tooltip-bottom{margin-top:6px}.leaflet-tooltip-top{margin-top:-6px}.leaflet-tooltip-bottom:before,.leaflet-tooltip-top:before{left:50%;margin-left:-6px}.leaflet-tooltip-top:before{bottom:0;margin-bottom:-12px;border-top-color:#fff}.leaflet-tooltip-bottom:before{top:0;margin-top:-12px;margin-left:-6px;border-bottom-color:#fff}.leaflet-tooltip-left{margin-left:-6px}.leaflet-tooltip-right{margin-left:6px}.leaflet-tooltip-left:before,.leaflet-tooltip-right:before{top:50%;margin-top:-6px}.leaflet-tooltip-left:before{right:0;margin-right:-12px;border-left-color:#fff}.leaflet-tooltip-right:before{left:0;margin-left:-12px;border-right-color:#fff}",undefined);__$styleInject(".leaflet-control-container>div{width:100%}.leaflet-container{z-index:0}.leaflet-map-pane canvas{z-index:inherit}.leaflet-touch .leaflet-bar a{line-height:inherit}.maps__edit-icon{opacity:1;border:1px solid #0e4e73;background-color:#fff}.maps__edit-icon--move{border-radius:50%}.maps__edit-icon--add{opacity:.6}.maps__edit-icon--close{border-color:#730e0e;background-color:red}.leaflet-left .leaflet-control{margin-left:15px}.leaflet-top .leaflet-control{margin-top:15px}.leaflet-control-zoom-in,.leaflet-control-zoom-out{text-indent:0;color:transparent!important;position:relative}.leaflet-control-zoom.leaflet-bar a,.leaflet-control-zoom.leaflet-bar a:hover{width:31px;height:32px}.leaflet-bar{box-shadow:0 1px 3px 1px rgba(0,0,0,.3)}.leaflet-bar a:first-child{border-top-left-radius:2px;border-top-right-radius:2px}.leaflet-control-zoom-in:before{content:\"\";top:9px;bottom:9px;border:1px solid #666;width:3px;left:14px;position:absolute;background-color:#666;box-sizing:border-box}.leaflet-control-zoom-in:after,.leaflet-control-zoom-out:after{content:\"\";left:10px;right:10px;border:1px solid #666;height:3px;top:14px;position:absolute;background-color:#666;box-sizing:border-box}.leaflet-control-zoom-in:after{left:9px;right:9px}.leaflet-bar a.leaflet-disabled.leaflet-control-zoom-in,.leaflet-bar a.leaflet-disabled.leaflet-control-zoom-out{background-color:#fff}",undefined);var LatLng=function(){function LatLng(lat,lng){_classCallCheck(this,LatLng);this.lat=function(){return lat;};this.lng=function(){return lng;};this.lat.toString=this.lat;this.lng.toString=this.lng;}
LatLng.prototype.toJSON=function toJSON(){return{lat:+this.lat,lng:+this.lng};};LatLng.prototype.toString=function toString(){return JSON.stringify(this.toJSON());};LatLng.prototype.toUrlValue=function toUrlValue(){return this.lat+","+this.lng;};return LatLng;}();function toInternalLatLng(latLng){return new LatLng(latLng.lat,latLng.lng);}
var LatLngBounds=function(_L$LatLngBounds){_inherits(LatLngBounds,_L$LatLngBounds);function LatLngBounds(){_classCallCheck(this,LatLngBounds);return _possibleConstructorReturn(this,_L$LatLngBounds.apply(this,arguments));}
LatLngBounds.prototype.getCenter=function getCenter(){return toInternalLatLng(_L$LatLngBounds.prototype.getCenter.call(this));};LatLngBounds.prototype.getSouthWest=function getSouthWest(){return toInternalLatLng(_L$LatLngBounds.prototype.getSouthWest.call(this));};LatLngBounds.prototype.getNorthEast=function getNorthEast(){return toInternalLatLng(_L$LatLngBounds.prototype.getNorthEast.call(this));};LatLngBounds.prototype.getNorthWest=function getNorthWest(){return toInternalLatLng(_L$LatLngBounds.prototype.getNorthWest.call(this));};LatLngBounds.prototype.getSouthEast=function getSouthEast(){return toInternalLatLng(_L$LatLngBounds.prototype.getSouthEast.call(this));};LatLngBounds.prototype.isEmpty=function isEmpty(){return this.isValid();};LatLngBounds.prototype.toJSON=function toJSON(){return{east:this.getEast(),north:this.getNorth(),south:this.getSouth(),west:this.getWest()};};LatLngBounds.prototype.toString=function toString(){return JSON.stringify(this.toJSON());};LatLngBounds.prototype.toUrlValue=function toUrlValue(){return this.getSouth()+','+this.getWest()+','+this.getNorth()+','+this.getEast();};LatLngBounds.prototype.union=function union(bounds){return this.extend(bounds);};return LatLngBounds;}(leafletSrc.LatLngBounds);function toInternalLatLngBounds(bounds){return new LatLngBounds(bounds.getNorthEast(),bounds.getSouthWest());}
function mitt(all){all=all||Object.create(null);return{on:function on(type,handler){(all[type]||(all[type]=[])).push(handler);},off:function off(type,handler){if(all[type]){all[type].splice(all[type].indexOf(handler)>>>0,1);}},emit:function emit(type,evt){(all[type]||[]).map(function(handler){handler(evt);});(all['*']||[]).map(function(handler){handler(type,evt);});}};}
var MVCArray=function(){function MVCArray(){var array=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,MVCArray);this.array=array;this._emitter=mitt();}
MVCArray.prototype.forEach=function forEach(callback){this.array.forEach(callback);};MVCArray.prototype.getArray=function getArray(){return this.array;};MVCArray.prototype.clear=function clear(){this.array.length=0;};MVCArray.prototype.getLength=function getLength(){return this.array.length;};MVCArray.prototype.setAt=function setAt(i,value){this.array=[].concat(this.array.slice(0,i),[value],this.array.slice(i+1));this._emitter.emit('set_at',i);};MVCArray.prototype.insertAt=function insertAt(i,value){this.array=[].concat(this.array.slice(0,i),[value],this.array.slice(i));this._emitter.emit('insert_at',i);};MVCArray.prototype.getAt=function getAt(i){return this.array[i];};MVCArray.prototype.removeAt=function removeAt(i){this.array=[].concat(this.array.slice(0,i),this.array.slice(i+1));this._emitter.emit('remove_at',i);};MVCArray.prototype.pop=function pop(){return this.array.pop();};MVCArray.prototype.push=function push(elem){this.array.push(elem);};MVCArray.prototype.addEventListener=function addEventListener(event,callback){this._emitter.on(event,callback);};MVCArray.prototype.removeEventListener=function removeEventListener(event,callback){this._emitter.off(event,callback);};return MVCArray;}();var OverlayMapTypes=function(_MVCArray){_inherits(OverlayMapTypes,_MVCArray);function OverlayMapTypes(map){_classCallCheck(this,OverlayMapTypes);var _this=_possibleConstructorReturn(this,_MVCArray.call(this));_this.map=map;return _this;}
OverlayMapTypes.prototype.clear=function clear(){this.forEach(function(layer){layer.remove();});this.array.length=0;};OverlayMapTypes.prototype.setAt=function setAt(i,value){var prev=this.getAt(i);_MVCArray.prototype.setAt.call(this,i,value);prev.remove();value.addTo(this.map);};OverlayMapTypes.prototype.insertAt=function insertAt(i,value){_MVCArray.prototype.insertAt.call(this,i,value);value.addTo(this.map);};OverlayMapTypes.prototype.removeAt=function removeAt(i){this.getAt(i).remove();_MVCArray.prototype.removeAt.call(this,i);};OverlayMapTypes.prototype.pop=function pop(){var layer=_MVCArray.prototype.pop.call(this);layer.remove();return layer;};OverlayMapTypes.prototype.push=function push(value){_MVCArray.prototype.push.call(this,value);value.addTo(this.map);};return OverlayMapTypes;}(MVCArray);var ControlPosition={BOTTOM_CENTER:'bottomleft',BOTTOM_LEFT:'bottomleft',BOTTOM_RIGHT:'bottomright',LEFT_BOTTOM:'bottomleft',LEFT_CENTER:'topleft',LEFT_TOP:'topleft',RIGHT_BOTTOM:'bottomright',RIGHT_CENTER:'topright',RIGHT_TOP:'topright',TOP_CENTER:'topright',TOP_LEFT:'topleft',TOP_RIGHT:'topright'};function stopPropagation(e){e.stopPropagation();}
function controls(map){return['topleft','topright','bottomleft','bottomright'].reduce(function(acc,position){acc[position]={push:function push(el){var control=void 0;if(el===leafletSrc.control.zoom||el===leafletSrc.control.attribution){control=new el({position:position});}else{control=new leafletSrc.Control({position:position});control.onAdd=function(){leafletSrc.DomEvent.on(el,'mousedown',stopPropagation);return el;};}
map.addControl(control);}};return acc;},{});}
function mapOptions(options){if('scrollwheel'in options){options['scrollWheelZoom']=options['scrollwheel'];}
if('zoomControlPosition'in options){options['zoomControlPosition']=ControlPosition[options['zoomControlPosition']]||options['zoomControlPosition'];}
if('disableDefaultUI'in options){options['zoomControl']=false;}
return options;}
function pathOptions(options){var newName;for(var name in options){newName=name;if(name.match(/^stroke./)){newName=name.replace('stroke','').toLowerCase();}
if(name==='clickable'){newName='interactive';}
options[newName]=options[name];}
return options;}
function iconOptions(options){var value;for(var name in options){value=options[name];if(name==='url'){options['iconUrl']=options['iconRetinaUrl']=value;}else if(name==='size'){options['iconSize']=value;}else if(name==='origin'){options['bgPos']=value;}else if(name==='anchor'){options['iconAnchor']=value;}}
if(!options['iconAnchor']&&options['iconSize']){var size=leafletSrc.point(options['iconSize']);options['iconAnchor']=[size.x/2,size.y];}
options.className=options.className||'';return options;}
var INITIAL_ZOOM=15;var EventsMap={dragstart:'movestart',drag:'move',dragend:'moveend',tilesloaded:'tileload',bounds_changed:'move',zoom_changed:'zoomend'};var Map=function(_DefaultMap){_inherits(Map,_DefaultMap);function Map(element){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Map);options=leafletSrc.Util.extend({zoom:INITIAL_ZOOM},options||{});var _this=_possibleConstructorReturn(this,_DefaultMap.call(this,element,mapOptions(options)));_this.controls=controls(_this);_this.overlayMapTypes=new OverlayMapTypes(_this);var scrollEnabled=void 0;_this.on('movestart',function(){scrollEnabled=_this.scrollWheelZoom.enabled();_this.scrollWheelZoom.disable();});_this.on('moveend',function(){scrollEnabled&&_this.scrollWheelZoom.enable();});return _this;}
Map.prototype.getCenter=function getCenter(){return toInternalLatLng(_DefaultMap.prototype.getCenter.call(this));};Map.prototype.getBounds=function getBounds(){return toInternalLatLngBounds(_DefaultMap.prototype.getBounds.call(this));};Map.prototype.getDiv=function getDiv(){return _DefaultMap.prototype.getContainer.call(this);};Map.prototype.panBy=function panBy(x,y,options){var point=x;if(typeof point==='number'){point=new leafletSrc.Point(x,y);}else{options=y;}
_DefaultMap.prototype.panBy.call(this,point,options);};Map.prototype.setCenter=function setCenter(latLng){if(!latLng)return;this.setView(latLng,this.getZoom(),{reset:true});};Map.prototype.setOptions=function setOptions(options){leafletSrc.Util.setOptions(this,mapOptions(options));};Map.prototype.addListener=function addListener(event,callback){return this.addEventListener(event,callback);};Map.prototype.addEventListener=function addEventListener(event,callback){var listener=callback;if(event in EventsMap){event=EventsMap[event];}
if(event==='idle'){event='moveend';listener=debounce(callback);}
if(event==='tileload'){return this._tileLayer.addEventListener(event,listener);}
return _DefaultMap.prototype.addEventListener.call(this,event,listener);};Map.prototype.removeEventListener=function removeEventListener(event,callback){if(event in EventsMap){event=EventsMap[event];}
if(event==='tileload'){return this._tileLayer.removeEventListener(event,callback);}
return _DefaultMap.prototype.removeEventListener.call(this,event,callback);};Map.prototype.trigger=function trigger(event,data){if(event in EventsMap){event=EventsMap[event];}
if(event==='idle'){event='moveend';}
this.fire(event,data);};Map.prototype.getPanes=function getPanes(){var panes=_DefaultMap.prototype.getPanes.call(this);return leafletSrc.Util.extend({overlayLayer:panes.overlayPane,markerLayer:panes.markerPane,overlayMouseTarget:panes.tooltipPane,floatPane:panes.popupPane,overlayImage:panes.popupPane},panes);};Map.prototype.getStreetView=function getStreetView(){return{setPosition:function setPosition(){},setPov:function setPov(){},addEventListener:function addEventListener(){}};};Map.prototype.setStreetView=function setStreetView(){};return Map;}(Map$1);function debounce(fn){var timer=void 0;var obj=void 0;var args=void 0;function delayed(){fn.apply(obj,args);timer=null;}
return function(){obj=this;args=arguments;if(timer){clearTimeout(timer);}
timer=setTimeout(delayed,700);};}
var hasOwnProperty={}.hasOwnProperty;var assign=function(target){var to=Object(target);for(var i=1;i<arguments.length;i++){var from=Object(arguments[i]);for(var key in from){if(hasOwnProperty.call(from,key)){to[key]=from[key];}}}
return to;};var doRequest=function doRequest(url,params){if(params.language&&params.language==='it'){params.language='it-IT';}
return fetch(join(url,serialize(params)),{mode:'cors'}).then(function(response){return response.json();}).then(function(json){return assign({markAsConsumed:doStoreRequest(url,params,json.requestId)},json);});};var doStoreRequest=function doStoreRequest(url,params,requestId){return function(){return fetch(url,{mode:'cors',method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(assign({requestId:requestId},params))});};};var serializeBounds=function serializeBounds(bounds){return typeof bounds==='object'&&bounds!==null&&bounds.toBBoxString!==void 0?bounds.toBBoxString():bounds;};var serializeLatLng=function serializeLatLng(latLng){return typeof latLng==='object'&&latLng!==null?latLng.lat+','+latLng.lng:latLng;};var geocode=function geocode(request){return doRequest(GEOCODE_URL,{q:request.address,city:request.city,bbox:serializeBounds(request.bounds),proximity:serializeLatLng(request.proximity),language:request.language||LANGUAGE,limit:request.limit,key:GEOCODE_KEY});};var reverse=function reverse(request){return doRequest(REVERSE_GEOCODE_URL,{q:serializeLatLng(request.latLng),language:request.language||LANGUAGE,limit:request.limit,key:GEOCODE_KEY});};var promise=createCommonjsModule(function(module){(function(root){var setTimeoutFunc=setTimeout;function noop(){}
function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments);};}
function Promise(fn){if(typeof this!=='object')throw new TypeError('Promises must be constructed via new');if(typeof fn!=='function')throw new TypeError('not a function');this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this);}
function handle(self,deferred){while(self._state===3){self=self._value;}
if(self._state===0){self._deferreds.push(deferred);return;}
self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return;}
var ret;try{ret=cb(self._value);}catch(e){reject(deferred.promise,e);return;}
resolve(deferred.promise,ret);});}
function resolve(self,newValue){try{if(newValue===self)throw new TypeError('A promise cannot be resolved with itself.');if(newValue&&(typeof newValue==='object'||typeof newValue==='function')){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return;}else if(typeof then==='function'){doResolve(bind(then,newValue),self);return;}}
self._state=1;self._value=newValue;finale(self);}catch(e){reject(self,e);}}
function reject(self,newValue){self._state=2;self._value=newValue;finale(self);}
function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value);}});}
for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i]);}
self._deferreds=null;}
function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==='function'?onFulfilled:null;this.onRejected=typeof onRejected==='function'?onRejected:null;this.promise=promise;}
function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value);},function(reason){if(done)return;done=true;reject(self,reason);});}catch(ex){if(done)return;done=true;reject(self,ex);}}
Promise.prototype['catch']=function(onRejected){return this.then(null,onRejected);};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom;};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==='object'||typeof val==='function')){var then=val.then;if(typeof then==='function'){then.call(val,function(val){res(i,val);},reject);return;}}
args[i]=val;if(--remaining===0){resolve(args);}}catch(ex){reject(ex);}}
for(var i=0;i<args.length;i++){res(i,args[i]);}});};Promise.resolve=function(value){if(value&&typeof value==='object'&&value.constructor===Promise){return value;}
return new Promise(function(resolve){resolve(value);});};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value);});};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject);}});};Promise._immediateFn=typeof setImmediate==='function'&&function(fn){setImmediate(fn);}||function(fn){setTimeoutFunc(fn,0);};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=='undefined'&&console){console.warn('Possible Unhandled Promise Rejection:',err);}};Promise._setImmediateFn=function _setImmediateFn(fn){Promise._immediateFn=fn;};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(fn){Promise._unhandledRejectionFn=fn;};if('object'!=='undefined'&&module.exports){module.exports=Promise;}else if(!root.Promise){root.Promise=Promise;}})(commonjsGlobal);});var RequestAPI=function RequestAPI(url){return url.match(/^http(s)?:\/\//)&&url.indexOf(location.origin)!==0&&window.XDomainRequest||XMLHttpRequest;};var fetch$1=function(url,options){options=options||{};return new Promise(function(resolve,reject){var request=new(RequestAPI(url))();request.open(options.method||'get',url);for(var i in options.headers){request.setRequestHeader&&request.setRequestHeader(i,options.headers[i]);}
request.withCredentials=options.credentials=='include';request.onload=function(){resolve(response());};request.onprogress=skip;request.ontimeout=skip;request.onerror=reject;request.send(options.body);function response(){var _keys=[],all=[],headers={},header=void 0;request.getAllResponseHeaders&&request.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(m,key,value){_keys.push(key=key.toLowerCase());all.push([key,value]);header=headers[key];headers[key]=header?header+','+value:value;});return{ok:(request.status/200|0)==1,status:request.status,statusText:request.statusText,url:request.responseURL,clone:response,text:function text(){return Promise.resolve(request.responseText);},json:function json(){return Promise.resolve(request.responseText).then(JSON.parse);},xml:function xml(){return Promise.resolve(request.responseXML);},blob:function blob(){return Promise.resolve(new Blob([request.response]));},headers:{keys:function keys(){return _keys;},entries:function entries(){return all;},get:function get(n){return headers[n.toLowerCase()];},has:function has(n){return n.toLowerCase()in headers;}}};}});};function skip(){}
window.Promise=window.Promise||promise;window.fetch=fetch$1;var Geocoder=function Geocoder(){return{geocode:function geocode$$1(data,cb){var api=geocode;if(data.bounds===void 0&&window.__m){data.bounds=window.__m.getBounds();}else if(data.bounds){data.bounds=leafletSrc.latLngBounds(data.bounds);}
if(data.location||data.latLng){data.latLng=leafletSrc.latLng(data.latLng||data.location);api=reverse;}
return api(data).then(function(_ref){var results=_ref.results,markAsConsumed=_ref.markAsConsumed,status=_ref.status;cb(mapResultsLocation(results||[]),status,markAsConsumed);});}};};function mapResultsLocation(results){for(var i=0,len=results.length;i<len;i++){if(results[i].geometry&&results[i].geometry.location){results[i].geometry.location=toInternalLatLng(results[i].geometry.location);}}
return results;}
var GeocoderStatus={ERROR:'ERROR',INVALID_REQUEST:'INVALID_REQUEST',OK:'OK',OVER_QUERY_LIMIT:'OVER_QUERY_LIMIT',REQUEST_DENIED:'REQUEST_DENIED',UNKNOWN_ERROR:'UNKNOWN_ERROR',ZERO_RESULTS:'ZERO_RESULTS'};var Marker_Drag=createCommonjsModule(function(module){'use strict';var _leaflet2=_interopRequireDefault(leafletSrc);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{'default':obj};}
_leaflet2['default'].Marker=_leaflet2['default'].Marker.extend({options:_leaflet2['default'].Util.extend({autoPan:false,autoPanPadding:[50,50],autoPanSpeed:10},_leaflet2['default'].Marker.options)});_leaflet2['default'].Handler.MarkerDrag=_leaflet2['default'].Handler.MarkerDrag.extend({addHooks:function addHooks(){var icon=this._marker._icon;if(!this._draggable){this._draggable=new _leaflet2['default'].Draggable(icon,icon,true);}
this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable();_leaflet2['default'].DomUtil.addClass(icon,'leaflet-marker-draggable');},_adjustPan:function _adjustPan(e){var marker=this._marker,map=marker._map,padding=marker.options.autoPanPadding,speed=marker.options.autoPanSpeed;var iconPos=_leaflet2['default'].DomUtil.getPosition(marker._icon),bounds=map.getPixelBounds(),origin=map.getPixelOrigin();var panBounds=_leaflet2['default'].bounds(bounds.min._subtract(origin).add(padding),bounds.max._subtract(origin).subtract(padding));if(!panBounds.contains(iconPos)){var movement=_leaflet2['default'].point((Math.max(panBounds.max.x,iconPos.x)-panBounds.max.x)/(bounds.max.x-panBounds.max.x)-(Math.min(panBounds.min.x,iconPos.x)-panBounds.min.x)/(bounds.min.x-panBounds.min.x),(Math.max(panBounds.max.y,iconPos.y)-panBounds.max.y)/(bounds.max.y-panBounds.max.y)-(Math.min(panBounds.min.y,iconPos.y)-panBounds.min.y)/(bounds.min.y-panBounds.min.y)).multiplyBy(speed);map.panBy(movement,{animate:false});this._draggable._newPos._add(movement);this._draggable._startPos._add(movement);_leaflet2['default'].DomUtil.setPosition(marker._icon,this._draggable._newPos);this._onDrag(e);this._panRequest=_leaflet2['default'].Util.requestAnimFrame(this._adjustPan.bind(this,e));}},_onPreDrag:function _onPreDrag(e){if(this._marker.options.autoPan){_leaflet2['default'].Util.cancelAnimFrame(this._panRequest);this._panRequest=_leaflet2['default'].Util.requestAnimFrame(this._adjustPan.bind(this,e));}},_onDragEnd:function _onDragEnd(e){_leaflet2['default'].Util.cancelAnimFrame(this._panRequest);delete this._oldLatLng;this._marker.fire('moveend').fire('dragend',e);}});});var Marker=function(_L$Marker){_inherits(Marker,_L$Marker);function Marker(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Marker);var _this=_possibleConstructorReturn(this,_L$Marker.call(this,opts.position,markerOptions(opts)));if(opts.map){_this.setMap(opts.map);}
if(opts.html){_this.html=opts.html;}
return _this;}
Marker.prototype.setOptions=function setOptions(options){leafletSrc.Util.setOptions(this,markerOptions(options));};Marker.prototype.setMap=function setMap(map){if(!map){_L$Marker.prototype.remove.call(this);}else{_L$Marker.prototype.addTo.call(this,map);}
this.fireEvent('visible_changed');};Marker.prototype.getMap=function getMap(){return this._map;};Marker.prototype.setDraggable=function setDraggable(value){this.options.draggable=!!value;if(this.options.draggable){if(!this.dragging){this._initInteraction();}else{this.dragging.enable();}}else if(this.dragging){this.dragging.disable();}};Marker.prototype.setVisible=function setVisible(value){this.visible=value!==false;if(this._icon&&this.visible===false){this._icon.style.display='none';}else if(this._icon&&this.visible!==false){this._icon.style.display='';}
this.fireEvent('visible_changed');};Marker.prototype.getVisible=function getVisible(){return this._map!==void 0&&this.visible!==false;};Marker.prototype.setTitle=function setTitle(title){this.options.title=title;this._icon&&this._icon.setAttribute('title',title);};Marker.prototype.setPosition=function setPosition(latLng){_L$Marker.prototype.setLatLng.call(this,latLng);};Marker.prototype.getPosition=function getPosition(){return toInternalLatLng(_L$Marker.prototype.getLatLng.call(this));};Marker.prototype.setAnimation=function setAnimation(){};Marker.prototype.setIcon=function setIcon(icon){if(typeof icon==='string'){_L$Marker.prototype.setIcon.call(this,leafletSrc.icon({iconUrl:icon}));}else{_L$Marker.prototype.setIcon.call(this,new SpriteIcon(iconOptions(icon)));}};Marker.prototype.get=function get(key){return this.options[key]||this[key];};Marker.prototype.getZIndex=function getZIndex(){return this.get('zIndexOffset');};Marker.prototype.setZIndex=function setZIndex(value){this.setZIndexOffset(value);};Marker.prototype.getClickable=function getClickable(value){return this.options.clickable===true||this.options.interactive===true||false;};Marker.prototype.trigger=function trigger(){this.fireEvent.apply(this,arguments);};Marker.prototype.addListener=function addListener(){this.on.apply(this,arguments);};return Marker;}(leafletSrc.Marker);var SpriteIcon=function(_L$DivIcon){_inherits(SpriteIcon,_L$DivIcon);function SpriteIcon(){_classCallCheck(this,SpriteIcon);return _possibleConstructorReturn(this,_L$DivIcon.apply(this,arguments));}
SpriteIcon.prototype.createIcon=function createIcon(oldIcon){var icon=_L$DivIcon.prototype.createIcon.call(this,oldIcon);icon.style.backgroundImage='url('+(leafletSrc.Browser.retina?this.options.iconRetinaUrl:this.options.iconUrl)+')';if(this.options.scaledSize){var size=leafletSrc.point(this.options.scaledSize);icon.style.backgroundSize=size.x+'px '+size.y+'px';}
icon.style.outline='none';return icon;};return SpriteIcon;}(leafletSrc.DivIcon);var SvgIcon=function(_L$Icon){_inherits(SvgIcon,_L$Icon);function SvgIcon(){_classCallCheck(this,SvgIcon);return _possibleConstructorReturn(this,_L$Icon.apply(this,arguments));}
SvgIcon.prototype.createIcon=function createIcon(oldIcon){var svg=oldIcon&&oldIcon.tagName==='SVG'?oldIcon:document.createElementNS('http://www.w3.org/2000/svg','svg');var _options=this.options,content=_options.content,viewBox=_options.viewBox;svg.setAttribute('viewBox',viewBox);svg.innerHTML=content;this._setIconStyles(svg,'icon');return svg;};SvgIcon.prototype.createShadow=function createShadow(){return null;};SvgIcon.prototype._setIconStyles=function _setIconStyles(img,name){var options=this.options;var sizeOption=options[name+'Size'];if(typeof sizeOption==='number'){sizeOption=[sizeOption,sizeOption];}
var size=leafletSrc.point(sizeOption),anchor=leafletSrc.point(name==='shadow'&&options.shadowAnchor||options.iconAnchor||size&&size.divideBy(2,true));img.setAttribute('class','leaflet-marker-'+name+' '+(options.className||''));if(anchor){img.style.marginLeft=-anchor.x+'px';img.style.marginTop=-anchor.y+'px';}
if(size){img.style.width=size.x+'px';img.style.height=size.y+'px';}};return SvgIcon;}(leafletSrc.Icon);function MarkerImage(url,size,origin,anchor,scaledSize){return{url:url,size:scaledSize||size,origin:origin,anchor:anchor,scaledSize:scaledSize};}
function markerOptions(options){if('icon'in options){if(typeof options.icon==='string'){options.icon=leafletSrc.icon({iconUrl:options.icon});}else{options.icon=new SpriteIcon(iconOptions(options.icon));}}else{options.icon=new SvgIcon({content:'<g><path fill="#006DA1" d="M182.9,551.7c0,0.1,0.2,0.3,0.2,0.3S358.3,283,358.3,194.6c0-130.1-88.8-186.7-175.4-186.9 C96.3,7.9,7.5,64.5,7.5,194.6c0,88.4,175.3,357.4,175.3,357.4S182.9,551.7,182.9,551.7z M122.2,187.2c0-33.6,27.2-60.8,60.8-60.8 c33.6,0,60.8,27.2,60.8,60.8S216.5,248,182.9,248C149.4,248,122.2,220.8,122.2,187.2z"/></g>',viewBox:'0 0 365 560',iconSize:[25,40],iconAnchor:[12,40]});}
if(!('autoPan'in options)){options.autoPan=true;}
return options;}
var Circle$2=function(_L$Circle){_inherits(Circle,_L$Circle);function Circle(opts){_classCallCheck(this,Circle);var _this=_possibleConstructorReturn(this,_L$Circle.call(this,opts.center,pathOptions(opts)));if(opts.map){_this.addTo(opts.map);}
return _this;}
Circle.prototype.setOptions=function setOptions(options){options=pathOptions(options);leafletSrc.Util.setOptions(this,options);this.setStyle(options);this.redraw();};Circle.prototype.getCenter=function getCenter(){return toInternalLatLng(this.getLatLng());};Circle.prototype.setCenter=function setCenter(latLng){this.setLatLng(latLng);};Circle.prototype.setMap=function setMap(map){if(!map){this.remove();}else{this.addTo(map);}};return Circle;}(leafletSrc.Circle);var Polygon$2=function(_L$Polygon){_inherits(Polygon,_L$Polygon);function Polygon(opts){_classCallCheck(this,Polygon);var path=opts.path||opts.paths||[];if(path instanceof MVCArray){path=path.toArray();}
var _this=_possibleConstructorReturn(this,_L$Polygon.call(this,path,pathOptions(opts)));if(opts.map){_this.addTo(opts.map);}
return _this;}
Polygon.prototype.setOptions=function setOptions(options){options=pathOptions(options);leafletSrc.Util.setOptions(this,options);this.setStyle(options);this.redraw();};Polygon.prototype.setMap=function setMap(map){if(!map){this.remove();}else{this.addTo(map);}};Polygon.prototype.getPath=function getPath(){var firstPath=this.getLatLngs()[0]||[];return new MVCArray(firstPath.map(toInternalLatLng));};Polygon.prototype.getPaths=function getPaths(){return new MVCArray(this.getLatLngs().map(function(path){return new MVCArray(path.map(toInternalLatLng));}));};Polygon.prototype.addListener=function addListener(event,callback){this.addEventListener(event,function(evt){evt.latLng=toInternalLatLng(evt.latlng);callback(evt);});};return Polygon;}(leafletSrc.Polygon);var Polyline=function(_L$Polyline){_inherits(Polyline,_L$Polyline);function Polyline(opts){_classCallCheck(this,Polyline);var path=opts.path||opts.paths||[];if(path instanceof MVCArray){path=path.toArray();}
var _this=_possibleConstructorReturn(this,_L$Polyline.call(this,path,pathOptions(opts)));if(opts.map){_this.addTo(opts.map);}
return _this;}
Polyline.prototype.setOptions=function setOptions(options){options=pathOptions(options);leafletSrc.Util.setOptions(this,options);this.setStyle(options);this.redraw();};Polyline.prototype.setMap=function setMap(map){if(!map){this.remove();}else{this.addTo(map);}};Polyline.prototype.getPath=function getPath(){var firstPath=this.getLatLngs()[0]||[];return new MVCArray(firstPath.map(toInternalLatLng));};Polyline.prototype.getPaths=function getPaths(){return new MVCArray(this.getLatLngs().map(function(path){return new MVCArray(path.map(toInternalLatLng));}));};Polyline.prototype.addListener=function addListener(event,callback){this.addEventListener(event,function(evt){evt.latLng=toInternalLatLng(evt.latlng);callback(evt);});};return Polyline;}(leafletSrc.Polyline);var InfoWindow=function(_L$Popup){_inherits(InfoWindow,_L$Popup);function InfoWindow(){var opts=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,InfoWindow);var _this=_possibleConstructorReturn(this,_L$Popup.call(this,opts));_this.setOptions(opts);return _this;}
InfoWindow.prototype.setOptions=function setOptions(opts){leafletSrc.Util.setOptions(this,opts);if(opts.map){this.addTo(opts.map);}
if(opts.position){this.setLatLng(opts.position);}
if(opts.content){this.setContent(opts.content);}};InfoWindow.prototype.getPosition=function getPosition(){return toInternalLatLng(this.getLatLng());};InfoWindow.prototype.getZIndex=function getZIndex(){return this._container&&this._container.style.zIndex;};InfoWindow.prototype.open=function open(map,marker,options){if(map){map.openPopup(this,marker&&marker.getLatLng());}else if(this._map){this.openOn(this._map);}};InfoWindow.prototype.close=function close(){this.remove();};InfoWindow.prototype.setPosition=function setPosition(latLng){this.setLatLng(latLng);};InfoWindow.prototype.setMap=function setMap(map){if(!map){this.remove();}else{this.addTo(map);}};InfoWindow.prototype.getMap=function getMap(){return this._map;};InfoWindow.prototype.set=function set(attr,value){this[attr]=value;if(value.bindPopup){value.bindPopup(this);this.setLatLng(value.getCenter?value.getCenter():value.getLatLng());}};InfoWindow.prototype.get=function get(attr){return this[attr];};return InfoWindow;}(leafletSrc.Popup);var Projection=function(){function Projection(map){_classCallCheck(this,Projection);this.map=map;}
Projection.prototype.fromContainerPixelToLatLng=function fromContainerPixelToLatLng(point){return toInternalLatLng(this.map.containerPointToLatLng(point));};Projection.prototype.fromDivPixelToLatLng=function fromDivPixelToLatLng(point){return toInternalLatLng(this.map.containerPointToLatLng(this.map.layerPointToContainerPoint(point)));};Projection.prototype.fromLatLngToContainerPixel=function fromLatLngToContainerPixel(latLng){return this.map.latLngToContainerPoint(latLng);};Projection.prototype.fromLatLngToDivPixel=function fromLatLngToDivPixel(latLng){return this.map.latLngToLayerPoint(latLng);};return Projection;}();var OverlayView=function(){function OverlayView(){_classCallCheck(this,OverlayView);}
OverlayView.prototype.setMap=function setMap(map){if(!this.drawB){this.drawB=this._draw.bind(this);}
if(map){this.map=map;this.onAdd();setTimeout(this.drawB);map.on('move',this.drawB);}else if(this.map){this.map.off('move',this.drawB);this.onRemove();this.map=null;}};OverlayView.prototype._draw=function _draw(){this.map&&this.draw();};OverlayView.prototype.getPanes=function getPanes(){return this.map.getPanes();};OverlayView.prototype.getMap=function getMap(){return this.map;};OverlayView.prototype.getProjection=function getProjection(){return new Projection(this.map);};return OverlayView;}();var ImageMapType=function(_L$TileLayer){_inherits(ImageMapType,_L$TileLayer);function ImageMapType(options){_classCallCheck(this,ImageMapType);return _possibleConstructorReturn(this,_L$TileLayer.call(this,options.url||'',options));}
ImageMapType.prototype.getTileUrl=function getTileUrl(coords){if(this.options.getTileUrl!==void 0){return this.options.getTileUrl(coords,this._getZoomForUrl());}else{return _L$TileLayer.prototype.getTileUrl.call(this,coords);}};return ImageMapType;}(leafletSrc.TileLayer);function addListener(component,event,callback){function listener(evt){if(evt.latlng){evt.latLng=toInternalLatLng(evt.latlng);}else if(component.getPosition!==void 0){evt.latLng=component.getPosition();}
callback.call(component,evt);}
component.addEventListener(event,listener);return function(){component.removeEventListener(event,listener);};}
var addDomListener=addListener;function addListenerOnce(component,event,callback){var undo=addListener(component,event,function(){callback.apply(component,arguments);undo();});return undo;}
function removeListener(handler){handler();}
function trigger(component,event,data){component.trigger(event);if(event==='resize'){component.invalidateSize();}}
var event={addListener:addListener,addDomListener:addDomListener,addListenerOnce:addListenerOnce,removeListener:removeListener,trigger:trigger};var EMPY_OBJ={};var ID=function ID(){};var Point=leafletSrc.point;var Size=leafletSrc.point;var Animation=EMPY_OBJ;var MapTypeId=EMPY_OBJ;var MapTypeControlStyle=EMPY_OBJ;var NavigationControlStyle=EMPY_OBJ;var ZoomControlStyle=EMPY_OBJ;var geometry={spherical:{computeDistanceBetween:function computeDistanceBetween(originPoint,newPoint){return leafletSrc.latLng(originPoint).distanceTo(newPoint);}}};var StreetViewStatus={OK:true};var StreetViewService=function StreetViewService(){return{getPanoramaByLocation:function getPanoramaByLocation(_,_2,cb){setTimeout(cb);}};};var StreetViewPanorama=ID;exports.Map=Map;exports.LatLng=LatLng;exports.LatLngBounds=LatLngBounds;exports.Geocoder=Geocoder;exports.GeocoderStatus=GeocoderStatus;exports.Marker=Marker;exports.MarkerImage=MarkerImage;exports.Circle=Circle$2;exports.Polygon=Polygon$2;exports.Polyline=Polyline;exports.InfoWindow=InfoWindow;exports.OverlayView=OverlayView;exports.ImageMapType=ImageMapType;exports.ControlPosition=ControlPosition;exports.event=event;exports.Point=Point;exports.Size=Size;exports.Animation=Animation;exports.MapTypeId=MapTypeId;exports.MapTypeControlStyle=MapTypeControlStyle;exports.NavigationControlStyle=NavigationControlStyle;exports.ZoomControlStyle=ZoomControlStyle;exports.geometry=geometry;exports.StreetViewStatus=StreetViewStatus;exports.StreetViewService=StreetViewService;exports.StreetViewPanorama=StreetViewPanorama;Object.defineProperty(exports,'__esModule',{value:true});})));;window.google=window.google||{};window.google.maps=window['maps-migrate'];